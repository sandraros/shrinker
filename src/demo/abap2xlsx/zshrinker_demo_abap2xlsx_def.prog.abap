********************************************************************************
*
* LICENSE and NOTICE
*
* See include program ZSHRINKER_DEMO_ABAP2XLSX_LICEN
*
********************************************************************************
CLASS LCL_EXCEL DEFINITION DEFERRED.
CLASS LCL_EXCEL_AUTOFILTER DEFINITION DEFERRED.
CLASS LCL_EXCEL_AUTOFILTERS DEFINITION DEFERRED.
CLASS LCL_EXCEL_COLLECTION DEFINITION DEFERRED.
CLASS LCL_EXCEL_COLLECTION_ITERATOR DEFINITION DEFERRED.
CLASS LCL_EXCEL_COLUMN DEFINITION DEFERRED.
CLASS LCL_EXCEL_COLUMNS DEFINITION DEFERRED.
CLASS LCL_EXCEL_COMMENT DEFINITION DEFERRED.
CLASS LCL_EXCEL_COMMENTS DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER_ALV DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER_ALV_GRID DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER_RESULT DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER_RESULT_EX DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER_RESULT_WD DEFINITION DEFERRED.
CLASS LCL_EXCEL_DATA_VALIDATION DEFINITION DEFERRED.
CLASS LCL_EXCEL_DATA_VALIDATIONS DEFINITION DEFERRED.
CLASS LCL_EXCEL_DRAWING DEFINITION DEFERRED.
CLASS LCL_EXCEL_DRAWINGS DEFINITION DEFERRED.
CLASS LCL_EXCEL_FILL_TEMPLATE DEFINITION DEFERRED.
CLASS LCL_EXCEL_FONT DEFINITION DEFERRED.
CLASS LCL_EXCEL_GRAPH DEFINITION DEFERRED.
CLASS LCL_EXCEL_GRAPH_BARS DEFINITION DEFERRED.
CLASS LCL_EXCEL_GRAPH_LINE DEFINITION DEFERRED.
CLASS LCL_EXCEL_GRAPH_PIE DEFINITION DEFERRED.
CLASS LCL_EXCEL_HYPERLINK DEFINITION DEFERRED.
CLASS LCL_EXCEL_LEGACY_PALETTE DEFINITION DEFERRED.
CLASS LCL_EXCEL_RANGE DEFINITION DEFERRED.
CLASS LCL_EXCEL_RANGES DEFINITION DEFERRED.
CLASS LCL_EXCEL_READER_HUGE_FILE DEFINITION DEFERRED.
CLASS LCL_EXCEL_READER_XLSM DEFINITION DEFERRED.
CLASS LCL_EXCEL_ROW DEFINITION DEFERRED.
CLASS LCL_EXCEL_ROWS DEFINITION DEFERRED.
CLASS LCL_EXCEL_SECURITY DEFINITION DEFERRED.
CLASS LCL_EXCEL_SHEET_SETUP DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLES DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLES_COND DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_ALIGNMENT DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_BORDER DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_BORDERS DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_COLOR DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_COND DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_FILL DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_FONT DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_NUMBER_FORMAT DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_PROTECTION DEFINITION DEFERRED.
CLASS LCL_EXCEL_TABLE DEFINITION DEFERRED.
CLASS LCL_EXCEL_TEMPLATE_DATA DEFINITION DEFERRED.
CLASS LCL_EXCEL_THEME DEFINITION DEFERRED.
CLASS LCL_EXCEL_THEME_ECLRSCHEMELST DEFINITION DEFERRED.
CLASS LCL_EXCEL_THEME_ELEMENTS DEFINITION DEFERRED.
CLASS LCL_EXCEL_THEME_EXTLST DEFINITION DEFERRED.
CLASS LCL_EXCEL_THEME_FONT_SCHEME DEFINITION DEFERRED.
CLASS LCL_EXCEL_THEME_OBJECTDEFAULTS DEFINITION DEFERRED.
CLASS LCL_EXCEL_WORKSHEETS DEFINITION DEFERRED.
CLASS LCL_EXCEL_WORKSHEET_PAGEBREAKS DEFINITION DEFERRED.
CLASS LCL_EXCEL_WRITER_2007 DEFINITION DEFERRED.
CLASS LCL_EXCEL_WRITER_HUGE_FILE DEFINITION DEFERRED.
CLASS LCL_EXCEL_WRITER_XLSM DEFINITION DEFERRED.
CLASS LCL_EXCEL_OBSOLETE_FUNC_WRAP DEFINITION DEFERRED.
CLASS LCL_EXCEL_READER_2007 DEFINITION DEFERRED.
CLASS LCL_EXCEL_THEME_COLOR_SCHEME DEFINITION DEFERRED.
INTERFACE LIF_EXCEL_BOOK_PROPERTIES DEFERRED.
INTERFACE LIF_EXCEL_BOOK_PROTECTION DEFERRED.
INTERFACE LIF_EXCEL_BOOK_VBA_PROJECT DEFERRED.
INTERFACE LIF_EXCEL_CONVERTER DEFERRED.
INTERFACE LIF_EXCEL_READER DEFERRED.
INTERFACE LIF_EXCEL_SHEET_PRINTSETTINGS DEFERRED.
INTERFACE LIF_EXCEL_SHEET_PROPERTIES DEFERRED.
INTERFACE LIF_EXCEL_SHEET_PROTECTION DEFERRED.
INTERFACE LIF_EXCEL_SHEET_VBA_PROJECT DEFERRED.
INTERFACE LIF_EXCEL_STYLE_CHANGER DEFERRED.
INTERFACE LIF_EXCEL_WRITER DEFERRED.
CLASS LCL_EXCEL_THEME_FMT_SCHEME DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER_SALV_MODEL DEFINITION DEFERRED.
CLASS LCL_EXCEL_CONVERTER_SALV_TABLE DEFINITION DEFERRED.
CLASS LCL_EXCEL_OLE DEFINITION DEFERRED.
CLASS LCX_EXCEL DEFINITION DEFERRED.
CLASS LCL_EXCEL_STYLE_CHANGER DEFINITION DEFERRED.
CLASS LCL_EXCEL_WRITER_CSV DEFINITION DEFERRED.
CLASS LCL_EXCEL_COMMON DEFINITION DEFERRED.
CLASS LCL_EXCEL_WORKSHEET DEFINITION DEFERRED.
TYPES ZEXCEL_ACTIVE_WORKSHEET TYPE I.
TYPES ZEXCEL_AES_PASSWORD TYPE C LENGTH 50.
TYPES ZEXCEL_ALIGNMENT TYPE C LENGTH 20.
TYPES ZEXCEL_APPLICATION TYPE C LENGTH 80.
TYPES ZEXCEL_BORDER TYPE C LENGTH 20.
TYPES ZEXCEL_BREAK TYPE INT1.
TYPES ZEXCEL_CATEGORY TYPE C LENGTH 80.
TYPES ZEXCEL_CELL_COLUMN TYPE I.
TYPES ZEXCEL_CELL_COLUMN_ALPHA TYPE C LENGTH 3.
TYPES ZEXCEL_CELL_COORDS TYPE string.
TYPES ZEXCEL_CELL_DATA_TYPE TYPE string.
TYPES ZEXCEL_CELL_FORMULA TYPE string.
TYPES ZEXCEL_CELL_PROTECTION TYPE C LENGTH 1.
TYPES ZEXCEL_CELL_ROW TYPE I.
TYPES ZEXCEL_CELL_STYLE TYPE X LENGTH 16.
TYPES ZEXCEL_CELL_VALUE TYPE string.
TYPES ZEXCEL_COLOR TYPE C LENGTH 8.
TYPES ZEXCEL_COLUMN_NAME TYPE C LENGTH 255.
TYPES ZEXCEL_COMPANY TYPE C LENGTH 80.
TYPES ZEXCEL_CONDITIONAL_TYPE TYPE C LENGTH 10.
TYPES ZEXCEL_CONDITIONAL_VALUE TYPE string.
TYPES ZEXCEL_CONDITION_OPERATOR TYPE C LENGTH 20.
TYPES ZEXCEL_CONDITION_RULE TYPE C LENGTH 20.
TYPES ZEXCEL_CONDITION_RULE_ICONSET TYPE C LENGTH 20.
TYPES ZEXCEL_CONVERTER_OPTION_FILTER TYPE C LENGTH 1.
TYPES ZEXCEL_CONVERTER_OPTION_HIDEHD TYPE C LENGTH 1.
TYPES ZEXCEL_CONVERTER_OPTION_HIDENC TYPE C LENGTH 1.
TYPES ZEXCEL_CONVERTER_OPTION_SUBTOT TYPE C LENGTH 1.
TYPES ZEXCEL_CREATOR TYPE C LENGTH 80.
TYPES ZEXCEL_DATA_VAL_ERROR_STYLE TYPE C LENGTH 20.
TYPES ZEXCEL_DATA_VAL_OPERATOR TYPE C LENGTH 20.
TYPES ZEXCEL_DATA_VAL_TYPE TYPE C LENGTH 20.
TYPES ZEXCEL_DEC_8_2 TYPE P LENGTH 5 DECIMALS 2.
TYPES ZEXCEL_DESCRIPTION TYPE C LENGTH 80.
TYPES ZEXCEL_DIAGONAL TYPE INT1.
TYPES ZEXCEL_DOCSECURITY TYPE N LENGTH 1.
TYPES ZEXCEL_DRAWING_ANCHOR TYPE C LENGTH 3.
TYPES ZEXCEL_DRAWING_TYPE TYPE C LENGTH 5.
TYPES ZEXCEL_FIELDNAME TYPE C LENGTH 30.
TYPES ZEXCEL_FILL_TYPE TYPE C LENGTH 20.
TYPES ZEXCEL_GRAPH_TYPE TYPE INT1.
TYPES ZEXCEL_GUID TYPE X LENGTH 16.
TYPES ZEXCEL_HIDDEN TYPE C LENGTH 1.
TYPES ZEXCEL_INDENT TYPE INT1.
TYPES ZEXCEL_KEYWORDS TYPE C LENGTH 80.
TYPES ZEXCEL_LOCKED TYPE C LENGTH 1.
TYPES ZEXCEL_NUMBER_FORMAT TYPE string.
TYPES ZEXCEL_PANE_STATE TYPE string.
TYPES ZEXCEL_PANE_TYPE TYPE string.
TYPES ZEXCEL_PRINT_GRIDLINES TYPE C LENGTH 1.
TYPES ZEXCEL_PWD_HASH TYPE X LENGTH 2.
TYPES ZEXCEL_RANGE_GUID TYPE X LENGTH 16.
TYPES ZEXCEL_RANGE_NAME TYPE string.
TYPES ZEXCEL_RANGE_VALUE TYPE string.
TYPES ZEXCEL_REVISIONSPASSWORD TYPE C LENGTH 80.
TYPES ZEXCEL_ROTATION TYPE I.
TYPES ZEXCEL_SCALECROP TYPE C LENGTH 1.
TYPES ZEXCEL_SHEET_HIDDEN TYPE C LENGTH 1.
TYPES ZEXCEL_SHEET_ORIENATATION TYPE C LENGTH 20.
TYPES ZEXCEL_SHEET_PAPER_SIZE TYPE INT1.
TYPES ZEXCEL_SHEET_SELECTED TYPE C LENGTH 1.
TYPES ZEXCEL_SHEET_SHOWZEROS TYPE C LENGTH 1.
TYPES ZEXCEL_SHEET_SUMMARY TYPE I.
TYPES ZEXCEL_SHEET_TITLE TYPE C LENGTH 31.
TYPES ZEXCEL_SHEET_ZOOMSCALE TYPE INT2.
TYPES ZEXCEL_SHOW_GRIDLINES TYPE C LENGTH 1.
TYPES ZEXCEL_SHOW_ROWCOLHEADER TYPE C LENGTH 1.
TYPES ZEXCEL_STYLE_COLOR_ARGB TYPE C LENGTH 8.
TYPES ZEXCEL_STYLE_COLOR_COMPONENT TYPE C LENGTH 2.
TYPES ZEXCEL_STYLE_COLOR_INDEXED TYPE I.
TYPES ZEXCEL_STYLE_COLOR_THEME TYPE I.
TYPES ZEXCEL_STYLE_COLOR_TINT TYPE F.
TYPES ZEXCEL_STYLE_FONT_FAMILY TYPE INT1.
TYPES ZEXCEL_STYLE_FONT_NAME TYPE C LENGTH 255.
TYPES ZEXCEL_STYLE_FONT_SCHEME TYPE C LENGTH 20.
TYPES ZEXCEL_STYLE_FONT_SIZE TYPE INT1.
TYPES ZEXCEL_STYLE_FONT_UNDERLINE TYPE C LENGTH 20.
TYPES ZEXCEL_STYLE_FORMULA TYPE string.
TYPES ZEXCEL_STYLE_PRIORITY TYPE I.
TYPES ZEXCEL_SUBJECT TYPE C LENGTH 80.
TYPES ZEXCEL_TABLE_STYLE TYPE string.
TYPES ZEXCEL_TABLE_TOTALS_FUNCTION TYPE string.
TYPES ZEXCEL_TEXT_ROTATION TYPE INT1.
TYPES ZEXCEL_TITLE TYPE C LENGTH 80.
TYPES ZEXCEL_VALIDATION_FORMULA1 TYPE string.
TYPES ZEXCEL_WORKBOOKPASSWORD TYPE C LENGTH 80.
TYPES ZEXCEL_WORKSHEETS_NAME TYPE C LENGTH 80.
TYPES BEGIN OF ZEXCEL_CONDITIONAL_ABOVE_AVG.
TYPES ABOVE_AVERAGE TYPE XSDBOOLEAN.
TYPES EQUAL_AVERAGE TYPE XSDBOOLEAN.
TYPES STANDARD_DEVIATION TYPE N LENGTH 1.
TYPES CELL_STYLE TYPE ZEXCEL_CELL_STYLE.
TYPES END OF ZEXCEL_CONDITIONAL_ABOVE_AVG.
TYPES BEGIN OF ZEXCEL_CONDITIONAL_CELLIS.
TYPES FORMULA TYPE ZEXCEL_STYLE_FORMULA.
TYPES FORMULA2 TYPE ZEXCEL_STYLE_FORMULA.
TYPES OPERATOR TYPE ZEXCEL_CONDITION_OPERATOR.
TYPES CELL_STYLE TYPE ZEXCEL_CELL_STYLE.
TYPES END OF ZEXCEL_CONDITIONAL_CELLIS.
TYPES BEGIN OF ZEXCEL_CONDITIONAL_COLORSCALE.
TYPES CFVO1_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO1_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES CFVO2_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO2_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES CFVO3_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO3_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES COLORRGB1 TYPE ZEXCEL_COLOR.
TYPES COLORRGB2 TYPE ZEXCEL_COLOR.
TYPES COLORRGB3 TYPE ZEXCEL_COLOR.
TYPES END OF ZEXCEL_CONDITIONAL_COLORSCALE.
TYPES BEGIN OF ZEXCEL_CONDITIONAL_DATABAR.
TYPES CFVO1_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO1_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES CFVO2_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO2_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES COLORRGB TYPE ZEXCEL_COLOR.
TYPES END OF ZEXCEL_CONDITIONAL_DATABAR.
TYPES BEGIN OF ZEXCEL_CONDITIONAL_EXPRESSION.
TYPES FORMULA TYPE ZEXCEL_STYLE_FORMULA.
TYPES CELL_STYLE TYPE ZEXCEL_CELL_STYLE.
TYPES END OF ZEXCEL_CONDITIONAL_EXPRESSION.
TYPES BEGIN OF ZEXCEL_CONDITIONAL_ICONSET.
TYPES ICONSET TYPE ZEXCEL_CONDITION_RULE_ICONSET.
TYPES CFVO1_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO1_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES CFVO2_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO2_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES CFVO3_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO3_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES CFVO4_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO4_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES CFVO5_TYPE TYPE ZEXCEL_CONDITIONAL_TYPE.
TYPES CFVO5_VALUE TYPE ZEXCEL_CONDITIONAL_VALUE.
TYPES SHOWVALUE TYPE C LENGTH 1.
TYPES END OF ZEXCEL_CONDITIONAL_ICONSET.
TYPES BEGIN OF ZEXCEL_CONDITIONAL_TOP10.
TYPES TOPXX_COUNT TYPE INT4.
TYPES PERCENT TYPE FLAG.
TYPES BOTTOM TYPE FLAG.
TYPES CELL_STYLE TYPE ZEXCEL_CELL_STYLE.
TYPES END OF ZEXCEL_CONDITIONAL_TOP10.
TYPES BEGIN OF ZEXCEL_DRAWING_LOCATION.
TYPES COL TYPE INT4.
TYPES COL_OFFSET TYPE INT4.
TYPES ROW TYPE INT4.
TYPES ROW_OFFSET TYPE INT4.
TYPES END OF ZEXCEL_DRAWING_LOCATION.
TYPES BEGIN OF ZEXCEL_DRAWING_SIZE.
TYPES WIDTH TYPE INT4.
TYPES HEIGHT TYPE INT4.
TYPES END OF ZEXCEL_DRAWING_SIZE.
TYPES BEGIN OF ZEXCEL_PANE.
TYPES YSPLIT TYPE ZEXCEL_CELL_ROW.
TYPES XSPLIT TYPE ZEXCEL_CELL_ROW.
TYPES TOPLEFTCELL TYPE ZEXCEL_CELL_COORDS.
TYPES ACTIVEPANE TYPE ZEXCEL_PANE_TYPE.
TYPES STATE TYPE ZEXCEL_PANE_STATE.
TYPES END OF ZEXCEL_PANE.
TYPES BEGIN OF ZEXCEL_S_AUTOFILTER_AREA.
TYPES ROW_START TYPE ZEXCEL_CELL_ROW.
TYPES COL_START TYPE ZEXCEL_CELL_COLUMN.
TYPES ROW_END TYPE ZEXCEL_CELL_ROW.
TYPES COL_END TYPE ZEXCEL_CELL_COLUMN.
TYPES END OF ZEXCEL_S_AUTOFILTER_AREA.
TYPES BEGIN OF ZEXCEL_S_AUTOFILTER_VALUES.
TYPES COLUMN TYPE ZEXCEL_CELL_COLUMN.
TYPES VALUE TYPE ZEXCEL_CELL_VALUE.
TYPES END OF ZEXCEL_S_AUTOFILTER_VALUES.
TYPES BEGIN OF ZEXCEL_S_CELLXFS.
TYPES NUMFMTID TYPE INT4.
TYPES FONTID TYPE INT4.
TYPES FILLID TYPE INT4.
TYPES BORDERID TYPE INT4.
TYPES XFID TYPE INT4.
TYPES ALIGNMENTID TYPE INT4.
TYPES PROTECTIONID TYPE INT4.
TYPES APPLYNUMBERFORMAT TYPE INT4.
TYPES APPLYFONT TYPE INT4.
TYPES APPLYFILL TYPE INT4.
TYPES APPLYBORDER TYPE INT4.
TYPES APPLYALIGNMENT TYPE INT4.
TYPES APPLYPROTECTION TYPE INT4.
TYPES END OF ZEXCEL_S_CELLXFS.
TYPES BEGIN OF ZEXCEL_S_CONVERTER_COL.
TYPES ROWNUMBER TYPE ZEXCEL_CELL_ROW.
TYPES COLUMNNAME TYPE ZEXCEL_FIELDNAME.
TYPES FONTCOLOR TYPE ZEXCEL_STYLE_COLOR_ARGB.
TYPES FILLCOLOR TYPE ZEXCEL_STYLE_COLOR_ARGB.
TYPES NOKEYCOL TYPE LVC_NOKEYC.
TYPES END OF ZEXCEL_S_CONVERTER_COL.
TYPES BEGIN OF ZEXCEL_S_CONVERTER_FCAT.
TYPES TABNAME TYPE TABNAME.
TYPES FIELDNAME TYPE ZEXCEL_FIELDNAME.
TYPES COLUMNNAME TYPE ZEXCEL_FIELDNAME.
TYPES POSITION TYPE TABFDPOS.
TYPES INTTYPE TYPE C LENGTH 1.
TYPES DECIMALS TYPE INT1.
TYPES SCRTEXT_S TYPE SCRTEXT_S.
TYPES SCRTEXT_M TYPE SCRTEXT_M.
TYPES SCRTEXT_L TYPE SCRTEXT_L.
TYPES TOTALS_FUNCTION TYPE ZEXCEL_TABLE_TOTALS_FUNCTION.
TYPES FIX_COLUMN TYPE FLAG.
TYPES ALIGNMENT TYPE ZEXCEL_ALIGNMENT.
TYPES IS_OPTIMIZED TYPE FLAG.
TYPES IS_HIDDEN TYPE FLAG.
TYPES IS_COLLAPSED TYPE FLAG.
TYPES IS_SUBTOTALLED TYPE FLAG.
TYPES SORT_LEVEL TYPE INT4.
TYPES STYLE_HDR TYPE ZEXCEL_CELL_STYLE.
TYPES STYLE_NORMAL TYPE ZEXCEL_CELL_STYLE.
TYPES STYLE_STRIPPED TYPE ZEXCEL_CELL_STYLE.
TYPES STYLE_TOTAL TYPE ZEXCEL_CELL_STYLE.
TYPES STYLE_SUBTOTAL TYPE ZEXCEL_CELL_STYLE.
TYPES COL_ID TYPE LVC_COLID.
TYPES CONVEXIT TYPE CONVEXIT.
TYPES END OF ZEXCEL_S_CONVERTER_FCAT.
TYPES BEGIN OF ZEXCEL_S_CONVERTER_FIL.
TYPES ROWNUMBER TYPE ZEXCEL_CELL_ROW.
TYPES COLUMNNAME TYPE ZEXCEL_FIELDNAME.
TYPES END OF ZEXCEL_S_CONVERTER_FIL.
TYPES BEGIN OF ZEXCEL_S_CONVERTER_LAYO.
TYPES IS_STRIPPED TYPE FLAG.
TYPES IS_FIXED TYPE FLAG.
TYPES MAX_SUBTOTAL_LEVEL TYPE INT4.
TYPES END OF ZEXCEL_S_CONVERTER_LAYO.
TYPES BEGIN OF ZEXCEL_S_CONVERTER_OPTION.
TYPES FILTER TYPE ZEXCEL_CONVERTER_OPTION_FILTER.
TYPES SUBTOT TYPE ZEXCEL_CONVERTER_OPTION_SUBTOT.
TYPES HIDENC TYPE ZEXCEL_CONVERTER_OPTION_HIDENC.
TYPES HIDEHD TYPE ZEXCEL_CONVERTER_OPTION_HIDEHD.
TYPES CONV_EXIT_LENGTH TYPE FLAG.
TYPES END OF ZEXCEL_S_CONVERTER_OPTION.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_ALIGNMENT.
TYPES HORIZONTAL TYPE FLAG.
TYPES VERTICAL TYPE FLAG.
TYPES TEXTROTATION TYPE FLAG.
TYPES WRAPTEXT TYPE FLAG.
TYPES SHRINKTOFIT TYPE FLAG.
TYPES INDENT TYPE FLAG.
TYPES END OF ZEXCEL_S_CSTYLEX_ALIGNMENT.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_COLOR.
TYPES RGB TYPE FLAG.
TYPES INDEXED TYPE FLAG.
TYPES THEME TYPE FLAG.
TYPES TINT TYPE FLAG.
TYPES END OF ZEXCEL_S_CSTYLEX_COLOR.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_FONT.
TYPES BOLD TYPE FLAG.
TYPES COLOR TYPE ZEXCEL_S_CSTYLEX_COLOR.
TYPES FAMILY TYPE FLAG.
TYPES ITALIC TYPE FLAG.
TYPES NAME TYPE FLAG.
TYPES SCHEME TYPE FLAG.
TYPES SIZE TYPE FLAG.
TYPES STRIKETHROUGH TYPE FLAG.
TYPES UNDERLINE TYPE FLAG.
TYPES UNDERLINE_MODE TYPE FLAG.
TYPES END OF ZEXCEL_S_CSTYLEX_FONT.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_GRADTYPE.
TYPES TYPE TYPE FLAG.
TYPES DEGREE TYPE FLAG.
TYPES BOTTOM TYPE FLAG.
TYPES LEFT TYPE FLAG.
TYPES TOP TYPE FLAG.
TYPES RIGHT TYPE FLAG.
TYPES POSITION1 TYPE FLAG.
TYPES POSITION2 TYPE FLAG.
TYPES POSITION3 TYPE FLAG.
TYPES END OF ZEXCEL_S_CSTYLEX_GRADTYPE.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_NUMBER_FORMAT.
TYPES FORMAT_CODE TYPE FLAG.
TYPES END OF ZEXCEL_S_CSTYLEX_NUMBER_FORMAT.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_PROTECTION.
TYPES HIDDEN TYPE FLAG.
TYPES LOCKED TYPE FLAG.
TYPES END OF ZEXCEL_S_CSTYLEX_PROTECTION.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_ALIGNMENT.
TYPES HORIZONTAL TYPE ZEXCEL_ALIGNMENT.
TYPES VERTICAL TYPE ZEXCEL_ALIGNMENT.
TYPES TEXTROTATION TYPE ZEXCEL_TEXT_ROTATION.
TYPES WRAPTEXT TYPE FLAG.
TYPES SHRINKTOFIT TYPE FLAG.
TYPES INDENT TYPE ZEXCEL_INDENT.
TYPES END OF ZEXCEL_S_CSTYLE_ALIGNMENT.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_NUMBER_FORMAT.
TYPES FORMAT_CODE TYPE ZEXCEL_NUMBER_FORMAT.
TYPES END OF ZEXCEL_S_CSTYLE_NUMBER_FORMAT.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_PROTECTION.
TYPES HIDDEN TYPE ZEXCEL_CELL_PROTECTION.
TYPES LOCKED TYPE ZEXCEL_CELL_PROTECTION.
TYPES END OF ZEXCEL_S_CSTYLE_PROTECTION.
TYPES BEGIN OF ZEXCEL_S_DRAWINGS.
TYPES DRAWING TYPE REF TO LCL_EXCEL_DRAWING.
TYPES END OF ZEXCEL_S_DRAWINGS.
TYPES BEGIN OF ZEXCEL_S_FIELDCATALOG.
TYPES TABNAME TYPE TABNAME.
TYPES FIELDNAME TYPE ZEXCEL_FIELDNAME.
TYPES POSITION TYPE TABFDPOS.
TYPES SCRTEXT_S TYPE SCRTEXT_S.
TYPES SCRTEXT_M TYPE SCRTEXT_M.
TYPES SCRTEXT_L TYPE SCRTEXT_L.
TYPES DYNPFLD TYPE DYNPROFLD.
TYPES STYLE TYPE ZEXCEL_CELL_STYLE.
TYPES STYLE_HEADER TYPE ZEXCEL_CELL_STYLE.
TYPES STYLE_TOTAL TYPE ZEXCEL_CELL_STYLE.
TYPES STYLE_COND TYPE ZEXCEL_CELL_STYLE.
TYPES TOTALS_FUNCTION TYPE ZEXCEL_TABLE_TOTALS_FUNCTION.
TYPES FORMULA TYPE FLAG.
TYPES ABAP_TYPE TYPE C LENGTH 1.
TYPES COLUMN_FORMULA TYPE string.
TYPES COLUMN_NAME TYPE ZEXCEL_COLUMN_NAME.
TYPES CURRENCY_COLUMN TYPE ZEXCEL_FIELDNAME.
TYPES END OF ZEXCEL_S_FIELDCATALOG.
TYPES BEGIN OF ZEXCEL_S_GRADIENT_TYPE.
TYPES TYPE TYPE ZEXCEL_FILL_TYPE.
TYPES DEGREE TYPE C LENGTH 3.
TYPES BOTTOM TYPE C LENGTH 3.
TYPES LEFT TYPE C LENGTH 3.
TYPES TOP TYPE C LENGTH 3.
TYPES RIGHT TYPE C LENGTH 3.
TYPES POSITION1 TYPE C LENGTH 3.
TYPES POSITION2 TYPE C LENGTH 3.
TYPES POSITION3 TYPE C LENGTH 3.
TYPES END OF ZEXCEL_S_GRADIENT_TYPE.
TYPES BEGIN OF ZEXCEL_S_STYLES_COND_MAPPING.
TYPES GUID TYPE X LENGTH 16.
TYPES STYLE TYPE INT4.
TYPES DXF TYPE INT4.
TYPES END OF ZEXCEL_S_STYLES_COND_MAPPING.
TYPES BEGIN OF ZEXCEL_S_STYLES_MAPPING.
TYPES GUID TYPE X LENGTH 16.
TYPES STYLE TYPE INT4.
TYPES END OF ZEXCEL_S_STYLES_MAPPING.
TYPES BEGIN OF ZEXCEL_S_STYLE_ALIGNMENT.
TYPES HORIZONTAL TYPE ZEXCEL_ALIGNMENT.
TYPES VERTICAL TYPE ZEXCEL_ALIGNMENT.
TYPES TEXTROTATION TYPE ZEXCEL_TEXT_ROTATION.
TYPES WRAPTEXT TYPE FLAG.
TYPES SHRINKTOFIT TYPE FLAG.
TYPES INDENT TYPE ZEXCEL_INDENT.
TYPES END OF ZEXCEL_S_STYLE_ALIGNMENT.
TYPES BEGIN OF ZEXCEL_S_STYLE_COLOR.
TYPES RGB TYPE ZEXCEL_STYLE_COLOR_ARGB.
TYPES INDEXED TYPE ZEXCEL_STYLE_COLOR_INDEXED.
TYPES THEME TYPE ZEXCEL_STYLE_COLOR_THEME.
TYPES TINT TYPE ZEXCEL_STYLE_COLOR_TINT.
TYPES END OF ZEXCEL_S_STYLE_COLOR.
TYPES BEGIN OF ZEXCEL_S_STYLE_FILL.
TYPES FILLTYPE TYPE ZEXCEL_FILL_TYPE.
TYPES ROTATION TYPE ZEXCEL_ROTATION.
TYPES FGCOLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES BGCOLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES GRADTYPE TYPE ZEXCEL_S_GRADIENT_TYPE.
TYPES END OF ZEXCEL_S_STYLE_FILL.
TYPES BEGIN OF ZEXCEL_S_STYLE_FONT.
TYPES BOLD TYPE FLAG.
TYPES ITALIC TYPE FLAG.
TYPES UNDERLINE TYPE FLAG.
TYPES UNDERLINE_MODE TYPE C LENGTH 20.
TYPES STRIKETHROUGH TYPE FLAG.
TYPES SIZE TYPE INT1.
TYPES COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES NAME TYPE C LENGTH 255.
TYPES FAMILY TYPE INT1.
TYPES SCHEME TYPE ZEXCEL_STYLE_FONT_SCHEME.
TYPES END OF ZEXCEL_S_STYLE_FONT.
TYPES BEGIN OF ZEXCEL_S_STYLE_NUMFMT.
TYPES NUMFMT TYPE ZEXCEL_NUMBER_FORMAT.
TYPES END OF ZEXCEL_S_STYLE_NUMFMT.
TYPES BEGIN OF ZEXCEL_S_STYLE_PROTECTION.
TYPES LOCKED TYPE ZEXCEL_LOCKED.
TYPES HIDDEN TYPE ZEXCEL_HIDDEN.
TYPES END OF ZEXCEL_S_STYLE_PROTECTION.
TYPES BEGIN OF ZEXCEL_S_TABCOLOR.
TYPES RGB TYPE ZEXCEL_STYLE_COLOR_ARGB.
TYPES END OF ZEXCEL_S_TABCOLOR.
TYPES BEGIN OF ZEXCEL_S_TABLE_SETTINGS.
TYPES TABLE_STYLE TYPE ZEXCEL_TABLE_STYLE.
TYPES TABLE_NAME TYPE string.
TYPES TOP_LEFT_COLUMN TYPE ZEXCEL_CELL_COLUMN_ALPHA.
TYPES TOP_LEFT_ROW TYPE ZEXCEL_CELL_ROW.
TYPES SHOW_ROW_STRIPES TYPE FLAG.
TYPES SHOW_COLUMN_STRIPES TYPE FLAG.
TYPES BOTTOM_RIGHT_COLUMN TYPE ZEXCEL_CELL_COLUMN_ALPHA.
TYPES BOTTOM_RIGHT_ROW TYPE ZEXCEL_CELL_ROW.
TYPES NOFILTERS TYPE FLAG.
TYPES END OF ZEXCEL_S_TABLE_SETTINGS.
TYPES BEGIN OF ZEXCEL_S_WORKSHEET_HEAD_FOOT.
TYPES LEFT_VALUE TYPE string.
TYPES LEFT_FONT TYPE ZEXCEL_S_STYLE_FONT.
TYPES CENTER_VALUE TYPE string.
TYPES CENTER_FONT TYPE ZEXCEL_S_STYLE_FONT.
TYPES RIGHT_VALUE TYPE string.
TYPES RIGHT_FONT TYPE ZEXCEL_S_STYLE_FONT.
TYPES LEFT_IMAGE TYPE REF TO LCL_EXCEL_DRAWING.
TYPES RIGHT_IMAGE TYPE REF TO LCL_EXCEL_DRAWING.
TYPES CENTER_IMAGE TYPE REF TO LCL_EXCEL_DRAWING.
TYPES END OF ZEXCEL_S_WORKSHEET_HEAD_FOOT.
TYPES ZEXCEL_T_AUTOFILTER_VALUES TYPE STANDARD TABLE OF ZEXCEL_S_AUTOFILTER_VALUES WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_CELLXFS TYPE STANDARD TABLE OF ZEXCEL_S_CELLXFS WITH NON-UNIQUE KEY NUMFMTID FONTID FILLID BORDERID XFID ALIGNMENTID PROTECTIONID APPLYNUMBERFORMAT APPLYFONT APPLYFILL APPLYBORDER APPLYALIGNMENT APPLYPROTECTION.
TYPES ZEXCEL_T_CONVERTER_COL TYPE HASHED TABLE OF ZEXCEL_S_CONVERTER_COL WITH UNIQUE KEY ROWNUMBER COLUMNNAME.
TYPES ZEXCEL_T_CONVERTER_FCAT TYPE STANDARD TABLE OF ZEXCEL_S_CONVERTER_FCAT WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_CONVERTER_FIL TYPE HASHED TABLE OF ZEXCEL_S_CONVERTER_FIL WITH UNIQUE KEY ROWNUMBER COLUMNNAME.
TYPES ZEXCEL_T_DRAWINGS TYPE STANDARD TABLE OF ZEXCEL_S_DRAWINGS WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_FIELDCATALOG TYPE STANDARD TABLE OF ZEXCEL_S_FIELDCATALOG WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_STYLES_COND_MAPPING TYPE STANDARD TABLE OF ZEXCEL_S_STYLES_COND_MAPPING WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_STYLES_MAPPING TYPE STANDARD TABLE OF ZEXCEL_S_STYLES_MAPPING WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_STYLE_ALIGNMENT TYPE STANDARD TABLE OF ZEXCEL_S_STYLE_ALIGNMENT WITH NON-UNIQUE KEY HORIZONTAL VERTICAL TEXTROTATION WRAPTEXT SHRINKTOFIT INDENT.
TYPES ZEXCEL_T_STYLE_COLOR_ARGB TYPE STANDARD TABLE OF ZEXCEL_STYLE_COLOR_ARGB WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_STYLE_FILL TYPE STANDARD TABLE OF ZEXCEL_S_STYLE_FILL WITH NON-UNIQUE KEY FILLTYPE ROTATION FGCOLOR BGCOLOR GRADTYPE.
TYPES ZEXCEL_T_STYLE_FONT TYPE STANDARD TABLE OF ZEXCEL_S_STYLE_FONT WITH NON-UNIQUE KEY BOLD ITALIC UNDERLINE UNDERLINE_MODE STRIKETHROUGH SIZE COLOR NAME FAMILY SCHEME.
TYPES ZEXCEL_T_STYLE_NUMFMT TYPE STANDARD TABLE OF ZEXCEL_S_STYLE_NUMFMT WITH NON-UNIQUE KEY NUMFMT.
TYPES ZEXCEL_T_STYLE_PROTECTION TYPE STANDARD TABLE OF ZEXCEL_S_STYLE_PROTECTION WITH NON-UNIQUE KEY LOCKED HIDDEN.
TYPES BEGIN OF ZEXCEL_DRAWING_POSITION.
TYPES ANCHOR TYPE ZEXCEL_DRAWING_ANCHOR.
TYPES FROM TYPE ZEXCEL_DRAWING_LOCATION.
TYPES TO TYPE ZEXCEL_DRAWING_LOCATION.
TYPES SIZE TYPE ZEXCEL_DRAWING_SIZE.
TYPES END OF ZEXCEL_DRAWING_POSITION.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_BORDER.
TYPES BORDER_STYLE TYPE FLAG.
TYPES BORDER_COLOR TYPE ZEXCEL_S_CSTYLEX_COLOR.
TYPES END OF ZEXCEL_S_CSTYLEX_BORDER.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_BORDERS.
TYPES ALLBORDERS TYPE ZEXCEL_S_CSTYLEX_BORDER.
TYPES DIAGONAL TYPE ZEXCEL_S_CSTYLEX_BORDER.
TYPES DIAGONAL_MODE TYPE FLAG.
TYPES DOWN TYPE ZEXCEL_S_CSTYLEX_BORDER.
TYPES LEFT TYPE ZEXCEL_S_CSTYLEX_BORDER.
TYPES RIGHT TYPE ZEXCEL_S_CSTYLEX_BORDER.
TYPES TOP TYPE ZEXCEL_S_CSTYLEX_BORDER.
TYPES END OF ZEXCEL_S_CSTYLEX_BORDERS.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_FILL.
TYPES FILLTYPE TYPE FLAG.
TYPES ROTATION TYPE FLAG.
TYPES FGCOLOR TYPE ZEXCEL_S_CSTYLEX_COLOR.
TYPES BGCOLOR TYPE ZEXCEL_S_CSTYLEX_COLOR.
TYPES GRADTYPE TYPE ZEXCEL_S_CSTYLEX_GRADTYPE.
TYPES END OF ZEXCEL_S_CSTYLEX_FILL.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_BORDER.
TYPES BORDER_STYLE TYPE ZEXCEL_BORDER.
TYPES BORDER_COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES END OF ZEXCEL_S_CSTYLE_BORDER.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_BORDERS.
TYPES ALLBORDERS TYPE ZEXCEL_S_CSTYLE_BORDER.
TYPES DIAGONAL TYPE ZEXCEL_S_CSTYLE_BORDER.
TYPES DIAGONAL_MODE TYPE ZEXCEL_DIAGONAL.
TYPES DOWN TYPE ZEXCEL_S_CSTYLE_BORDER.
TYPES LEFT TYPE ZEXCEL_S_CSTYLE_BORDER.
TYPES RIGHT TYPE ZEXCEL_S_CSTYLE_BORDER.
TYPES TOP TYPE ZEXCEL_S_CSTYLE_BORDER.
TYPES END OF ZEXCEL_S_CSTYLE_BORDERS.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_FILL.
TYPES FILLTYPE TYPE ZEXCEL_FILL_TYPE.
TYPES ROTATION TYPE ZEXCEL_ROTATION.
TYPES FGCOLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES BGCOLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES GRADTYPE TYPE ZEXCEL_S_CSTYLEX_GRADTYPE.
TYPES END OF ZEXCEL_S_CSTYLE_FILL.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_FONT.
TYPES BOLD TYPE FLAG.
TYPES COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES FAMILY TYPE ZEXCEL_STYLE_FONT_FAMILY.
TYPES ITALIC TYPE FLAG.
TYPES NAME TYPE ZEXCEL_STYLE_FONT_NAME.
TYPES SCHEME TYPE ZEXCEL_STYLE_FONT_SCHEME.
TYPES SIZE TYPE ZEXCEL_STYLE_FONT_SIZE.
TYPES STRIKETHROUGH TYPE FLAG.
TYPES UNDERLINE TYPE FLAG.
TYPES UNDERLINE_MODE TYPE ZEXCEL_STYLE_FONT_UNDERLINE.
TYPES END OF ZEXCEL_S_CSTYLE_FONT.
TYPES BEGIN OF ZEXCEL_S_RTF.
TYPES OFFSET TYPE INT2.
TYPES LENGTH TYPE INT2.
TYPES FONT TYPE ZEXCEL_S_STYLE_FONT.
TYPES END OF ZEXCEL_S_RTF.
TYPES BEGIN OF ZEXCEL_S_STYLE_BORDER.
TYPES LEFT_COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES LEFT_STYLE TYPE ZEXCEL_BORDER.
TYPES RIGHT_COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES RIGHT_STYLE TYPE ZEXCEL_BORDER.
TYPES TOP_COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES TOP_STYLE TYPE ZEXCEL_BORDER.
TYPES BOTTOM_COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES BOTTOM_STYLE TYPE ZEXCEL_BORDER.
TYPES DIAGONAL_COLOR TYPE ZEXCEL_S_STYLE_COLOR.
TYPES DIAGONAL_STYLE TYPE ZEXCEL_BORDER.
TYPES DIAGONALUP TYPE INT1.
TYPES DIAGONALDOWN TYPE INT1.
TYPES END OF ZEXCEL_S_STYLE_BORDER.
TYPES ZEXCEL_T_RTF TYPE SORTED TABLE OF ZEXCEL_S_RTF WITH UNIQUE KEY OFFSET.
TYPES ZEXCEL_T_STYLE_BORDER TYPE STANDARD TABLE OF ZEXCEL_S_STYLE_BORDER WITH NON-UNIQUE KEY LEFT_COLOR LEFT_STYLE RIGHT_COLOR RIGHT_STYLE TOP_COLOR TOP_STYLE BOTTOM_COLOR BOTTOM_STYLE DIAGONAL_COLOR DIAGONAL_STYLE DIAGONALUP DIAGONALDOWN.
TYPES BEGIN OF ZEXCEL_S_CELL_DATA.
TYPES CELL_ROW TYPE ZEXCEL_CELL_ROW.
TYPES CELL_COLUMN TYPE ZEXCEL_CELL_COLUMN.
TYPES CELL_VALUE TYPE ZEXCEL_CELL_VALUE.
TYPES CELL_FORMULA TYPE ZEXCEL_CELL_FORMULA.
TYPES CELL_COORDS TYPE ZEXCEL_CELL_COORDS.
TYPES CELL_STYLE TYPE ZEXCEL_CELL_STYLE.
TYPES DATA_TYPE TYPE ZEXCEL_CELL_DATA_TYPE.
TYPES COLUMN_FORMULA_ID TYPE I.
TYPES RTF_TAB TYPE ZEXCEL_T_RTF.
TYPES TABLE TYPE REF TO LCL_EXCEL_TABLE.
TYPES TABLE_FIELDNAME TYPE ZEXCEL_FIELDNAME.
TYPES TABLE_HEADER TYPE FLAG.
TYPES END OF ZEXCEL_S_CELL_DATA.
TYPES BEGIN OF ZEXCEL_S_CSTYLEX_COMPLETE.
TYPES FONT TYPE ZEXCEL_S_CSTYLEX_FONT.
TYPES FILL TYPE ZEXCEL_S_CSTYLEX_FILL.
TYPES BORDERS TYPE ZEXCEL_S_CSTYLEX_BORDERS.
TYPES ALIGNMENT TYPE ZEXCEL_S_CSTYLEX_ALIGNMENT.
TYPES NUMBER_FORMAT TYPE ZEXCEL_S_CSTYLEX_NUMBER_FORMAT.
TYPES PROTECTION TYPE ZEXCEL_S_CSTYLEX_PROTECTION.
TYPES END OF ZEXCEL_S_CSTYLEX_COMPLETE.
TYPES BEGIN OF ZEXCEL_S_CSTYLE_COMPLETE.
TYPES FONT TYPE ZEXCEL_S_CSTYLE_FONT.
TYPES FILL TYPE ZEXCEL_S_CSTYLE_FILL.
TYPES BORDERS TYPE ZEXCEL_S_CSTYLE_BORDERS.
TYPES ALIGNMENT TYPE ZEXCEL_S_CSTYLE_ALIGNMENT.
TYPES NUMBER_FORMAT TYPE ZEXCEL_S_CSTYLE_NUMBER_FORMAT.
TYPES PROTECTION TYPE ZEXCEL_S_CSTYLE_PROTECTION.
TYPES END OF ZEXCEL_S_CSTYLE_COMPLETE.
TYPES BEGIN OF ZEXCEL_S_SHARED_STRING.
TYPES STRING_NO TYPE INT4.
TYPES STRING_VALUE TYPE ZEXCEL_CELL_VALUE.
TYPES STRING_TYPE TYPE ZEXCEL_CELL_DATA_TYPE.
TYPES RTF_TAB TYPE ZEXCEL_T_RTF.
TYPES END OF ZEXCEL_S_SHARED_STRING.
TYPES BEGIN OF ZEXCEL_S_STYLEMAPPING.
TYPES DYNAMIC_STYLE_GUID TYPE ZEXCEL_CELL_STYLE.
TYPES COMPLETE_STYLE TYPE ZEXCEL_S_CSTYLE_COMPLETE.
TYPES COMPLETE_STYLEX TYPE ZEXCEL_S_CSTYLEX_COMPLETE.
TYPES GUID TYPE ZEXCEL_CELL_STYLE.
TYPES ADDED_TO_ITERATOR TYPE FLAG.
TYPES END OF ZEXCEL_S_STYLEMAPPING.
TYPES ZEXCEL_T_CELL_DATA TYPE SORTED TABLE OF ZEXCEL_S_CELL_DATA WITH UNIQUE KEY CELL_ROW CELL_COLUMN.
TYPES ZEXCEL_T_CELL_DATA_UNSORTED TYPE STANDARD TABLE OF ZEXCEL_S_CELL_DATA WITH NON-UNIQUE DEFAULT KEY.
TYPES ZEXCEL_T_SHARED_STRING TYPE SORTED TABLE OF ZEXCEL_S_SHARED_STRING WITH NON-UNIQUE KEY STRING_VALUE.
TYPES ZEXCEL_T_STYLEMAPPING1 TYPE HASHED TABLE OF ZEXCEL_S_STYLEMAPPING WITH UNIQUE KEY DYNAMIC_STYLE_GUID COMPLETE_STYLEX COMPLETE_STYLE.
TYPES ZEXCEL_T_STYLEMAPPING2 TYPE HASHED TABLE OF ZEXCEL_S_STYLEMAPPING WITH UNIQUE KEY GUID.
*class-pool .
*"* class pool for class LCL_EXCEL_COLLECTION

*"* local type definitions
*include Lcl_excel_collection==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_COLLECTION definition
*"* public declarations
*include Lcl_excel_collection==========cu.
CLASS Lcl_excel_collection DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
      ty_collection TYPE STANDARD TABLE OF REF TO object .

    DATA collection TYPE ty_collection READ-ONLY .

    METHODS size
      RETURNING
        VALUE(size) TYPE i .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE abap_bool .
    METHODS get
      IMPORTING
        !index        TYPE i
      RETURNING
        VALUE(object) TYPE REF TO object .
    METHODS get_iterator
      RETURNING
        VALUE(iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS add
      IMPORTING
        !element TYPE REF TO object .
    METHODS remove
      IMPORTING
        !element TYPE REF TO object .
    METHODS clear .
*"* protected declarations
*include Lcl_excel_collection==========co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_collection==========ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_COLLECTION definition
*class-pool .
*"* class pool for class LCL_EXCEL_COLLECTION_ITERATOR

*"* local type definitions
*include Lcl_excel_collection_iterator=ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_COLLECTION_ITERATOR definition
*"* public declarations
*include Lcl_excel_collection_iterator=cu.
CLASS Lcl_excel_collection_iterator DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
    METHODS get_index
      RETURNING
        VALUE(index) TYPE i.
    METHODS has_next
      RETURNING
        VALUE(has_next) TYPE abap_bool.
    METHODS get_next
      RETURNING
        VALUE(object) TYPE REF TO object.
    METHODS constructor
      IMPORTING
        collection TYPE REF TO Lcl_excel_collection.
*"* protected declarations
*include Lcl_excel_collection_iterator=co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_collection_iterator=ci.
  PRIVATE SECTION.
    DATA index TYPE i VALUE 0.
    DATA collection TYPE REF TO Lcl_excel_collection.
endclass. "LCL_EXCEL_COLLECTION_ITERATOR definition
*class-pool .
*"* class pool for class LCL_EXCEL_COMMENT

*"* local type definitions
*include Lcl_excel_comment=============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_COMMENT definition
*"* public declarations
*include Lcl_excel_comment=============cu.
CLASS Lcl_excel_comment DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    METHODS constructor .
    METHODS get_name
      RETURNING
        VALUE(r_name) TYPE string .
    METHODS get_index
      RETURNING
        VALUE(rp_index) TYPE string .
    METHODS get_ref
      RETURNING
        VALUE(rp_ref) TYPE string .
    METHODS get_text
      RETURNING
        VALUE(rp_text) TYPE string .
    METHODS set_text
      IMPORTING
        !ip_text TYPE string
        !ip_ref  TYPE string OPTIONAL .
*"* protected declarations
*include Lcl_excel_comment=============co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_comment=============ci.
  PRIVATE SECTION.

    DATA index TYPE string .
    DATA ref TYPE string .
    DATA text TYPE string .
endclass. "LCL_EXCEL_COMMENT definition
*class-pool .
*"* class pool for class LCL_EXCEL_COMMENTS

*"* local type definitions
*include Lcl_excel_comments============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_COMMENTS definition
*"* public declarations
*include Lcl_excel_comments============cu.
CLASS Lcl_excel_comments DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    METHODS add
      IMPORTING
        !ip_comment TYPE REF TO Lcl_excel_comment .
    METHODS include
      IMPORTING
        !ip_comment TYPE REF TO Lcl_excel_comment .
    METHODS clear .
    METHODS constructor .
    METHODS get
      IMPORTING
        !ip_index         TYPE zexcel_active_worksheet
      RETURNING
        VALUE(eo_comment) TYPE REF TO Lcl_excel_comment .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !ip_comment TYPE REF TO Lcl_excel_comment .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
*"* protected declarations
*include Lcl_excel_comments============co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_comments============ci.
  PRIVATE SECTION.

    DATA comments TYPE REF TO Lcl_excel_collection .
endclass. "LCL_EXCEL_COMMENTS definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER_SALV_MODEL

*"* local type definitions
*include Lcl_excel_converter_salv_modelccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_CONVERTER_SALV_MODEL definition
*"* public declarations
*include Lcl_excel_converter_salv_modelcu.
CLASS Lcl_excel_converter_salv_model DEFINITION
*public
  INHERITING FROM cl_salv_model
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
    CLASS-METHODS is_get_metadata_callable
      IMPORTING
        io_salv       TYPE REF TO cl_salv_table
      RETURNING
        VALUE(result) TYPE abap_bool.
*"* protected declarations
*include Lcl_excel_converter_salv_modelco.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_converter_salv_modelci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_CONVERTER_SALV_MODEL definition
*class-pool .
*"* class pool for class LCL_EXCEL_DATA_VALIDATION

*"* local type definitions
*include Lcl_excel_data_validation=====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_DATA_VALIDATION definition
*"* public declarations
*include Lcl_excel_data_validation=====cu.
CLASS Lcl_excel_data_validation DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_DATA_VALIDATION
*"* do not include other source files here!!!

    DATA errorstyle TYPE zexcel_data_val_error_style .
    DATA operator TYPE zexcel_data_val_operator .
    DATA allowblank TYPE flag VALUE 'X'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA cell_column TYPE zexcel_cell_column_alpha .
    DATA cell_column_to TYPE zexcel_cell_column_alpha .
    DATA cell_row TYPE zexcel_cell_row .
    DATA cell_row_to TYPE zexcel_cell_row .
    CONSTANTS c_type_custom TYPE zexcel_data_val_type VALUE 'custom'. "#EC NOTEXT
    CONSTANTS c_type_list TYPE zexcel_data_val_type VALUE 'list'. "#EC NOTEXT
    DATA showerrormessage TYPE abap_bool VALUE 'X'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA showinputmessage TYPE abap_bool VALUE 'X'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA type TYPE zexcel_data_val_type .
    DATA formula1 TYPE zexcel_validation_formula1 .
    DATA formula2 TYPE zexcel_validation_formula1 .
    CONSTANTS c_type_none TYPE zexcel_data_val_type VALUE 'none'. "#EC NOTEXT
    CONSTANTS c_type_date TYPE zexcel_data_val_type VALUE 'date'. "#EC NOTEXT
    CONSTANTS c_type_decimal TYPE zexcel_data_val_type VALUE 'decimal'. "#EC NOTEXT
    CONSTANTS c_type_textlength TYPE zexcel_data_val_type VALUE 'textLength'. "#EC NOTEXT
    CONSTANTS c_type_time TYPE zexcel_data_val_type VALUE 'time'. "#EC NOTEXT
    CONSTANTS c_type_whole TYPE zexcel_data_val_type VALUE 'whole'. "#EC NOTEXT
    CONSTANTS c_style_stop TYPE zexcel_data_val_error_style VALUE 'stop'. "#EC NOTEXT
    CONSTANTS c_style_warning TYPE zexcel_data_val_error_style VALUE 'warning'. "#EC NOTEXT
    CONSTANTS c_style_information TYPE zexcel_data_val_error_style VALUE 'information'. "#EC NOTEXT
    CONSTANTS c_operator_between TYPE zexcel_data_val_operator VALUE 'between'. "#EC NOTEXT
    CONSTANTS c_operator_equal TYPE zexcel_data_val_operator VALUE 'equal'. "#EC NOTEXT
    CONSTANTS c_operator_greaterthan TYPE zexcel_data_val_operator VALUE 'greaterThan'. "#EC NOTEXT
    CONSTANTS c_operator_greaterthanorequal TYPE zexcel_data_val_operator VALUE 'greaterThanOrEqual'. "#EC NOTEXT
    CONSTANTS c_operator_lessthan TYPE zexcel_data_val_operator VALUE 'lessThan'. "#EC NOTEXT
    CONSTANTS c_operator_lessthanorequal TYPE zexcel_data_val_operator VALUE 'lessThanOrEqual'. "#EC NOTEXT
    CONSTANTS c_operator_notbetween TYPE zexcel_data_val_operator VALUE 'notBetween'. "#EC NOTEXT
    CONSTANTS c_operator_notequal TYPE zexcel_data_val_operator VALUE 'notEqual'. "#EC NOTEXT
    DATA showdropdown TYPE abap_bool .
    DATA errortitle TYPE string .
    DATA error TYPE string .
    DATA prompttitle TYPE string .
    DATA prompt TYPE string .

    METHODS constructor .
*"* protected components of class LCL_EXCEL_DATA_VALIDATION
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_DATA_VALIDATION
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_data_validation=====co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_data_validation=====ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_DATA_VALIDATION
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_DATA_VALIDATION definition
*class-pool .
*"* class pool for class LCL_EXCEL_DATA_VALIDATIONS

*"* local type definitions
*include Lcl_excel_data_validations====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_DATA_VALIDATIONS definition
*"* public declarations
*include Lcl_excel_data_validations====cu.
CLASS Lcl_excel_data_validations DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_DATA_VALIDATIONS
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS add
      IMPORTING
        !ip_data_validation TYPE REF TO Lcl_excel_data_validation .
    METHODS clear .
    METHODS constructor .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !ip_data_validation TYPE REF TO Lcl_excel_data_validation .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
*"* protected components of class LCL_EXCEL_DATA_VALIDATIONS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_data_validations====co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_DATA_VALIDATIONS
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_data_validations====ci.
  PRIVATE SECTION.

    DATA data_validations TYPE REF TO Lcl_excel_collection .
endclass. "LCL_EXCEL_DATA_VALIDATIONS definition
*class-pool .
*"* class pool for class LCL_EXCEL_FONT

*"* local type definitions
*include Lcl_excel_font================ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_FONT definition
*"* public declarations
*include Lcl_excel_font================cu.
CLASS Lcl_excel_font DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
      BEGIN OF mty_s_font_metric,
        char       TYPE c LENGTH 1,
        char_width TYPE tdcwidths,
      END OF mty_s_font_metric .
    TYPES:
      mty_th_font_metrics
               TYPE HASHED TABLE OF mty_s_font_metric
               WITH UNIQUE KEY char .
    TYPES:
      BEGIN OF mty_s_font_cache,
        font_name       TYPE zexcel_style_font_name,
        font_height     TYPE tdfontsize,
        flag_bold       TYPE abap_bool,
        flag_italic     TYPE abap_bool,
        th_font_metrics TYPE mty_th_font_metrics,
      END OF mty_s_font_cache .
    TYPES:
      mty_th_font_cache
               TYPE HASHED TABLE OF mty_s_font_cache
               WITH UNIQUE KEY font_name font_height flag_bold flag_italic .

    CONSTANTS lc_default_font_height TYPE tdfontsize VALUE '110' ##NO_TEXT.
    CONSTANTS lc_default_font_name TYPE zexcel_style_font_name VALUE 'Calibri' ##NO_TEXT.
    CLASS-DATA mth_font_cache TYPE mty_th_font_cache .

    CLASS-METHODS calculate_text_width
      IMPORTING
        !iv_font_name   TYPE zexcel_style_font_name
        !iv_font_height TYPE tdfontsize
        !iv_flag_bold   TYPE abap_bool
        !iv_flag_italic TYPE abap_bool
        !iv_cell_value  TYPE zexcel_cell_value
      RETURNING
        VALUE(rv_width) TYPE f .
*"* protected declarations
*include Lcl_excel_font================co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_font================ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_FONT definition
*class-pool .
*"* class pool for class LCL_EXCEL_OBSOLETE_FUNC_WRAP

*"* local type definitions
*include Lcl_excel_obsolete_func_wrap==ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_OBSOLETE_FUNC_WRAP definition
*"* public declarations
*include Lcl_excel_obsolete_func_wrap==cu.
CLASS Lcl_excel_obsolete_func_wrap DEFINITION
*public
  CREATE PUBLIC .

  PUBLIC SECTION.

    CLASS-METHODS guid_create
      RETURNING
        VALUE(rv_guid_16) TYPE zexcel_guid .
*"* protected declarations
*include Lcl_excel_obsolete_func_wrap==co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_obsolete_func_wrap==ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_OBSOLETE_FUNC_WRAP definition
*class-pool .
*"* class pool for class LCL_EXCEL_OLE

*"* local type definitions
*include Lcl_excel_ole=================ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section

*--------------------------------------------------------------------*
* CLASS SHRITEFUH64VYIPN5I4UIDBJAA4SE4
*--------------------------------------------------------------------*
* use for method bind_ALV
*--------------------------------------------------------------------*
CLASS SHRITEFUH64VYIPN5I4UIDBJAA4SE4 DEFINITION.
  PUBLIC SECTION.
    INTERFACES: i_oi_error.
    DATA: error_nr TYPE i.
    DATA: error_string TYPE sy-msgv1.

    METHODS: constructor IMPORTING object_name TYPE c
                                   method_name TYPE c.
  PRIVATE SECTION.
    CONSTANTS:
          ret_call_not_flushed        TYPE i VALUE -999999.

    DATA: message_id TYPE sy-msgid,
          message_nr TYPE sy-msgno,
          param1 TYPE sy-msgv1,
          param2 TYPE sy-msgv2,
          param3 TYPE sy-msgv3,
          param4 TYPE sy-msgv4.
ENDCLASS.                    "SHRITEFUH64VYIPN5I4UIDBJAA4SE4 DEFINITION
*class-pool .
*"* class pool for class LCL_EXCEL_RANGES

*"* local type definitions
*include Lcl_excel_ranges==============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_RANGES definition
*"* public declarations
*include Lcl_excel_ranges==============cu.
CLASS Lcl_excel_ranges DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_RANGES
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS add
      IMPORTING
        !ip_range TYPE REF TO Lcl_excel_range .
    METHODS clear .
    METHODS constructor .
    METHODS get
      IMPORTING
        !ip_index       TYPE i
      RETURNING
        VALUE(eo_range) TYPE REF TO Lcl_excel_range .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !ip_range TYPE REF TO Lcl_excel_range .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_ranges==============co.
  PROTECTED SECTION.
*"* private components of class ZABAP_EXCEL_RANGES
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_ranges==============ci.
  PRIVATE SECTION.

    DATA ranges TYPE REF TO Lcl_excel_collection .
endclass. "LCL_EXCEL_RANGES definition
*class-pool .
*"* class pool for class LCL_EXCEL_SECURITY

*"* local type definitions
*include Lcl_excel_security============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_SECURITY definition
*"* public declarations
*include Lcl_excel_security============cu.
CLASS Lcl_excel_security DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_SECURITY
*"* do not include other source files here!!!
  PUBLIC SECTION.

    DATA lockrevision TYPE flag .
    DATA lockstructure TYPE flag .
    DATA lockwindows TYPE flag .
    DATA revisionspassword TYPE zexcel_revisionspassword .
    DATA workbookpassword TYPE zexcel_workbookpassword .

    METHODS is_security_enabled
      RETURNING
        VALUE(ep_security_enabled) TYPE flag .
*"* protected components of class ZABAP_EXCEL_SECURITY
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_SECURITY
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_security============co.
  PROTECTED SECTION.
*"* private components of class ZABAP_EXCEL_SECURITY
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_security============ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_SECURITY definition
*class-pool .
*"* class pool for class LCL_EXCEL_SHEET_SETUP

*"* local type definitions
*include Lcl_excel_sheet_setup=========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_SHEET_SETUP definition
*"* public declarations
*include Lcl_excel_sheet_setup=========cu.
CLASS Lcl_excel_sheet_setup DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_SHEET_SETUP
*"* do not include other source files here!!!

    DATA black_and_white TYPE flag .
    DATA cell_comments TYPE string .
    DATA copies TYPE int2 .
    CONSTANTS c_break_column TYPE zexcel_break VALUE 2.     "#EC NOTEXT
    CONSTANTS c_break_none TYPE zexcel_break VALUE 0.       "#EC NOTEXT
    CONSTANTS c_break_row TYPE zexcel_break VALUE 1.        "#EC NOTEXT
    CONSTANTS c_cc_as_displayed TYPE string VALUE 'asDisplayed'. "#EC NOTEXT
    CONSTANTS c_cc_at_end TYPE string VALUE 'atEnd'.        "#EC NOTEXT
    CONSTANTS c_cc_none TYPE string VALUE 'none'.           "#EC NOTEXT
    CONSTANTS c_ord_downthenover TYPE string VALUE 'downThenOver'. "#EC NOTEXT
    CONSTANTS c_ord_overthendown TYPE string VALUE 'overThenDown'. "#EC NOTEXT
    CONSTANTS c_orientation_default TYPE zexcel_sheet_orienatation VALUE 'default'. "#EC NOTEXT
    CONSTANTS c_orientation_landscape TYPE zexcel_sheet_orienatation VALUE 'landscape'. "#EC NOTEXT
    CONSTANTS c_orientation_portrait TYPE zexcel_sheet_orienatation VALUE 'portrait'. "#EC NOTEXT
    CONSTANTS c_papersize_6_3_4_envelope TYPE zexcel_sheet_paper_size VALUE 38. "#EC NOTEXT
    CONSTANTS c_papersize_a2_paper TYPE zexcel_sheet_paper_size VALUE 64. "#EC NOTEXT
    CONSTANTS c_papersize_a3 TYPE zexcel_sheet_paper_size VALUE 8. "#EC NOTEXT
    CONSTANTS c_papersize_a3_extra_paper TYPE zexcel_sheet_paper_size VALUE 61. "#EC NOTEXT
    CONSTANTS c_papersize_a3_extra_tv_paper TYPE zexcel_sheet_paper_size VALUE 66. "#EC NOTEXT
    CONSTANTS c_papersize_a3_tv_paper TYPE zexcel_sheet_paper_size VALUE 65. "#EC NOTEXT
    CONSTANTS c_papersize_a4 TYPE zexcel_sheet_paper_size VALUE 9. "#EC NOTEXT
    CONSTANTS c_papersize_a4_extra_paper TYPE zexcel_sheet_paper_size VALUE 51. "#EC NOTEXT
    CONSTANTS c_papersize_a4_plus_paper TYPE zexcel_sheet_paper_size VALUE 58. "#EC NOTEXT
    CONSTANTS c_papersize_a4_small TYPE zexcel_sheet_paper_size VALUE 10. "#EC NOTEXT
    CONSTANTS c_papersize_a4_tv_paper TYPE zexcel_sheet_paper_size VALUE 53. "#EC NOTEXT
    CONSTANTS c_papersize_a5 TYPE zexcel_sheet_paper_size VALUE 11. "#EC NOTEXT
    CONSTANTS c_papersize_a5_extra_paper TYPE zexcel_sheet_paper_size VALUE 62. "#EC NOTEXT
    CONSTANTS c_papersize_a5_tv_paper TYPE zexcel_sheet_paper_size VALUE 59. "#EC NOTEXT
    CONSTANTS c_papersize_b4 TYPE zexcel_sheet_paper_size VALUE 12. "#EC NOTEXT
    CONSTANTS c_papersize_b4_envelope TYPE zexcel_sheet_paper_size VALUE 33. "#EC NOTEXT
    CONSTANTS c_papersize_b5 TYPE zexcel_sheet_paper_size VALUE 13. "#EC NOTEXT
    CONSTANTS c_papersize_b5_envelope TYPE zexcel_sheet_paper_size VALUE 34. "#EC NOTEXT
    CONSTANTS c_papersize_b6_envelope TYPE zexcel_sheet_paper_size VALUE 35. "#EC NOTEXT
    CONSTANTS c_papersize_c TYPE zexcel_sheet_paper_size VALUE 24. "#EC NOTEXT
    CONSTANTS c_papersize_c3_envelope TYPE zexcel_sheet_paper_size VALUE 29. "#EC NOTEXT
    CONSTANTS c_papersize_c4_envelope TYPE zexcel_sheet_paper_size VALUE 30. "#EC NOTEXT
    CONSTANTS c_papersize_c5_envelope TYPE zexcel_sheet_paper_size VALUE 28. "#EC NOTEXT
    CONSTANTS c_papersize_c65_envelope TYPE zexcel_sheet_paper_size VALUE 32. "#EC NOTEXT
    CONSTANTS c_papersize_c6_envelope TYPE zexcel_sheet_paper_size VALUE 31. "#EC NOTEXT
    CONSTANTS c_papersize_d TYPE zexcel_sheet_paper_size VALUE 25. "#EC NOTEXT
    CONSTANTS c_papersize_de_leg_fanfold TYPE zexcel_sheet_paper_size VALUE 41. "#EC NOTEXT
    CONSTANTS c_papersize_de_std_fanfold TYPE zexcel_sheet_paper_size VALUE 40. "#EC NOTEXT
    CONSTANTS c_papersize_dl_envelope TYPE zexcel_sheet_paper_size VALUE 27. "#EC NOTEXT
    CONSTANTS c_papersize_e TYPE zexcel_sheet_paper_size VALUE 26. "#EC NOTEXT
    CONSTANTS c_papersize_executive TYPE zexcel_sheet_paper_size VALUE 7. "#EC NOTEXT
    CONSTANTS c_papersize_folio TYPE zexcel_sheet_paper_size VALUE 14. "#EC NOTEXT
    CONSTANTS c_papersize_invite_envelope TYPE zexcel_sheet_paper_size VALUE 47. "#EC NOTEXT
    CONSTANTS c_papersize_iso_b4 TYPE zexcel_sheet_paper_size VALUE 42. "#EC NOTEXT
    CONSTANTS c_papersize_iso_b5_extra_paper TYPE zexcel_sheet_paper_size VALUE 63. "#EC NOTEXT
    CONSTANTS c_papersize_italy_envelope TYPE zexcel_sheet_paper_size VALUE 36. "#EC NOTEXT
    CONSTANTS c_papersize_jis_b5_tv_paper TYPE zexcel_sheet_paper_size VALUE 60. "#EC NOTEXT
    CONSTANTS c_papersize_jpn_dbl_postcard TYPE zexcel_sheet_paper_size VALUE 43. "#EC NOTEXT
    CONSTANTS c_papersize_ledger TYPE zexcel_sheet_paper_size VALUE 4. "#EC NOTEXT
    CONSTANTS c_papersize_legal TYPE zexcel_sheet_paper_size VALUE 5. "#EC NOTEXT
    CONSTANTS c_papersize_legal_extra_paper TYPE zexcel_sheet_paper_size VALUE 49. "#EC NOTEXT
    CONSTANTS c_papersize_letter TYPE zexcel_sheet_paper_size VALUE 1. "#EC NOTEXT
    CONSTANTS c_papersize_letter_extra_paper TYPE zexcel_sheet_paper_size VALUE 48. "#EC NOTEXT
    CONSTANTS c_papersize_letter_extv_paper TYPE zexcel_sheet_paper_size VALUE 54. "#EC NOTEXT
    CONSTANTS c_papersize_letter_plus_paper TYPE zexcel_sheet_paper_size VALUE 57. "#EC NOTEXT
    CONSTANTS c_papersize_letter_small TYPE zexcel_sheet_paper_size VALUE 2. "#EC NOTEXT
    CONSTANTS c_papersize_letter_tv_paper TYPE zexcel_sheet_paper_size VALUE 52. "#EC NOTEXT
    CONSTANTS c_papersize_monarch_envelope TYPE zexcel_sheet_paper_size VALUE 37. "#EC NOTEXT
    CONSTANTS c_papersize_no10_envelope TYPE zexcel_sheet_paper_size VALUE 20. "#EC NOTEXT
    CONSTANTS c_papersize_no11_envelope TYPE zexcel_sheet_paper_size VALUE 21. "#EC NOTEXT
    CONSTANTS c_papersize_no12_envelope TYPE zexcel_sheet_paper_size VALUE 22. "#EC NOTEXT
    CONSTANTS c_papersize_no14_envelope TYPE zexcel_sheet_paper_size VALUE 23. "#EC NOTEXT
    CONSTANTS c_papersize_no9_envelope TYPE zexcel_sheet_paper_size VALUE 19. "#EC NOTEXT
    CONSTANTS c_papersize_note TYPE zexcel_sheet_paper_size VALUE 18. "#EC NOTEXT
    CONSTANTS c_papersize_quarto TYPE zexcel_sheet_paper_size VALUE 15. "#EC NOTEXT
    CONSTANTS c_papersize_standard_1 TYPE zexcel_sheet_paper_size VALUE 16. "#EC NOTEXT
    CONSTANTS c_papersize_standard_2 TYPE zexcel_sheet_paper_size VALUE 17. "#EC NOTEXT
    CONSTANTS c_papersize_standard_paper_1 TYPE zexcel_sheet_paper_size VALUE 44. "#EC NOTEXT
    CONSTANTS c_papersize_standard_paper_2 TYPE zexcel_sheet_paper_size VALUE 45. "#EC NOTEXT
    CONSTANTS c_papersize_standard_paper_3 TYPE zexcel_sheet_paper_size VALUE 46. "#EC NOTEXT
    CONSTANTS c_papersize_statement TYPE zexcel_sheet_paper_size VALUE 6. "#EC NOTEXT
    CONSTANTS c_papersize_supera_a4_paper TYPE zexcel_sheet_paper_size VALUE 55. "#EC NOTEXT
    CONSTANTS c_papersize_superb_a3_paper TYPE zexcel_sheet_paper_size VALUE 56. "#EC NOTEXT
    CONSTANTS c_papersize_tabloid TYPE zexcel_sheet_paper_size VALUE 3. "#EC NOTEXT
    CONSTANTS c_papersize_tabl_extra_paper TYPE zexcel_sheet_paper_size VALUE 50. "#EC NOTEXT
    CONSTANTS c_papersize_us_std_fanfold TYPE zexcel_sheet_paper_size VALUE 39. "#EC NOTEXT
    CONSTANTS c_pe_blank TYPE string VALUE 'blank'.         "#EC NOTEXT
    CONSTANTS c_pe_dash TYPE string VALUE 'dash'.           "#EC NOTEXT
    CONSTANTS c_pe_displayed TYPE string VALUE 'displayed'. "#EC NOTEXT
    CONSTANTS c_pe_na TYPE string VALUE 'NA'.               "#EC NOTEXT
    DATA diff_oddeven_headerfooter TYPE flag .
    DATA draft TYPE flag .
    DATA errors TYPE string .
    DATA even_footer TYPE zexcel_s_worksheet_head_foot .
    DATA even_header TYPE zexcel_s_worksheet_head_foot .
    DATA first_page_number TYPE int2 .
    DATA fit_to_height TYPE int2 .
    DATA fit_to_page TYPE flag .
    DATA fit_to_width TYPE int2 .
    DATA horizontal_centered TYPE flag .
    DATA horizontal_dpi TYPE int2 .
    DATA margin_bottom TYPE zexcel_dec_8_2 .
    DATA margin_footer TYPE zexcel_dec_8_2 .
    DATA margin_header TYPE zexcel_dec_8_2 .
    DATA margin_left TYPE zexcel_dec_8_2 .
    DATA margin_right TYPE zexcel_dec_8_2 .
    DATA margin_top TYPE zexcel_dec_8_2 .
    DATA odd_footer TYPE zexcel_s_worksheet_head_foot .
    DATA odd_header TYPE zexcel_s_worksheet_head_foot .
    DATA orientation TYPE zexcel_sheet_orienatation .
    DATA page_order TYPE string .
    DATA paper_height TYPE string .
    DATA paper_size TYPE int2 .
    DATA paper_width TYPE string .
    DATA scale TYPE int2 .
    DATA use_first_page_num TYPE flag .
    DATA use_printer_defaults TYPE flag .
    DATA vertical_centered TYPE flag .
    DATA vertical_dpi TYPE int2 .

    METHODS constructor .
    METHODS set_page_margins
      IMPORTING
        !ip_bottom TYPE f OPTIONAL
        !ip_footer TYPE f OPTIONAL
        !ip_header TYPE f OPTIONAL
        !ip_left   TYPE f OPTIONAL
        !ip_right  TYPE f OPTIONAL
        !ip_top    TYPE f OPTIONAL
        !ip_unit   TYPE csequence DEFAULT 'in' .
    METHODS set_header_footer
      IMPORTING
        !ip_odd_header  TYPE zexcel_s_worksheet_head_foot OPTIONAL
        !ip_odd_footer  TYPE zexcel_s_worksheet_head_foot OPTIONAL
        !ip_even_header TYPE zexcel_s_worksheet_head_foot OPTIONAL
        !ip_even_footer TYPE zexcel_s_worksheet_head_foot OPTIONAL .
    METHODS get_header_footer_string
      EXPORTING
        !ep_odd_header  TYPE string
        !ep_odd_footer  TYPE string
        !ep_even_header TYPE string
        !ep_even_footer TYPE string .
    METHODS get_header_footer
      EXPORTING
        !ep_odd_header  TYPE zexcel_s_worksheet_head_foot
        !ep_odd_footer  TYPE zexcel_s_worksheet_head_foot
        !ep_even_header TYPE zexcel_s_worksheet_head_foot
        !ep_even_footer TYPE zexcel_s_worksheet_head_foot .
*"* protected declarations
*include Lcl_excel_sheet_setup=========co.
  PROTECTED SECTION.

*"* protected components of class LCL_EXCEL_SHEET_SETUP
*"* do not include other source files here!!!
    METHODS process_header_footer
      IMPORTING
        !ip_header                 TYPE zexcel_s_worksheet_head_foot
        !ip_side                   TYPE string
      RETURNING
        VALUE(rv_processed_string) TYPE string .
*"* private declarations
*include Lcl_excel_sheet_setup=========ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_SHEET_SETUP
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_SHEET_SETUP definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE

*"* local type definitions
*include Lcl_excel_style===============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE definition
*"* public declarations
*include Lcl_excel_style===============cu.
CLASS Lcl_excel_style DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_STYLE
*"* do not include other source files here!!!
  PUBLIC SECTION.

    DATA font TYPE REF TO Lcl_excel_style_font .
    DATA fill TYPE REF TO Lcl_excel_style_fill .
    DATA borders TYPE REF TO Lcl_excel_style_borders .
    DATA alignment TYPE REF TO Lcl_excel_style_alignment .
    DATA number_format TYPE REF TO Lcl_excel_style_number_format .
    DATA protection TYPE REF TO Lcl_excel_style_protection .

    METHODS constructor
      IMPORTING
        !ip_guid     TYPE zexcel_cell_style OPTIONAL
        !io_clone_of TYPE REF TO Lcl_excel_style OPTIONAL .
    METHODS get_guid
      RETURNING
        VALUE(ep_guid) TYPE zexcel_cell_style .
*"* protected components of class ZABAP_EXCEL_STYLE
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style===============co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_STYLE
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_style===============ci.
  PRIVATE SECTION.

    DATA guid TYPE zexcel_cell_style .
endclass. "LCL_EXCEL_STYLE definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLES

*"* local type definitions
*include Lcl_excel_styles==============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLES definition
*"* public declarations
*include Lcl_excel_styles==============cu.
CLASS Lcl_excel_styles DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_STYLES
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS add
      IMPORTING
        !ip_style TYPE REF TO Lcl_excel_style .
    METHODS clear .
    METHODS constructor .
    METHODS get
      IMPORTING
        !ip_index       TYPE i
      RETURNING
        VALUE(eo_style) TYPE REF TO Lcl_excel_style .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !ip_style TYPE REF TO Lcl_excel_style .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
    METHODS register_new_style
      IMPORTING
        !io_style            TYPE REF TO Lcl_excel_style
      RETURNING
        VALUE(ep_style_code) TYPE i .
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_styles==============co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_styles==============ci.
  PRIVATE SECTION.

    DATA styles TYPE REF TO Lcl_excel_collection .
endclass. "LCL_EXCEL_STYLES definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLES_COND

*"* local type definitions
*include Lcl_excel_styles_cond=========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLES_COND definition
*"* public declarations
*include Lcl_excel_styles_cond=========cu.
CLASS Lcl_excel_styles_cond DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_STYLES_COND
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS add
      IMPORTING
        !ip_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS clear .
    METHODS constructor .
    METHODS get
      IMPORTING
        !ip_index            TYPE zexcel_active_worksheet
      RETURNING
        VALUE(eo_style_cond) TYPE REF TO Lcl_excel_style_cond .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !ip_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_styles_cond=========co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_STYLES_COND
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_styles_cond=========ci.
  PRIVATE SECTION.

    DATA styles_cond TYPE REF TO Lcl_excel_collection .
endclass. "LCL_EXCEL_STYLES_COND definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_ALIGNMENT

*"* local type definitions
*include Lcl_excel_style_alignment=====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_ALIGNMENT definition
*"* public declarations
*include Lcl_excel_style_alignment=====cu.
CLASS Lcl_excel_style_alignment DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_STYLE_ALIGNMENT
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CONSTANTS c_horizontal_general TYPE zexcel_alignment VALUE 'general'. "#EC NOTEXT
    CONSTANTS c_horizontal_left TYPE zexcel_alignment VALUE 'left'. "#EC NOTEXT
    CONSTANTS c_horizontal_right TYPE zexcel_alignment VALUE 'right'. "#EC NOTEXT
    CONSTANTS c_horizontal_center TYPE zexcel_alignment VALUE 'center'. "#EC NOTEXT
    CONSTANTS c_horizontal_center_continuous TYPE zexcel_alignment VALUE 'centerContinuous'. "#EC NOTEXT
    CONSTANTS c_horizontal_justify TYPE zexcel_alignment VALUE 'justify'. "#EC NOTEXT
    CONSTANTS c_vertical_bottom TYPE zexcel_alignment VALUE 'bottom'. "#EC NOTEXT
    CONSTANTS c_vertical_top TYPE zexcel_alignment VALUE 'top'. "#EC NOTEXT
    CONSTANTS c_vertical_center TYPE zexcel_alignment VALUE 'center'. "#EC NOTEXT
    CONSTANTS c_vertical_justify TYPE zexcel_alignment VALUE 'justify'. "#EC NOTEXT
    DATA horizontal TYPE zexcel_alignment .
    DATA vertical TYPE zexcel_alignment .
    DATA textrotation TYPE zexcel_text_rotation VALUE 0. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA wraptext TYPE flag .
    DATA shrinktofit TYPE flag .
    DATA indent TYPE zexcel_indent VALUE 0. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .

    METHODS constructor .
    METHODS get_structure
      RETURNING
        VALUE(es_alignment) TYPE zexcel_s_style_alignment .
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_alignment=====co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_STYLE_ALIGNMENT
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_style_alignment=====ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_STYLE_ALIGNMENT definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_BORDER

*"* local type definitions
*include Lcl_excel_style_border========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_BORDER definition
*"* public declarations
*include Lcl_excel_style_border========cu.
CLASS Lcl_excel_style_border DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

*"* public components of class LCL_EXCEL_STYLE_BORDER
*"* do not include other source files here!!!
    DATA border_style TYPE zexcel_border .
    DATA border_color TYPE zexcel_s_style_color .
    CONSTANTS c_border_none TYPE zexcel_border VALUE 'none'. "#EC NOTEXT
    CONSTANTS c_border_dashdot TYPE zexcel_border VALUE 'dashDot'. "#EC NOTEXT
    CONSTANTS c_border_dashdotdot TYPE zexcel_border VALUE 'dashDotDot'. "#EC NOTEXT
    CONSTANTS c_border_dashed TYPE zexcel_border VALUE 'dashed'. "#EC NOTEXT
    CONSTANTS c_border_dotted TYPE zexcel_border VALUE 'dotted'. "#EC NOTEXT
    CONSTANTS c_border_double TYPE zexcel_border VALUE 'double'. "#EC NOTEXT
    CONSTANTS c_border_hair TYPE zexcel_border VALUE 'hair'. "#EC NOTEXT
    CONSTANTS c_border_medium TYPE zexcel_border VALUE 'medium'. "#EC NOTEXT
    CONSTANTS c_border_mediumdashdot TYPE zexcel_border VALUE 'mediumDashDot'. "#EC NOTEXT
    CONSTANTS c_border_mediumdashdotdot TYPE zexcel_border VALUE 'mediumDashDotDot'. "#EC NOTEXT
    CONSTANTS c_border_mediumdashed TYPE zexcel_border VALUE 'mediumDashed'. "#EC NOTEXT
    CONSTANTS c_border_slantdashdot TYPE zexcel_border VALUE 'slantDashDot'. "#EC NOTEXT
    CONSTANTS c_border_thick TYPE zexcel_border VALUE 'thick'. "#EC NOTEXT
    CONSTANTS c_border_thin TYPE zexcel_border VALUE 'thin'. "#EC NOTEXT

    METHODS constructor .
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_border========co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_STYLE_BORDER
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_style_border========ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_STYLE_BORDER definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_BORDERS

*"* local type definitions
*include Lcl_excel_style_borders=======ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_BORDERS definition
*"* public declarations
*include Lcl_excel_style_borders=======cu.
CLASS Lcl_excel_style_borders DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_STYLE_BORDERS
*"* do not include other source files here!!!
  PUBLIC SECTION.

    DATA allborders TYPE REF TO Lcl_excel_style_border .
    CONSTANTS c_diagonal_both TYPE zexcel_diagonal VALUE 3. "#EC NOTEXT
    CONSTANTS c_diagonal_down TYPE zexcel_diagonal VALUE 2. "#EC NOTEXT
    CONSTANTS c_diagonal_none TYPE zexcel_diagonal VALUE 0. "#EC NOTEXT
    CONSTANTS c_diagonal_up TYPE zexcel_diagonal VALUE 1.   "#EC NOTEXT
    DATA diagonal TYPE REF TO Lcl_excel_style_border .
    DATA diagonal_mode TYPE zexcel_diagonal .
    DATA down TYPE REF TO Lcl_excel_style_border .
    DATA left TYPE REF TO Lcl_excel_style_border .
    DATA right TYPE REF TO Lcl_excel_style_border .
    DATA top TYPE REF TO Lcl_excel_style_border .

    METHODS get_structure
      RETURNING
        VALUE(es_fill) TYPE zexcel_s_style_border .
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_borders=======co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_STYLE_BORDERS
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_style_borders=======ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_STYLE_BORDERS definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_COLOR

*"* local type definitions
*include Lcl_excel_style_color=========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_COLOR definition
*"* public declarations
*include Lcl_excel_style_color=========cu.
CLASS Lcl_excel_style_color DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

*"* public components of class LCL_EXCEL_STYLE_COLOR
*"* do not include other source files here!!!
    CONSTANTS c_black TYPE zexcel_style_color_argb VALUE 'FF000000'. "#EC NOTEXT
    CONSTANTS c_blue TYPE zexcel_style_color_argb VALUE 'FF0000FF'. "#EC NOTEXT
    CONSTANTS c_darkblue TYPE zexcel_style_color_argb VALUE 'FF000080'. "#EC NOTEXT
    CONSTANTS c_darkgreen TYPE zexcel_style_color_argb VALUE 'FF008000'. "#EC NOTEXT
    CONSTANTS c_darkred TYPE zexcel_style_color_argb VALUE 'FF800000'. "#EC NOTEXT
    CONSTANTS c_darkyellow TYPE zexcel_style_color_argb VALUE 'FF808000'. "#EC NOTEXT
    CONSTANTS c_gray TYPE zexcel_style_color_argb VALUE 'FFCCCCCC'. "#EC NOTEXT
    CONSTANTS c_green TYPE zexcel_style_color_argb VALUE 'FF00FF00'. "#EC NOTEXT
    CONSTANTS c_red TYPE zexcel_style_color_argb VALUE 'FFFF0000'. "#EC NOTEXT
    CONSTANTS c_white TYPE zexcel_style_color_argb VALUE 'FFFFFFFF'. "#EC NOTEXT
    CONSTANTS c_yellow TYPE zexcel_style_color_argb VALUE 'FFFFFF00'. "#EC NOTEXT
    CONSTANTS c_theme_dark1 TYPE zexcel_style_color_theme VALUE 0. "#EC NOTEXT
    CONSTANTS c_theme_light1 TYPE zexcel_style_color_theme VALUE 1. "#EC NOTEXT
    CONSTANTS c_theme_dark2 TYPE zexcel_style_color_theme VALUE 2. "#EC NOTEXT
    CONSTANTS c_theme_light2 TYPE zexcel_style_color_theme VALUE 3. "#EC NOTEXT
    CONSTANTS c_theme_accent1 TYPE zexcel_style_color_theme VALUE 4. "#EC NOTEXT
    CONSTANTS c_theme_accent2 TYPE zexcel_style_color_theme VALUE 5. "#EC NOTEXT
    CONSTANTS c_theme_accent3 TYPE zexcel_style_color_theme VALUE 6. "#EC NOTEXT
    CONSTANTS c_theme_accent4 TYPE zexcel_style_color_theme VALUE 7. "#EC NOTEXT
    CONSTANTS c_theme_accent5 TYPE zexcel_style_color_theme VALUE 8. "#EC NOTEXT
    CONSTANTS c_theme_accent6 TYPE zexcel_style_color_theme VALUE 9. "#EC NOTEXT
    CONSTANTS c_theme_hyperlink TYPE zexcel_style_color_theme VALUE 10. "#EC NOTEXT
    CONSTANTS c_theme_hyperlink_followed TYPE zexcel_style_color_theme VALUE 11. "#EC NOTEXT
    CONSTANTS c_theme_not_set TYPE zexcel_style_color_theme VALUE -1. "#EC NOTEXT
    CONSTANTS c_indexed_not_set TYPE zexcel_style_color_indexed VALUE -1. "#EC NOTEXT
    CONSTANTS c_indexed_sys_foreground TYPE zexcel_style_color_indexed VALUE 64. "#EC NOTEXT

    CLASS-METHODS create_new_argb
      IMPORTING
        !ip_red              TYPE zexcel_style_color_component
        !ip_green            TYPE zexcel_style_color_component
        !ip_blu              TYPE zexcel_style_color_component
      RETURNING
        VALUE(ep_color_argb) TYPE zexcel_style_color_argb .
    CLASS-METHODS create_new_arbg_int
      IMPORTING
        !iv_red              TYPE numeric
        !iv_green            TYPE numeric
        !iv_blue             TYPE numeric
      RETURNING
        VALUE(rv_color_argb) TYPE zexcel_style_color_argb .
*"* protected components of class LCL_EXCEL_STYLE_COLOR
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_STYLE_COLOR
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_color=========co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_style_color=========ci.
  PRIVATE SECTION.

*"* private components of class LCL_EXCEL_STYLE_COLOR
*"* do not include other source files here!!!
    CONSTANTS c_alpha TYPE c LENGTH 2 VALUE 'FF'.           "#EC NOTEXT
endclass. "LCL_EXCEL_STYLE_COLOR definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_FILL

*"* local type definitions
*include Lcl_excel_style_fill==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_FILL definition
*"* public declarations
*include Lcl_excel_style_fill==========cu.
CLASS Lcl_excel_style_fill DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

*"* public components of class LCL_EXCEL_STYLE_FILL
*"* do not include other source files here!!!
    CONSTANTS c_fill_none TYPE zexcel_fill_type VALUE 'none'. "#EC NOTEXT
    CONSTANTS c_fill_solid TYPE zexcel_fill_type VALUE 'solid'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_linear TYPE zexcel_fill_type VALUE 'linear'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_path TYPE zexcel_fill_type VALUE 'path'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_darkdown TYPE zexcel_fill_type VALUE 'darkDown'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_darkgray TYPE zexcel_fill_type VALUE 'darkGray'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_darkgrid TYPE zexcel_fill_type VALUE 'darkGrid'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_darkhorizontal TYPE zexcel_fill_type VALUE 'darkHorizontal'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_darktrellis TYPE zexcel_fill_type VALUE 'darkTrellis'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_darkup TYPE zexcel_fill_type VALUE 'darkUp'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_darkvertical TYPE zexcel_fill_type VALUE 'darkVertical'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_gray0625 TYPE zexcel_fill_type VALUE 'gray0625'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_gray125 TYPE zexcel_fill_type VALUE 'gray125'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_lightdown TYPE zexcel_fill_type VALUE 'lightDown'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_lightgray TYPE zexcel_fill_type VALUE 'lightGray'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_lightgrid TYPE zexcel_fill_type VALUE 'lightGrid'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_lighthorizontal TYPE zexcel_fill_type VALUE 'lightHorizontal'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_lighttrellis TYPE zexcel_fill_type VALUE 'lightTrellis'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_lightup TYPE zexcel_fill_type VALUE 'lightUp'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_lightvertical TYPE zexcel_fill_type VALUE 'lightVertical'. "#EC NOTEXT
    CONSTANTS c_fill_pattern_mediumgray TYPE zexcel_fill_type VALUE 'mediumGray'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_horizontal90 TYPE zexcel_fill_type VALUE 'horizontal90'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_horizontal270 TYPE zexcel_fill_type VALUE 'horizontal270'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_horizontalb TYPE zexcel_fill_type VALUE 'horizontalb'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_vertical TYPE zexcel_fill_type VALUE 'vertical'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_fromcenter TYPE zexcel_fill_type VALUE 'fromCenter'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_diagonal45 TYPE zexcel_fill_type VALUE 'diagonal45'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_diagonal45b TYPE zexcel_fill_type VALUE 'diagonal45b'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_diagonal135 TYPE zexcel_fill_type VALUE 'diagonal135'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_diagonal135b TYPE zexcel_fill_type VALUE 'diagonal135b'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_cornerlt TYPE zexcel_fill_type VALUE 'cornerLT'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_cornerlb TYPE zexcel_fill_type VALUE 'cornerLB'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_cornerrt TYPE zexcel_fill_type VALUE 'cornerRT'. "#EC NOTEXT
    CONSTANTS c_fill_gradient_cornerrb TYPE zexcel_fill_type VALUE 'cornerRB'. "#EC NOTEXT
    DATA gradtype TYPE zexcel_s_gradient_type .
    DATA filltype TYPE zexcel_fill_type .
    DATA rotation TYPE zexcel_rotation .
    DATA fgcolor TYPE zexcel_s_style_color .
    DATA bgcolor TYPE zexcel_s_style_color .

    METHODS constructor .
    METHODS get_structure
      RETURNING
        VALUE(es_fill) TYPE zexcel_s_style_fill .
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_fill==========co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_STYLE_FILL
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_style_fill==========ci.
  PRIVATE SECTION.

    METHODS build_gradient .
    METHODS check_filltype_is_gradient
      RETURNING
        VALUE(rv_is_gradient) TYPE abap_bool .
endclass. "LCL_EXCEL_STYLE_FILL definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_FONT

*"* local type definitions
*include Lcl_excel_style_font==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_FONT definition
*"* public declarations
*include Lcl_excel_style_font==========cu.
CLASS Lcl_excel_style_font DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_STYLE_FONT
*"* do not include other source files here!!!

    DATA bold TYPE flag .
    DATA color TYPE zexcel_s_style_color .
    CONSTANTS c_family_decorative TYPE zexcel_style_font_family VALUE 5. "#EC NOTEXT
    CONSTANTS c_family_modern TYPE zexcel_style_font_family VALUE 3. "#EC NOTEXT
    CONSTANTS c_family_none TYPE zexcel_style_font_family VALUE 0. "#EC NOTEXT
    CONSTANTS c_family_roman TYPE zexcel_style_font_family VALUE 1. "#EC NOTEXT
    CONSTANTS c_family_script TYPE zexcel_style_font_family VALUE 4. "#EC NOTEXT
    CONSTANTS c_family_swiss TYPE zexcel_style_font_family VALUE 2. "#EC NOTEXT
    CONSTANTS c_name_arial TYPE zexcel_style_font_name VALUE 'Arial'. "#EC NOTEXT
    CONSTANTS c_name_calibri TYPE zexcel_style_font_name VALUE 'Calibri'. "#EC NOTEXT
    CONSTANTS c_name_cambria TYPE zexcel_style_font_name VALUE 'Cambria'. "#EC NOTEXT
    CONSTANTS c_name_roman TYPE zexcel_style_font_name VALUE 'Times New Roman'. "#EC NOTEXT
    CONSTANTS c_scheme_major TYPE zexcel_style_font_scheme VALUE 'major'. "#EC NOTEXT
    CONSTANTS c_scheme_none TYPE zexcel_style_font_scheme VALUE ''. "#EC NOTEXT
    CONSTANTS c_scheme_minor TYPE zexcel_style_font_scheme VALUE 'minor'. "#EC NOTEXT
    CONSTANTS c_underline_double TYPE zexcel_style_font_underline VALUE 'double'. "#EC NOTEXT
    CONSTANTS c_underline_doubleaccounting TYPE zexcel_style_font_underline VALUE 'doubleAccounting'. "#EC NOTEXT
    CONSTANTS c_underline_none TYPE zexcel_style_font_underline VALUE 'none'. "#EC NOTEXT
    CONSTANTS c_underline_single TYPE zexcel_style_font_underline VALUE 'single'. "#EC NOTEXT
    CONSTANTS c_underline_singleaccounting TYPE zexcel_style_font_underline VALUE 'singleAccounting'. "#EC NOTEXT
    DATA family TYPE zexcel_style_font_family VALUE 2. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA italic TYPE flag .
    DATA name TYPE zexcel_style_font_name VALUE 'Calibri'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA scheme TYPE zexcel_style_font_scheme VALUE 'minor'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA size TYPE zexcel_style_font_size VALUE 11. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA strikethrough TYPE flag .
    DATA underline TYPE flag .
    DATA underline_mode TYPE zexcel_style_font_underline .

    METHODS constructor .
    METHODS get_structure
      RETURNING
        VALUE(es_font) TYPE zexcel_s_style_font .
    METHODS calculate_text_width
      IMPORTING
        !i_text        TYPE zexcel_cell_value
      RETURNING
        VALUE(r_width) TYPE i .
*"* protected components of class LCL_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_font==========co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_style_font==========ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_STYLE_FONT definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_NUMBER_FORMAT

*"* local type definitions
*include Lcl_excel_style_number_format=ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_NUMBER_FORMAT definition
*"* public declarations
*include Lcl_excel_style_number_format=cu.
CLASS Lcl_excel_style_number_format DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
      BEGIN OF t_num_format,
        id     TYPE string,
        format TYPE REF TO Lcl_excel_style_number_format,
      END OF t_num_format .
    TYPES:
      t_num_formats TYPE HASHED TABLE OF t_num_format WITH UNIQUE KEY id .

*"* public components of class LCL_EXCEL_STYLE_NUMBER_FORMAT
*"* do not include other source files here!!!
    CONSTANTS c_format_numc_std TYPE zexcel_number_format VALUE 'STD_NDEC'. "#EC NOTEXT
    CONSTANTS c_format_date_std TYPE zexcel_number_format VALUE 'STD_DATE'. "#EC NOTEXT
    CONSTANTS c_format_currency_eur_simple TYPE zexcel_number_format VALUE '[$EUR ]#,##0.00_-'. "#EC NOTEXT
    CONSTANTS c_format_currency_usd TYPE zexcel_number_format VALUE '$#,##0_-'. "#EC NOTEXT
    CONSTANTS c_format_currency_usd_simple TYPE zexcel_number_format VALUE '"$"#,##0.00_-'. "#EC NOTEXT
    CONSTANTS c_format_currency_simple TYPE zexcel_number_format VALUE '$#,##0_);($#,##0)'. "#EC NOTEXT
    CONSTANTS c_format_currency_simple_red TYPE zexcel_number_format VALUE '$#,##0_);[Red]($#,##0)'. "#EC NOTEXT
    CONSTANTS c_format_currency_simple2 TYPE zexcel_number_format VALUE '$#,##0.00_);($#,##0.00)'. "#EC NOTEXT
    CONSTANTS c_format_currency_simple_red2 TYPE zexcel_number_format VALUE '$#,##0.00_);[Red]($#,##0.00)'. "#EC NOTEXT
    CONSTANTS c_format_date_datetime TYPE zexcel_number_format VALUE 'd/m/y h:mm'. "#EC NOTEXT
    CONSTANTS c_format_date_ddmmyyyy TYPE zexcel_number_format VALUE 'dd/mm/yy'. "#EC NOTEXT
    CONSTANTS c_format_date_ddmmyyyydot TYPE zexcel_number_format VALUE 'dd\.mm\.yyyy'. "#EC NOTEXT
    CONSTANTS c_format_date_dmminus TYPE zexcel_number_format VALUE 'd-m'. "#EC NOTEXT
    CONSTANTS c_format_date_dmyminus TYPE zexcel_number_format VALUE 'd-m-y'. "#EC NOTEXT
    CONSTANTS c_format_date_dmyslash TYPE zexcel_number_format VALUE 'd/m/y'. "#EC NOTEXT
    CONSTANTS c_format_date_myminus TYPE zexcel_number_format VALUE 'm-y'. "#EC NOTEXT
    CONSTANTS c_format_date_time1 TYPE zexcel_number_format VALUE 'h:mm AM/PM'. "#EC NOTEXT
    CONSTANTS c_format_date_time2 TYPE zexcel_number_format VALUE 'h:mm:ss AM/PM'. "#EC NOTEXT
    CONSTANTS c_format_date_time3 TYPE zexcel_number_format VALUE 'h:mm'. "#EC NOTEXT
    CONSTANTS c_format_date_time4 TYPE zexcel_number_format VALUE 'h:mm:ss'. "#EC NOTEXT
    CONSTANTS c_format_date_time5 TYPE zexcel_number_format VALUE 'mm:ss'. "#EC NOTEXT
    CONSTANTS c_format_date_time6 TYPE zexcel_number_format VALUE 'h:mm:ss'. "#EC NOTEXT
    CONSTANTS c_format_date_time7 TYPE zexcel_number_format VALUE 'i:s.S'. "#EC NOTEXT
    CONSTANTS c_format_date_time8 TYPE zexcel_number_format VALUE 'h:mm:ss@'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx14 TYPE zexcel_number_format VALUE 'mm-dd-yy'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx15 TYPE zexcel_number_format VALUE 'd-mmm-yy'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx16 TYPE zexcel_number_format VALUE 'd-mmm'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx17 TYPE zexcel_number_format VALUE 'mmm-yy'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx22 TYPE zexcel_number_format VALUE 'm/d/yy h:mm'. "#EC NOTEXT
    CONSTANTS c_format_date_yymmdd TYPE zexcel_number_format VALUE 'yymmdd'. "#EC NOTEXT
    CONSTANTS c_format_date_yymmddminus TYPE zexcel_number_format VALUE 'yy-mm-dd'. "#EC NOTEXT
    CONSTANTS c_format_date_yymmddslash TYPE zexcel_number_format VALUE 'yy/mm/dd'. "#EC NOTEXT
    CONSTANTS c_format_date_yyyymmdd TYPE zexcel_number_format VALUE 'yyyymmdd'. "#EC NOTEXT
    CONSTANTS c_format_date_yyyymmddminus TYPE zexcel_number_format VALUE 'yyyy-mm-dd'. "#EC NOTEXT
    CONSTANTS c_format_date_yyyymmddslash TYPE zexcel_number_format VALUE 'yyyy/mm/dd'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx45 TYPE zexcel_number_format VALUE 'mm:ss'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx46 TYPE zexcel_number_format VALUE '[h]:mm:ss'. "#EC NOTEXT
    CONSTANTS c_format_date_xlsx47 TYPE zexcel_number_format VALUE 'mm:ss.0'. "#EC NOTEXT
    CONSTANTS c_format_general TYPE zexcel_number_format VALUE ''. "#EC NOTEXT
    CONSTANTS c_format_number TYPE zexcel_number_format VALUE '0'. "#EC NOTEXT
    CONSTANTS c_format_number_00 TYPE zexcel_number_format VALUE '0.00'. "#EC NOTEXT
    CONSTANTS c_format_number_comma_sep0 TYPE zexcel_number_format VALUE '#,##0'. "#EC NOTEXT
    CONSTANTS c_format_number_comma_sep1 TYPE zexcel_number_format VALUE '#,##0.00'. "#EC NOTEXT
    CONSTANTS c_format_number_comma_sep2 TYPE zexcel_number_format VALUE '#,##0.00_-'. "#EC NOTEXT
    CONSTANTS c_format_percentage TYPE zexcel_number_format VALUE '0%'. "#EC NOTEXT
    CONSTANTS c_format_percentage_00 TYPE zexcel_number_format VALUE '0.00%'. "#EC NOTEXT
    CONSTANTS c_format_text TYPE zexcel_number_format VALUE '@'. "#EC NOTEXT
    CONSTANTS c_format_fraction_1 TYPE zexcel_number_format VALUE '# ?/?'. "#EC NOTEXT
    CONSTANTS c_format_fraction_2 TYPE zexcel_number_format VALUE '# ??/??'. "#EC NOTEXT
    CONSTANTS c_format_scientific TYPE zexcel_number_format VALUE '0.00E+00'. "#EC NOTEXT
    CONSTANTS c_format_special_01 TYPE zexcel_number_format VALUE '##0.0E+0'. "#EC NOTEXT
    DATA format_code TYPE zexcel_number_format .
    CLASS-DATA mt_built_in_num_formats TYPE t_num_formats READ-ONLY .
    CONSTANTS c_format_xlsx37 TYPE zexcel_number_format VALUE '#,##0_);(#,##0)'. "#EC NOTEXT
    CONSTANTS c_format_xlsx38 TYPE zexcel_number_format VALUE '#,##0_);[Red](#,##0)'. "#EC NOTEXT
    CONSTANTS c_format_xlsx39 TYPE zexcel_number_format VALUE '#,##0.00_);(#,##0.00)'. "#EC NOTEXT
    CONSTANTS c_format_xlsx40 TYPE zexcel_number_format VALUE '#,##0.00_);[Red](#,##0.00)'. "#EC NOTEXT
    CONSTANTS c_format_xlsx41 TYPE zexcel_number_format VALUE '_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'. "#EC NOTEXT
    CONSTANTS c_format_xlsx42 TYPE zexcel_number_format VALUE '_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'. "#EC NOTEXT
    CONSTANTS c_format_xlsx43 TYPE zexcel_number_format VALUE '_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'. "#EC NOTEXT
    CONSTANTS c_format_xlsx44 TYPE zexcel_number_format VALUE '_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'. "#EC NOTEXT
    CONSTANTS c_format_currency_gbp_simple TYPE zexcel_number_format VALUE '[$-809]#,##0.00'. "#EC NOTEXT
    CONSTANTS c_format_currency_pln_simple TYPE zexcel_number_format VALUE '#,##0.00\ "z"'. "#EC NOTEXT

    CLASS-METHODS class_constructor .
    METHODS constructor .
    METHODS get_structure
      RETURNING
        VALUE(ep_number_format) TYPE zexcel_s_style_numfmt .
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_number_format=co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_style_number_format=ci.
  PRIVATE SECTION.
    CLASS-METHODS add_format
      IMPORTING
        id   TYPE string
        code TYPE zexcel_number_format.
*"* private components of class LCL_EXCEL_STYLE_NUMBER_FORMAT
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_STYLE_NUMBER_FORMAT definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_PROTECTION

*"* local type definitions
*include Lcl_excel_style_protection====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_PROTECTION definition
*"* public declarations
*include Lcl_excel_style_protection====cu.
CLASS Lcl_excel_style_protection DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_STYLE_PROTECTION
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CONSTANTS c_protection_hidden TYPE zexcel_cell_protection VALUE '1'. "#EC NOTEXT
    CONSTANTS c_protection_locked TYPE zexcel_cell_protection VALUE '1'. "#EC NOTEXT
    CONSTANTS c_protection_unhidden TYPE zexcel_cell_protection VALUE '0'. "#EC NOTEXT
    CONSTANTS c_protection_unlocked TYPE zexcel_cell_protection VALUE '0'. "#EC NOTEXT
    DATA hidden TYPE zexcel_cell_protection .
    DATA locked TYPE zexcel_cell_protection .

    METHODS constructor .
    METHODS get_structure
      RETURNING
        VALUE(ep_protection) TYPE zexcel_s_style_protection .
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_protection====co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_STYLE_PROTECTION
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_style_protection====ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_STYLE_PROTECTION definition
*class-pool .
*"* class pool for class LCL_EXCEL_TEMPLATE_DATA

*"* local type definitions
*include Lcl_excel_template_data=======ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_TEMPLATE_DATA definition
*"* public declarations
*include Lcl_excel_template_data=======cu.
CLASS Lcl_excel_template_data DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES: tt_sheet_titles TYPE STANDARD TABLE OF zexcel_sheet_title WITH DEFAULT KEY,
           BEGIN OF ts_template_data_sheet,
             sheet TYPE zexcel_sheet_title,
             data  TYPE REF TO data,
           END OF ts_template_data_sheet,
           tt_template_data_sheets TYPE STANDARD TABLE OF ts_template_data_sheet WITH DEFAULT KEY.

    DATA mt_data TYPE tt_template_data_sheets READ-ONLY.

    METHODS add
      IMPORTING
        iv_sheet TYPE zexcel_sheet_title
        iv_data  TYPE data .
*"* protected declarations
*include Lcl_excel_template_data=======co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_template_data=======ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_TEMPLATE_DATA definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME_COLOR_SCHEME

*"* local type definitions
*include Lcl_excel_theme_color_scheme==ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME_COLOR_SCHEME definition
*"* public declarations
*include Lcl_excel_theme_color_scheme==cu.
CLASS Lcl_excel_theme_color_scheme DEFINITION
*public
  FINAL
  CREATE PUBLIC

  friends Lcl_excel_theme
                 Lcl_excel_theme_elements .

  PUBLIC SECTION.

    TYPES t_srgb TYPE string .
    TYPES:
      BEGIN OF t_syscolor,
        val     TYPE string,
        lastclr TYPE t_srgb,
      END OF t_syscolor .
    TYPES:
      BEGIN OF t_color,
        srgb     TYPE t_srgb,
        syscolor TYPE t_syscolor,
      END OF t_color .

    CONSTANTS c_dark1 TYPE string VALUE 'dk1'.              "#EC NOTEXT
    CONSTANTS c_dark2 TYPE string VALUE 'dk2'.              "#EC NOTEXT
    CONSTANTS c_light1 TYPE string VALUE 'lt1'.             "#EC NOTEXT
    CONSTANTS c_light2 TYPE string VALUE 'lt2'.             "#EC NOTEXT
    CONSTANTS c_accent1 TYPE string VALUE 'accent1'.        "#EC NOTEXT
    CONSTANTS c_accent2 TYPE string VALUE 'accent2'.        "#EC NOTEXT
    CONSTANTS c_accent3 TYPE string VALUE 'accent3'.        "#EC NOTEXT
    CONSTANTS c_accent4 TYPE string VALUE 'accent4'.        "#EC NOTEXT
    CONSTANTS c_accent5 TYPE string VALUE 'accent5'.        "#EC NOTEXT
    CONSTANTS c_accent6 TYPE string VALUE 'accent6'.        "#EC NOTEXT
    CONSTANTS c_hlink TYPE string VALUE 'hlink'.            "#EC NOTEXT
    CONSTANTS c_folhlink TYPE string VALUE 'folHlink'.      "#EC NOTEXT
    CONSTANTS c_syscolor TYPE string VALUE 'sysClr'.        "#EC NOTEXT
    CONSTANTS c_srgbcolor TYPE string VALUE 'srgbClr'.      "#EC NOTEXT
    CONSTANTS c_val TYPE string VALUE 'val'.                "#EC NOTEXT
    CONSTANTS c_lastclr TYPE string VALUE 'lastClr'.        "#EC NOTEXT
    CONSTANTS c_name TYPE string VALUE 'name'.              "#EC NOTEXT
    CONSTANTS c_scheme TYPE string VALUE 'clrScheme'.       "#EC NOTEXT

    METHODS load
      IMPORTING
        !io_color_scheme TYPE REF TO if_ixml_element .
    METHODS set_color
      IMPORTING
        iv_type         TYPE string
        iv_srgb         TYPE t_srgb OPTIONAL
        iv_syscolorname TYPE string OPTIONAL
        iv_syscolorlast TYPE t_srgb .
    METHODS build_xml
      IMPORTING
        !io_document TYPE REF TO if_ixml_document .
    METHODS constructor .
    METHODS set_name
      IMPORTING
        VALUE(iv_name) TYPE string .
*"* protected declarations
*include Lcl_excel_theme_color_scheme==co.
  PROTECTED SECTION.

    DATA name TYPE string .
    DATA dark1 TYPE t_color .
    DATA dark2 TYPE t_color .
    DATA light1 TYPE t_color .
    DATA light2 TYPE t_color .
    DATA accent1 TYPE t_color .
    DATA accent2 TYPE t_color .
    DATA accent3 TYPE t_color .
    DATA accent4 TYPE t_color .
    DATA accent5 TYPE t_color .
    DATA accent6 TYPE t_color .
    DATA hlink TYPE t_color .
    DATA folhlink TYPE t_color .
*"* private declarations
*include Lcl_excel_theme_color_scheme==ci.
  PRIVATE SECTION.

    METHODS get_color
      IMPORTING
        !io_object      TYPE REF TO if_ixml_element
      RETURNING
        VALUE(rv_color) TYPE t_color .
    METHODS set_defaults .
endclass. "LCL_EXCEL_THEME_COLOR_SCHEME definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME_ELEMENTS

*"* local type definitions
*include Lcl_excel_theme_elements======ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME_ELEMENTS definition
*"* public declarations
*include Lcl_excel_theme_elements======cu.
CLASS Lcl_excel_theme_elements DEFINITION
*public
  FINAL
  CREATE PUBLIC

  friends Lcl_excel_theme .

  PUBLIC SECTION.

    CONSTANTS c_color_scheme TYPE string VALUE 'clrScheme'. "#EC NOTEXT
    CONSTANTS c_font_scheme TYPE string VALUE 'fontScheme'. "#EC NOTEXT
    CONSTANTS c_fmt_scheme TYPE string VALUE 'fmtScheme'.   "#EC NOTEXT
    CONSTANTS c_theme_elements TYPE string VALUE 'themeElements'. "#EC NOTEXT

    METHODS constructor .
    METHODS load
      IMPORTING
        !io_elements TYPE REF TO if_ixml_element .
    METHODS build_xml
      IMPORTING
        !io_document TYPE REF TO if_ixml_document .
*"* protected declarations
*include Lcl_excel_theme_elements======co.
  PROTECTED SECTION.

    DATA color_scheme TYPE REF TO Lcl_excel_theme_color_scheme .
    DATA font_scheme TYPE REF TO Lcl_excel_theme_font_scheme .
    DATA fmt_scheme TYPE REF TO Lcl_excel_theme_fmt_scheme .
*"* private declarations
*include Lcl_excel_theme_elements======ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_THEME_ELEMENTS definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME_FONT_SCHEME

*"* local type definitions
*include Lcl_excel_theme_font_scheme===ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME_FONT_SCHEME definition
*"* public declarations
*include Lcl_excel_theme_font_scheme===cu.
CLASS Lcl_excel_theme_font_scheme DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
      BEGIN OF t_font,
        script   TYPE string,
        typeface TYPE string,
      END OF t_font .
    TYPES:
      tt_font TYPE SORTED TABLE OF t_font WITH UNIQUE KEY script .
    TYPES:
      BEGIN OF t_fonttype,
        typeface    TYPE string,
        panose      TYPE string,
        pitchfamily TYPE string,
        charset     TYPE string,
      END OF t_fonttype .
    TYPES:
      BEGIN OF t_fonts,
        latin TYPE t_fonttype,
        ea    TYPE t_fonttype,
        cs    TYPE t_fonttype,
        fonts TYPE tt_font,
      END OF t_fonts .
    TYPES:
      BEGIN OF t_scheme,
        name  TYPE string,
        major TYPE t_fonts,
        minor TYPE t_fonts,
      END OF t_scheme .

    CONSTANTS c_name TYPE string VALUE 'name'.              "#EC NOTEXT
    CONSTANTS c_scheme TYPE string VALUE 'fontScheme'.      "#EC NOTEXT
    CONSTANTS c_major TYPE string VALUE 'majorFont'.        "#EC NOTEXT
    CONSTANTS c_minor TYPE string VALUE 'minorFont'.        "#EC NOTEXT
    CONSTANTS c_font TYPE string VALUE 'font'.              "#EC NOTEXT
    CONSTANTS c_latin TYPE string VALUE 'latin'.            "#EC NOTEXT
    CONSTANTS c_ea TYPE string VALUE 'ea'.                  "#EC NOTEXT
    CONSTANTS c_cs TYPE string VALUE 'cs'.                  "#EC NOTEXT
    CONSTANTS c_typeface TYPE string VALUE 'typeface'.      "#EC NOTEXT
    CONSTANTS c_panose TYPE string VALUE 'panose'.          "#EC NOTEXT
    CONSTANTS c_pitchfamily TYPE string VALUE 'pitchFamily'. "#EC NOTEXT
    CONSTANTS c_charset TYPE string VALUE 'charset'.        "#EC NOTEXT
    CONSTANTS c_script TYPE string VALUE 'script'.          "#EC NOTEXT

    METHODS load
      IMPORTING
        !io_font_scheme TYPE REF TO if_ixml_element .
    METHODS set_name
      IMPORTING
        iv_name TYPE string .
    METHODS build_xml
      IMPORTING
        !io_document TYPE REF TO if_ixml_document .
    METHODS modify_font
      IMPORTING
        VALUE(iv_type)     TYPE string
        VALUE(iv_script)   TYPE string
        VALUE(iv_typeface) TYPE string .
    METHODS modify_latin_font
      IMPORTING
        VALUE(iv_type)        TYPE string
        VALUE(iv_typeface)    TYPE string
        VALUE(iv_panose)      TYPE string OPTIONAL
        VALUE(iv_pitchfamily) TYPE string OPTIONAL
        VALUE(iv_charset)     TYPE string OPTIONAL .
    METHODS modify_ea_font
      IMPORTING
        VALUE(iv_type)        TYPE string
        VALUE(iv_typeface)    TYPE string
        VALUE(iv_panose)      TYPE string OPTIONAL
        VALUE(iv_pitchfamily) TYPE string OPTIONAL
        VALUE(iv_charset)     TYPE string OPTIONAL .
    METHODS modify_cs_font
      IMPORTING
        VALUE(iv_type)        TYPE string
        VALUE(iv_typeface)    TYPE string
        VALUE(iv_panose)      TYPE string OPTIONAL
        VALUE(iv_pitchfamily) TYPE string OPTIONAL
        VALUE(iv_charset)     TYPE string OPTIONAL .
    METHODS constructor .
*"* protected declarations
*include Lcl_excel_theme_font_scheme===co.
  PROTECTED SECTION.

    METHODS modify_lec_fonts
      IMPORTING
        VALUE(iv_type)        TYPE string
        VALUE(iv_font_type)   TYPE string
        VALUE(iv_typeface)    TYPE string
        VALUE(iv_panose)      TYPE string OPTIONAL
        VALUE(iv_pitchfamily) TYPE string OPTIONAL
        VALUE(iv_charset)     TYPE string OPTIONAL .
*"* private declarations
*include Lcl_excel_theme_font_scheme===ci.
  PRIVATE SECTION.

    DATA font_scheme TYPE t_scheme .

    METHODS set_defaults .
endclass. "LCL_EXCEL_THEME_FONT_SCHEME definition
*class-pool .
*"* class pool for class LCL_EXCEL_WORKSHEETS

*"* local type definitions
*include Lcl_excel_worksheets==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_WORKSHEETS definition
*"* public declarations
*include Lcl_excel_worksheets==========cu.
CLASS Lcl_excel_worksheets DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
  PUBLIC SECTION.

    DATA active_worksheet TYPE zexcel_active_worksheet VALUE 1. "#EC NOTEXT .  .  .  .  .  .  .  .  . " .
    DATA name TYPE zexcel_worksheets_name VALUE 'Worksheets'. "#EC NOTEXT .  .  .  .  .  .  .  .  . " .

    METHODS add
      IMPORTING
        !ip_worksheet TYPE REF TO Lcl_excel_worksheet .
    METHODS clear .
    METHODS constructor .
    METHODS get
      IMPORTING
        !ip_index           TYPE zexcel_active_worksheet
      RETURNING
        VALUE(eo_worksheet) TYPE REF TO Lcl_excel_worksheet .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !ip_worksheet TYPE REF TO Lcl_excel_worksheet .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
*"* protected components of class LCL_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_worksheets==========co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_worksheets==========ci.
  PRIVATE SECTION.

    DATA worksheets TYPE REF TO Lcl_excel_collection .
endclass. "LCL_EXCEL_WORKSHEETS definition
*class-pool .
*"* class pool for class LCX_EXCEL

*"* local type definitions
*include Lcx_excel=====================ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCX_EXCEL definition
*"* public declarations
*include Lcx_excel=====================cu.
CLASS Lcx_excel DEFINITION
*public
  INHERITING FROM cx_static_check
  CREATE PUBLIC .

*"* public components of class LCX_EXCEL
*"* do not include other source files here!!!
*"* protected components of class LCX_EXCEL
*"* do not include other source files here!!!
*"* protected components of class LCX_EXCEL
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CONSTANTS Lcx_excel TYPE sotr_conc VALUE '028C0ED2B5601ED78EB6F3368B1E4F9B' ##NO_TEXT.
    DATA error TYPE string .
    DATA syst_at_raise TYPE syst .

    METHODS constructor
      IMPORTING
        !textid        LIKE textid OPTIONAL
        !previous      LIKE previous OPTIONAL
        !error         TYPE string OPTIONAL
        !syst_at_raise TYPE syst OPTIONAL .
    CLASS-METHODS raise_text
      IMPORTING
        !iv_text TYPE clike
      RAISING
        Lcx_excel .
    CLASS-METHODS raise_symsg
      RAISING
        Lcx_excel .

    METHODS if_message~get_longtext
        REDEFINITION .
    METHODS if_message~get_text
        REDEFINITION .
*"* protected declarations
*include Lcx_excel=====================co.
  PROTECTED SECTION.
*"* private components of class LCX_EXCEL
*"* do not include other source files here!!!
*"* private declarations
*include Lcx_excel=====================ci.
  PRIVATE SECTION.
endclass. "LCX_EXCEL definition
*"* class pool for interface LIF_EXCEL_BOOK_PROPERTIES

INTERFACE Lif_excel_book_properties
   .

  TYPES tv_excel_appversion TYPE c LENGTH 7.

  DATA creator TYPE zexcel_creator .
  DATA lastmodifiedby TYPE zexcel_creator .
  DATA created TYPE timestampl .
  DATA modified TYPE timestampl .
  DATA title TYPE zexcel_title .
  DATA subject TYPE zexcel_subject .
  DATA description TYPE zexcel_description .
  DATA keywords TYPE zexcel_keywords .
  DATA category TYPE zexcel_category .
  DATA company TYPE zexcel_company .
  DATA application TYPE zexcel_application .
  DATA docsecurity TYPE zexcel_docsecurity .
  DATA scalecrop TYPE zexcel_scalecrop .
  DATA linksuptodate TYPE flag .
  DATA shareddoc TYPE flag .
  DATA hyperlinkschanged TYPE flag .
  DATA appversion TYPE tv_excel_appversion .

  METHODS initialize .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_BOOK_PROTECTION

INTERFACE Lif_excel_book_protection
   .

  TYPES tv_book_protection TYPE c LENGTH 1.

  CONSTANTS c_locked TYPE tv_book_protection VALUE '1'. "#EC NOTEXT
  CONSTANTS c_protected TYPE tv_book_protection VALUE 'X'.  "#EC NOTEXT
  CONSTANTS c_unlocked TYPE tv_book_protection VALUE '0'. "#EC NOTEXT
  CONSTANTS c_unprotected TYPE tv_book_protection VALUE ''. "#EC NOTEXT
  DATA lockrevision TYPE tv_book_protection .
  DATA lockstructure TYPE tv_book_protection .
  DATA lockwindows TYPE tv_book_protection .
  DATA protected TYPE tv_book_protection .
  DATA revisionspassword TYPE zexcel_aes_password .
  DATA workbookpassword TYPE zexcel_aes_password .

  METHODS initialize .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_BOOK_VBA_PROJECT

INTERFACE Lif_excel_book_vba_project
   .


  DATA vbaproject TYPE xstring READ-ONLY .
  DATA codename TYPE string READ-ONLY .
  DATA codename_pr TYPE string READ-ONLY .

  METHODS set_vbaproject
    IMPORTING
      !ip_vbaproject TYPE xstring .
  METHODS set_codename
    IMPORTING
      !ip_codename TYPE string .
  METHODS set_codename_pr
    IMPORTING
      !ip_codename_pr TYPE string .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_CONVERTER

INTERFACE Lif_excel_converter
   .


  METHODS can_convert_object
    IMPORTING
      !io_object TYPE REF TO object
    RAISING
      Lcx_excel .
  METHODS create_fieldcatalog
    IMPORTING
      !is_option       TYPE zexcel_s_converter_option
      !io_object       TYPE REF TO object
      !it_table        TYPE STANDARD TABLE
    EXPORTING
      !es_layout       TYPE zexcel_s_converter_layo
      !et_fieldcatalog TYPE zexcel_t_converter_fcat
      !eo_table        TYPE REF TO data
      !et_colors       TYPE zexcel_t_converter_col
      !et_filter       TYPE zexcel_t_converter_fil
    RAISING
      Lcx_excel .

   METHODS get_supported_class
     RETURNING VALUE(rv_supported_class) TYPE seoclsname.
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_READER

INTERFACE Lif_excel_reader
   .


  METHODS load_file
    IMPORTING
      !i_filename             TYPE csequence
      !i_use_alternate_zip    TYPE seoclsname DEFAULT space
      !i_from_applserver      TYPE abap_bool DEFAULT sy-batch
      !iv_zcl_excel_classname TYPE clike OPTIONAL
    RETURNING
      VALUE(r_excel)          TYPE REF TO Lcl_excel
    RAISING
      Lcx_excel .
  METHODS load
    IMPORTING
      !i_excel2007            TYPE xstring
      !i_use_alternate_zip    TYPE seoclsname DEFAULT space
      !iv_zcl_excel_classname TYPE clike OPTIONAL
    RETURNING
      VALUE(r_excel)          TYPE REF TO Lcl_excel
    RAISING
      Lcx_excel .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_SHEET_PRINTSETTINGS

INTERFACE Lif_excel_sheet_printsettings
   .


  CONSTANTS gcv_print_title_name TYPE string VALUE '_xlnm.Print_Titles'. "#EC NOTEXT

  METHODS set_print_repeat_columns
    IMPORTING
      !iv_columns_from TYPE zexcel_cell_column_alpha
      !iv_columns_to   TYPE zexcel_cell_column_alpha
    RAISING
      Lcx_excel .
  METHODS set_print_repeat_rows
    IMPORTING
      !iv_rows_from TYPE zexcel_cell_row
      !iv_rows_to   TYPE zexcel_cell_row
    RAISING
      Lcx_excel .
  METHODS get_print_repeat_columns
    EXPORTING
      !ev_columns_from TYPE zexcel_cell_column_alpha
      !ev_columns_to   TYPE zexcel_cell_column_alpha .
  METHODS get_print_repeat_rows
    EXPORTING
      !ev_rows_from TYPE zexcel_cell_row
      !ev_rows_to   TYPE zexcel_cell_row .
  METHODS clear_print_repeat_columns .
  METHODS clear_print_repeat_rows .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_SHEET_PROPERTIES

INTERFACE Lif_excel_sheet_properties
   .


  CONSTANTS c_hidden TYPE zexcel_sheet_hidden VALUE 'X'.    "#EC NOTEXT
  CONSTANTS c_veryhidden TYPE zexcel_sheet_hidden VALUE '2'. "#EC NOTEXT
  CONSTANTS c_hidezero TYPE zexcel_sheet_showzeros VALUE ''. "#EC NOTEXT
  CONSTANTS c_showzero TYPE zexcel_sheet_showzeros VALUE 'X'. "#EC NOTEXT
  CONSTANTS c_visible TYPE zexcel_sheet_hidden VALUE ''.    "#EC NOTEXT
  DATA hidden TYPE zexcel_sheet_hidden .
  DATA show_zeros TYPE zexcel_sheet_showzeros .
  DATA style TYPE zexcel_cell_style .
  DATA zoomscale TYPE zexcel_sheet_zoomscale .
  DATA zoomscale_normal TYPE zexcel_sheet_zoomscale .
  DATA zoomscale_pagelayoutview TYPE zexcel_sheet_zoomscale .
  DATA zoomscale_sheetlayoutview TYPE zexcel_sheet_zoomscale .
  DATA summarybelow TYPE zexcel_sheet_summary .
  CONSTANTS c_below_on TYPE zexcel_sheet_summary VALUE 1.   "#EC NOTEXT
  CONSTANTS c_below_off TYPE zexcel_sheet_summary VALUE 0.  "#EC NOTEXT
  DATA summaryright TYPE zexcel_sheet_summary .
  CONSTANTS c_right_on TYPE zexcel_sheet_summary VALUE 1.   "#EC NOTEXT
  CONSTANTS c_right_off TYPE zexcel_sheet_summary VALUE 0.  "#EC NOTEXT
  DATA selected TYPE zexcel_sheet_selected .
  CONSTANTS c_selected TYPE zexcel_sheet_selected VALUE 'X'. "#EC NOTEXT
  DATA hide_columns_from TYPE zexcel_cell_column_alpha .

  METHODS initialize .
  METHODS get_right_to_left
    RETURNING
      VALUE(result) TYPE abap_bool.
  METHODS get_style
    RETURNING
      VALUE(ep_style) TYPE zexcel_cell_style .
  METHODS set_right_to_left
    IMPORTING
      !right_to_left TYPE abap_bool .
  METHODS set_style
    IMPORTING
      !ip_style TYPE zexcel_cell_style .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_SHEET_PROTECTION

INTERFACE Lif_excel_sheet_protection
   .

  TYPES tv_sheet_protection TYPE c LENGTH 1.
  TYPES tv_sheet_protection_bool TYPE c LENGTH 1.

  DATA auto_filter TYPE tv_sheet_protection_bool .
  CONSTANTS c_active TYPE tv_sheet_protection_bool VALUE '1'. "#EC NOTEXT
  CONSTANTS c_noactive TYPE tv_sheet_protection_bool VALUE '0'. "#EC NOTEXT
  CONSTANTS c_protected TYPE tv_sheet_protection VALUE 'X'. "#EC NOTEXT
  CONSTANTS c_unprotected TYPE tv_sheet_protection VALUE ''. "#EC NOTEXT
  DATA delete_columns TYPE tv_sheet_protection_bool .
  DATA delete_rows TYPE tv_sheet_protection_bool .
  DATA format_cells TYPE tv_sheet_protection_bool .
  DATA format_columns TYPE tv_sheet_protection_bool .
  DATA format_rows TYPE tv_sheet_protection_bool .
  DATA insert_columns TYPE tv_sheet_protection_bool .
  DATA insert_hyperlinks TYPE tv_sheet_protection_bool .
  DATA insert_rows TYPE tv_sheet_protection_bool .
  DATA objects TYPE tv_sheet_protection_bool .
  DATA password TYPE zexcel_aes_password .
  DATA pivot_tables TYPE tv_sheet_protection_bool .
  DATA protected TYPE tv_sheet_protection .
  DATA scenarios TYPE tv_sheet_protection_bool .
  DATA select_locked_cells TYPE tv_sheet_protection_bool .
  DATA select_unlocked_cells TYPE tv_sheet_protection_bool .
  DATA sheet TYPE tv_sheet_protection_bool .
  DATA sort TYPE tv_sheet_protection_bool .

  METHODS initialize .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_SHEET_VBA_PROJECT

INTERFACE Lif_excel_sheet_vba_project
   .


  DATA vbaproject TYPE xstring READ-ONLY .
  DATA codename TYPE string READ-ONLY .
  DATA codename_pr TYPE string READ-ONLY .

  METHODS set_codename
    IMPORTING
      !ip_codename TYPE string .
  METHODS set_codename_pr
    IMPORTING
      !ip_codename_pr TYPE string .
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_STYLE_CHANGER

INTERFACE Lif_excel_style_changer
   .

  METHODS apply
    IMPORTING
      ip_worksheet   TYPE REF TO Lcl_excel_worksheet
      ip_column      TYPE simple
      ip_row         TYPE zexcel_cell_row
    RETURNING
      VALUE(ep_guid) TYPE zexcel_cell_style
    RAISING
      Lcx_excel.
  METHODS get_guid
    RETURNING
      VALUE(result) TYPE zexcel_cell_style.
  METHODS set_complete
    IMPORTING
      ip_complete   TYPE zexcel_s_cstyle_complete
      ip_xcomplete  TYPE zexcel_s_cstylex_complete
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_font
    IMPORTING
      ip_font       TYPE zexcel_s_cstyle_font
      ip_xfont      TYPE zexcel_s_cstylex_font OPTIONAL
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_fill
    IMPORTING
      ip_fill       TYPE zexcel_s_cstyle_fill
      ip_xfill      TYPE zexcel_s_cstylex_fill OPTIONAL
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_borders
    IMPORTING
      ip_borders    TYPE zexcel_s_cstyle_borders
      ip_xborders   TYPE zexcel_s_cstylex_borders OPTIONAL
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_alignment
    IMPORTING
      ip_alignment  TYPE zexcel_s_cstyle_alignment
      ip_xalignment TYPE zexcel_s_cstylex_alignment OPTIONAL
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_protection
    IMPORTING
      ip_protection  TYPE zexcel_s_cstyle_protection
      ip_xprotection TYPE zexcel_s_cstylex_protection OPTIONAL
    RETURNING
      VALUE(result)  TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_borders_all
    IMPORTING
      ip_borders_allborders  TYPE zexcel_s_cstyle_border
      ip_xborders_allborders TYPE zexcel_s_cstylex_border OPTIONAL
    RETURNING
      VALUE(result)          TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_borders_diagonal
    IMPORTING
      ip_borders_diagonal  TYPE zexcel_s_cstyle_border
      ip_xborders_diagonal TYPE zexcel_s_cstylex_border OPTIONAL
    RETURNING
      VALUE(result)        TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_borders_down
    IMPORTING
      ip_borders_down  TYPE zexcel_s_cstyle_border
      ip_xborders_down TYPE zexcel_s_cstylex_border OPTIONAL
    RETURNING
      VALUE(result)    TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_borders_left
    IMPORTING
      ip_borders_left  TYPE zexcel_s_cstyle_border
      ip_xborders_left TYPE zexcel_s_cstylex_border OPTIONAL
    RETURNING
      VALUE(result)    TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_borders_right
    IMPORTING
      ip_borders_right  TYPE zexcel_s_cstyle_border
      ip_xborders_right TYPE zexcel_s_cstylex_border OPTIONAL
    RETURNING
      VALUE(result)     TYPE REF TO Lif_excel_style_changer.
  METHODS set_complete_borders_top
    IMPORTING
      ip_borders_top  TYPE zexcel_s_cstyle_border
      ip_xborders_top TYPE zexcel_s_cstylex_border OPTIONAL
    RETURNING
      VALUE(result)   TYPE REF TO Lif_excel_style_changer.
  METHODS set_number_format
    IMPORTING
      value         TYPE zexcel_number_format
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_bold
    IMPORTING
      value         TYPE flag
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_color
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_color_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_color_indexed
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_color_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_color_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_family
    IMPORTING
      value         TYPE zexcel_style_font_family
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_italic
    IMPORTING
      value         TYPE flag
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_name
    IMPORTING
      value         TYPE zexcel_style_font_name
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_scheme
    IMPORTING
      value         TYPE zexcel_style_font_scheme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_size
    IMPORTING
      value         TYPE numeric
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_strikethrough
    IMPORTING
      value         TYPE flag
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_underline
    IMPORTING
      value         TYPE flag
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_font_underline_mode
    IMPORTING
      value         TYPE zexcel_style_font_underline
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_filltype
    IMPORTING
      value         TYPE zexcel_fill_type
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_rotation
    IMPORTING
      value         TYPE zexcel_rotation
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_fgcolor
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_fgcolor_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_fgcolor_indexed
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_fgcolor_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_fgcolor_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_bgcolor
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_bgcolor_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_bgcolor_indexed
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_bgcolor_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_bgcolor_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_type
    IMPORTING
      value         TYPE zexcel_s_gradient_type-type
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_degree
    IMPORTING
      value         TYPE zexcel_s_gradient_type-degree
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_bottom
    IMPORTING
      value         TYPE zexcel_s_gradient_type-bottom
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_left
    IMPORTING
      value         TYPE zexcel_s_gradient_type-left
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_top
    IMPORTING
      value         TYPE zexcel_s_gradient_type-top
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_right
    IMPORTING
      value         TYPE zexcel_s_gradient_type-right
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_position1
    IMPORTING
      value         TYPE zexcel_s_gradient_type-position1
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_position2
    IMPORTING
      value         TYPE zexcel_s_gradient_type-position2
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_fill_gradtype_position3
    IMPORTING
      value         TYPE zexcel_s_gradient_type-position3
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_diagonal_mode
    IMPORTING
      value         TYPE zexcel_diagonal
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_alignment_horizontal
    IMPORTING
      value         TYPE zexcel_alignment
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_alignment_vertical
    IMPORTING
      value         TYPE zexcel_alignment
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_alignment_textrotation
    IMPORTING
      value         TYPE zexcel_text_rotation
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_alignment_wraptext
    IMPORTING
      value         TYPE flag
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_alignment_shrinktofit
    IMPORTING
      value         TYPE flag
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_alignment_indent
    IMPORTING
      value         TYPE zexcel_indent
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_protection_hidden
    IMPORTING
      value         TYPE zexcel_cell_protection
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_protection_locked
    IMPORTING
      value         TYPE zexcel_cell_protection
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_allborders_style
    IMPORTING
      value         TYPE zexcel_border
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_allborders_color
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_allbo_color_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_allbo_color_indexe
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_allbo_color_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_allbo_color_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_diagonal_style
    IMPORTING
      value         TYPE zexcel_border
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_diagonal_color
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_diagonal_color_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_diagonal_color_ind
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_diagonal_color_the
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_diagonal_color_tin
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_down_style
    IMPORTING
      value         TYPE zexcel_border
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_down_color
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_down_color_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_down_color_indexed
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_down_color_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_down_color_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_left_style
    IMPORTING
      value         TYPE zexcel_border
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_left_color
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_left_color_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_left_color_indexed
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_left_color_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_left_color_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_right_style
    IMPORTING
      value         TYPE zexcel_border
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_right_color
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_right_color_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_right_color_indexe
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_right_color_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_right_color_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_top_style
    IMPORTING
      value         TYPE zexcel_border
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_top_color
    IMPORTING
      value         TYPE zexcel_s_style_color
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_top_color_rgb
    IMPORTING
      value         TYPE zexcel_style_color_argb
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_top_color_indexed
    IMPORTING
      value         TYPE zexcel_style_color_indexed
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_top_color_theme
    IMPORTING
      value         TYPE zexcel_style_color_theme
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  METHODS set_borders_top_color_tint
    IMPORTING
      value         TYPE zexcel_style_color_tint
    RETURNING
      VALUE(result) TYPE REF TO Lif_excel_style_changer.
  DATA: complete_style  TYPE zexcel_s_cstyle_complete READ-ONLY,
        complete_stylex TYPE zexcel_s_cstylex_complete READ-ONLY.
ENDINTERFACE.
*"* class pool for interface LIF_EXCEL_WRITER

INTERFACE Lif_excel_writer
   .


  METHODS write_file
    IMPORTING
      !io_excel      TYPE REF TO Lcl_excel
    RETURNING
      VALUE(ep_file) TYPE xstring
    RAISING
      Lcx_excel.
ENDINTERFACE.
*class-pool .
*"* class pool for class LCL_EXCEL_AUTOFILTER

*"* local type definitions
*include Lcl_excel_autofilter==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_AUTOFILTER definition
*"* public declarations
*include Lcl_excel_autofilter==========cu.
CLASS Lcl_excel_autofilter DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_AUTOFILTER
*"* do not include other source files here!!!
  PUBLIC SECTION.

    TYPES tv_filter_rule TYPE string .
    TYPES tv_logical_operator TYPE c LENGTH 3 .
    TYPES:
      BEGIN OF ts_filter,
        column           TYPE zexcel_cell_column,
        rule             TYPE tv_filter_rule,
        t_values         TYPE HASHED TABLE OF zexcel_cell_value WITH UNIQUE KEY table_line,
        tr_textfilter1   TYPE RANGE OF string,
        logical_operator TYPE tv_logical_operator,
        tr_textfilter2   TYPE RANGE OF string,
      END OF ts_filter .
    TYPES:
      tt_filters TYPE HASHED TABLE OF ts_filter WITH UNIQUE KEY column .

    DATA filter_area TYPE zexcel_s_autofilter_area .
    CONSTANTS mc_filter_rule_single_values TYPE tv_filter_rule VALUE 'single_values'. "#EC NOTEXT
    CONSTANTS mc_filter_rule_text_pattern TYPE tv_filter_rule VALUE 'text_pattern'. "#EC NOTEXT
    CONSTANTS mc_logical_operator_and TYPE tv_logical_operator VALUE 'and'. "#EC NOTEXT
    CONSTANTS mc_logical_operator_none TYPE tv_logical_operator VALUE space. "#EC NOTEXT
    CONSTANTS mc_logical_operator_or TYPE tv_logical_operator VALUE 'or'. "#EC NOTEXT

    METHODS constructor
      IMPORTING
        !io_sheet TYPE REF TO Lcl_excel_worksheet .
    METHODS get_filter_area
      RETURNING
        VALUE(rs_area) TYPE zexcel_s_autofilter_area
      RAISING
        Lcx_excel .
    METHODS get_filter_range
      RETURNING
        VALUE(r_range) TYPE zexcel_cell_value
      RAISING
        Lcx_excel.
    METHODS get_filter_reference
      RETURNING
        VALUE(r_ref) TYPE zexcel_range_value
      RAISING
        Lcx_excel .
    METHODS get_values
      RETURNING
        VALUE(rt_filter) TYPE zexcel_t_autofilter_values .
    METHODS is_row_hidden
      IMPORTING
        !iv_row             TYPE zexcel_cell_row
      RETURNING
        VALUE(rv_is_hidden) TYPE abap_bool .
    METHODS set_filter_area
      IMPORTING
        !is_area TYPE zexcel_s_autofilter_area .
    METHODS set_text_filter
      IMPORTING
        !i_column            TYPE zexcel_cell_column
        !iv_textfilter1      TYPE clike
        !iv_logical_operator TYPE tv_logical_operator DEFAULT mc_logical_operator_none
        !iv_textfilter2      TYPE clike OPTIONAL .
    METHODS set_value
      IMPORTING
        !i_column TYPE zexcel_cell_column
        !i_value  TYPE zexcel_cell_value .
    METHODS set_values
      IMPORTING
        !it_values TYPE zexcel_t_autofilter_values .
*"* protected components of class ZABAP_EXCEL_WORKSHEET
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_autofilter==========co.
  PROTECTED SECTION.

    METHODS get_column_filter
      IMPORTING
        !i_column        TYPE zexcel_cell_column
      RETURNING
        VALUE(rr_filter) TYPE REF TO ts_filter .
    METHODS is_row_hidden_single_values
      IMPORTING
        !iv_row             TYPE zexcel_cell_row
        !iv_col             TYPE zexcel_cell_column
        !is_filter          TYPE ts_filter
      RETURNING
        VALUE(rv_is_hidden) TYPE abap_bool .
    METHODS is_row_hidden_text_pattern
      IMPORTING
        !iv_row             TYPE zexcel_cell_row
        !iv_col             TYPE zexcel_cell_column
        !is_filter          TYPE ts_filter
      RETURNING
        VALUE(rv_is_hidden) TYPE abap_bool .
*"* private components of class LCL_EXCEL_AUTOFILTER
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_autofilter==========ci.
  PRIVATE SECTION.

    DATA worksheet TYPE REF TO Lcl_excel_worksheet .
    DATA mt_filters TYPE tt_filters .

    METHODS validate_area
      RAISING
        Lcx_excel .
endclass. "LCL_EXCEL_AUTOFILTER definition
*class-pool .
*"* class pool for class LCL_EXCEL_AUTOFILTERS

*"* local type definitions
*include Lcl_excel_autofilters=========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_AUTOFILTERS definition
*"* public declarations
*include Lcl_excel_autofilters=========cu.
CLASS Lcl_excel_autofilters DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_AUTOFILTERS
*"* do not include other source files here!!!

    CONSTANTS c_autofilter TYPE string VALUE '_xlnm._FilterDatabase'. "#EC NOTEXT

    METHODS add
      IMPORTING
        !io_sheet            TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ro_autofilter) TYPE REF TO Lcl_excel_autofilter
      RAISING
        Lcx_excel .
    METHODS clear .
    METHODS get
      IMPORTING
        !io_worksheet        TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ro_autofilter) TYPE REF TO Lcl_excel_autofilter .
    METHODS is_empty
      RETURNING
        VALUE(r_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !io_sheet TYPE any .
    METHODS size
      RETURNING
        VALUE(r_size) TYPE i .
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_autofilters=========co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_autofilters=========ci.
  PRIVATE SECTION.

    TYPES:
      BEGIN OF ts_autofilter,
        worksheet  TYPE REF TO Lcl_excel_worksheet,
        autofilter TYPE REF TO Lcl_excel_autofilter,
      END OF ts_autofilter .
    TYPES:
      tt_autofilters TYPE HASHED TABLE OF ts_autofilter WITH UNIQUE KEY worksheet .

    DATA mt_autofilters TYPE tt_autofilters .
endclass. "LCL_EXCEL_AUTOFILTERS definition
*class-pool .
*"* class pool for class LCL_EXCEL_COLUMN

*"* local type definitions
*include Lcl_excel_column==============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_COLUMN definition
*"* public declarations
*include Lcl_excel_column==============cu.
CLASS Lcl_excel_column DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_COLUMN
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS constructor
      IMPORTING
        !ip_index     TYPE zexcel_cell_column_alpha
        !ip_worksheet TYPE REF TO Lcl_excel_worksheet
        !ip_excel     TYPE REF TO Lcl_excel
      RAISING
        Lcx_excel .
    METHODS get_auto_size
      RETURNING
        VALUE(r_auto_size) TYPE abap_bool .
    METHODS get_collapsed
      RETURNING
        VALUE(r_collapsed) TYPE abap_bool .
    METHODS get_column_index
      RETURNING
        VALUE(r_column_index) TYPE int4 .
    METHODS get_outline_level
      RETURNING
        VALUE(r_outline_level) TYPE int4 .
    METHODS get_visible
      RETURNING
        VALUE(r_visible) TYPE abap_bool .
    METHODS get_width
      RETURNING
        VALUE(r_width) TYPE f .
    METHODS get_xf_index
      RETURNING
        VALUE(r_xf_index) TYPE int4 .
    METHODS set_auto_size
      IMPORTING
        !ip_auto_size    TYPE abap_bool
      RETURNING
        VALUE(io_column) TYPE REF TO Lcl_excel_column .
    METHODS set_collapsed
      IMPORTING
        !ip_collapsed    TYPE abap_bool
      RETURNING
        VALUE(io_column) TYPE REF TO Lcl_excel_column .
    METHODS set_column_index
      IMPORTING
        !ip_index        TYPE zexcel_cell_column_alpha
      RETURNING
        VALUE(io_column) TYPE REF TO Lcl_excel_column
      RAISING
        Lcx_excel .
    METHODS set_outline_level
      IMPORTING
        !ip_outline_level TYPE int4 .
    METHODS set_visible
      IMPORTING
        !ip_visible      TYPE abap_bool
      RETURNING
        VALUE(io_column) TYPE REF TO Lcl_excel_column .
    METHODS set_width
      IMPORTING
        !ip_width        TYPE simple
      RETURNING
        VALUE(io_column) TYPE REF TO Lcl_excel_column
      RAISING
        Lcx_excel .
    METHODS set_xf_index
      IMPORTING
        !ip_xf_index     TYPE int4
      RETURNING
        VALUE(io_column) TYPE REF TO Lcl_excel_column .
    METHODS set_column_style_by_guid
      IMPORTING
        !ip_style_guid TYPE zexcel_cell_style
      RAISING
        Lcx_excel .
    METHODS get_column_style_guid
      RETURNING
        VALUE(ep_style_guid) TYPE zexcel_cell_style
      RAISING
        Lcx_excel .
*"* protected components of class LCL_EXCEL_COLUMN
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_column==============co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_COLUMN
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_column==============ci.
  PRIVATE SECTION.

    DATA column_index TYPE int4 .
    DATA width TYPE f .
    DATA auto_size TYPE abap_bool .
    DATA visible TYPE abap_bool .
    DATA outline_level TYPE int4 .
    DATA collapsed TYPE abap_bool .
    DATA xf_index TYPE int4 .
    DATA style_guid TYPE zexcel_cell_style .
    DATA excel TYPE REF TO Lcl_excel .
    DATA worksheet TYPE REF TO Lcl_excel_worksheet .
endclass. "LCL_EXCEL_COLUMN definition
*class-pool .
*"* class pool for class LCL_EXCEL_COLUMNS

*"* local type definitions
*include Lcl_excel_columns=============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_COLUMNS definition
*"* public declarations
*include Lcl_excel_columns=============cu.
CLASS Lcl_excel_columns DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_COLUMNS
*"* do not include other source files here!!!
  PUBLIC SECTION.
    METHODS add
      IMPORTING
        !io_column TYPE REF TO Lcl_excel_column .
    METHODS clear .
    METHODS constructor .
    METHODS get
      IMPORTING
        !ip_index        TYPE i
      RETURNING
        VALUE(eo_column) TYPE REF TO Lcl_excel_column .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !io_column TYPE REF TO Lcl_excel_column .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_columns=============co.
  PROTECTED SECTION.
*"* private components of class ZABAP_EXCEL_RANGES
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_columns=============ci.
  PRIVATE SECTION.
    TYPES:
      BEGIN OF mty_s_hashed_column,
        column_index TYPE int4,
        column       TYPE REF TO Lcl_excel_column,
      END OF mty_s_hashed_column ,
      mty_ts_hashed_column TYPE HASHED TABLE OF mty_s_hashed_column WITH UNIQUE KEY column_index.

    DATA columns TYPE REF TO Lcl_excel_collection .
    DATA columns_hashed TYPE mty_ts_hashed_column .
endclass. "LCL_EXCEL_COLUMNS definition
*class-pool .
*"* class pool for class LCL_EXCEL_COMMON

*"* local type definitions
*include Lcl_excel_common==============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_COMMON definition
*"* public declarations
*include Lcl_excel_common==============cu.
CLASS Lcl_excel_common DEFINITION
*public
  FINAL
  CREATE PUBLIC


.

*"* public components of class LCL_EXCEL_COMMON
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CONSTANTS c_excel_baseline_date TYPE d VALUE '19000101'. "#EC NOTEXT
    CLASS-DATA c_excel_numfmt_offset TYPE int1 VALUE 164. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    CONSTANTS c_excel_sheet_max_col TYPE int4 VALUE 16384.  "#EC NOTEXT
    CONSTANTS c_excel_sheet_min_col TYPE int4 VALUE 1.      "#EC NOTEXT
    CONSTANTS c_excel_sheet_max_row TYPE int4 VALUE 1048576. "#EC NOTEXT
    CONSTANTS c_excel_sheet_min_row TYPE int4 VALUE 1.      "#EC NOTEXT
    CLASS-DATA c_spras_en TYPE spras VALUE 'E'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    CLASS-DATA o_conv TYPE REF TO cl_abap_conv_out_ce .
    CONSTANTS c_excel_1900_leap_year TYPE d VALUE '19000228'. "#EC NOTEXT
    CLASS-DATA c_xlsx_file_filter TYPE string VALUE 'Excel Workbook (*.xlsx)|*.xlsx|'. "#EC NOTEXT .  .  .  .  .  .  . " .

    CLASS-METHODS class_constructor .
    CLASS-METHODS describe_structure
      IMPORTING
        !io_struct      TYPE REF TO cl_abap_structdescr
      RETURNING
        VALUE(rt_dfies) TYPE ddfields .
    CLASS-METHODS convert_column2alpha
      IMPORTING
        !ip_column       TYPE simple
      RETURNING
        VALUE(ep_column) TYPE zexcel_cell_column_alpha
      RAISING
        Lcx_excel .
    CLASS-METHODS convert_column2int
      IMPORTING
        !ip_column       TYPE simple
      RETURNING
        VALUE(ep_column) TYPE zexcel_cell_column
      RAISING
        Lcx_excel .
    CLASS-METHODS convert_column_a_row2columnrow
      IMPORTING
        !i_column          TYPE simple
        !i_row             TYPE zexcel_cell_row
      RETURNING
        VALUE(e_columnrow) TYPE string
      RAISING
        Lcx_excel.
    CLASS-METHODS convert_columnrow2column_a_row
      IMPORTING
        !i_columnrow  TYPE clike
      EXPORTING
        !e_column     TYPE zexcel_cell_column_alpha
        !e_column_int TYPE zexcel_cell_column
        !e_row        TYPE zexcel_cell_row
      RAISING
        Lcx_excel.
    CLASS-METHODS convert_range2column_a_row
      IMPORTING
        !i_range            TYPE clike
        !i_allow_1dim_range TYPE abap_bool DEFAULT abap_false
      EXPORTING
        !e_column_start     TYPE zexcel_cell_column_alpha
        !e_column_start_int TYPE zexcel_cell_column
        !e_column_end       TYPE zexcel_cell_column_alpha
        !e_column_end_int   TYPE zexcel_cell_column
        !e_row_start        TYPE zexcel_cell_row
        !e_row_end          TYPE zexcel_cell_row
        !e_sheet            TYPE clike
      RAISING
        Lcx_excel .
    CLASS-METHODS convert_columnrow2column_o_row
      IMPORTING
        !i_columnrow TYPE clike
      EXPORTING
        !e_column    TYPE zexcel_cell_column_alpha
        !e_row       TYPE zexcel_cell_row .
    CLASS-METHODS clone_ixml_with_namespaces
      IMPORTING
        element       TYPE REF TO if_ixml_element
      RETURNING
        VALUE(result) TYPE REF TO if_ixml_element.
    CLASS-METHODS date_to_excel_string
      IMPORTING
        !ip_value       TYPE d
      RETURNING
        VALUE(ep_value) TYPE zexcel_cell_value .
    CLASS-METHODS encrypt_password
      IMPORTING
        !i_pwd                 TYPE zexcel_aes_password
      RETURNING
        VALUE(r_encrypted_pwd) TYPE zexcel_aes_password .
    CLASS-METHODS escape_string
      IMPORTING
        !ip_value               TYPE clike
      RETURNING
        VALUE(ep_escaped_value) TYPE string .
    CLASS-METHODS unescape_string
      IMPORTING
        !iv_escaped                TYPE clike
      RETURNING
        VALUE(ev_unescaped_string) TYPE string
      RAISING
        Lcx_excel .
    CLASS-METHODS excel_string_to_date
      IMPORTING
        !ip_value       TYPE zexcel_cell_value
      RETURNING
        VALUE(ep_value) TYPE d
      RAISING
        Lcx_excel .
    CLASS-METHODS excel_string_to_time
      IMPORTING
        !ip_value       TYPE zexcel_cell_value
      RETURNING
        VALUE(ep_value) TYPE t
      RAISING
        Lcx_excel .
    CLASS-METHODS excel_string_to_number
      IMPORTING
        !ip_value       TYPE zexcel_cell_value
      RETURNING
        VALUE(ep_value) TYPE f
      RAISING
        Lcx_excel .
    CLASS-METHODS get_fieldcatalog
      IMPORTING
        !ip_table              TYPE STANDARD TABLE
        !iv_hide_mandt         TYPE abap_bool DEFAULT abap_true
        !ip_conv_exit_length   TYPE abap_bool DEFAULT abap_false
      RETURNING
        VALUE(ep_fieldcatalog) TYPE zexcel_t_fieldcatalog .
    CLASS-METHODS number_to_excel_string
      IMPORTING
        VALUE(ip_value) TYPE numeric
        ip_currency     TYPE waers_curc OPTIONAL
      RETURNING
        VALUE(ep_value) TYPE zexcel_cell_value .
    CLASS-METHODS recursive_class_to_struct
      IMPORTING
        !i_source  TYPE any
      CHANGING
        !e_target  TYPE data
        !e_targetx TYPE data .
    CLASS-METHODS recursive_struct_to_class
      IMPORTING
        !i_source  TYPE data
        !i_sourcex TYPE data
      CHANGING
        !e_target  TYPE any .
    CLASS-METHODS time_to_excel_string
      IMPORTING
        !ip_value       TYPE t
      RETURNING
        VALUE(ep_value) TYPE zexcel_cell_value .
    TYPES: t_char10 TYPE c LENGTH 10.
    TYPES: t_char255 TYPE c LENGTH 255.
    CLASS-METHODS split_file
      IMPORTING
        !ip_file         TYPE t_char255
      EXPORTING
        !ep_file         TYPE t_char255
        !ep_extension    TYPE t_char10
        !ep_dotextension TYPE t_char10 .
    CLASS-METHODS calculate_cell_distance
      IMPORTING
        !iv_reference_cell TYPE clike
        !iv_current_cell   TYPE clike
      EXPORTING
        !ev_row_difference TYPE i
        !ev_col_difference TYPE i
      RAISING
        Lcx_excel .
    CLASS-METHODS determine_resulting_formula
      IMPORTING
        !iv_reference_cell          TYPE clike
        !iv_reference_formula       TYPE clike
        !iv_current_cell            TYPE clike
      RETURNING
        VALUE(ev_resulting_formula) TYPE string
      RAISING
        Lcx_excel .
    CLASS-METHODS shift_formula
      IMPORTING
        !iv_reference_formula       TYPE clike
        VALUE(iv_shift_cols)        TYPE i
        VALUE(iv_shift_rows)        TYPE i
      RETURNING
        VALUE(ev_resulting_formula) TYPE string
      RAISING
        Lcx_excel .
    CLASS-METHODS is_cell_in_range
      IMPORTING
        !ip_column         TYPE simple
        !ip_row            TYPE zexcel_cell_row
        !ip_range          TYPE clike
      RETURNING
        VALUE(rp_in_range) TYPE abap_bool
      RAISING
        Lcx_excel .
*"* protected components of class LCL_EXCEL_COMMON
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_COMMON
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_common==============co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_common==============ci.
  PRIVATE SECTION.

    CLASS-DATA c_excel_col_module TYPE int2 VALUE 64. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    CLASS-DATA sv_prev_in1  TYPE zexcel_cell_column.
    CLASS-DATA sv_prev_out1 TYPE zexcel_cell_column_alpha.
    CLASS-DATA sv_prev_in2  TYPE c LENGTH 10.
    CLASS-DATA sv_prev_out2 TYPE zexcel_cell_column.
    CLASS-METHODS structure_case
      IMPORTING
        !is_component  TYPE abap_componentdescr
      CHANGING
        !xt_components TYPE abap_component_tab .
    CLASS-METHODS structure_recursive
      IMPORTING
        !is_component        TYPE abap_componentdescr
      RETURNING
        VALUE(rt_components) TYPE abap_component_tab .
    TYPES ty_char1 TYPE c LENGTH 1.
    CLASS-METHODS char2hex
      IMPORTING
        !i_char      TYPE ty_char1
      RETURNING
        VALUE(r_hex) TYPE zexcel_pwd_hash .
    CLASS-METHODS shl01
      IMPORTING
        !i_pwd_hash       TYPE zexcel_pwd_hash
      RETURNING
        VALUE(r_pwd_hash) TYPE zexcel_pwd_hash .
    CLASS-METHODS shr14
      IMPORTING
        !i_pwd_hash       TYPE zexcel_pwd_hash
      RETURNING
        VALUE(r_pwd_hash) TYPE zexcel_pwd_hash .
endclass. "LCL_EXCEL_COMMON definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER

*"* local type definitions
*include Lcl_excel_converter===========ccdef.
*"* use this source file for any type declarations (class
*"* definitions, interfaces or data types) you need for method
*"* implementation or private method's signature

TYPES SHRITEFUH64VYIPN5I4UIDBI772SE4 TYPE c LENGTH 1.

TYPES:   BEGIN OF SHRITEFUH64VYIPN5I4UIDBI775SE4,
           seoclass   TYPE seoclsname,
           clsname    TYPE seoclsname,
         END OF SHRITEFUH64VYIPN5I4UIDBI775SE4,
         tt_alv_types TYPE HASHED TABLE OF SHRITEFUH64VYIPN5I4UIDBI775SE4 WITH UNIQUE KEY seoclass.

TYPES:   BEGIN OF SHRITEFUH64VYIPN5I4UIDBI776SE4,
            fieldname      TYPE fieldname,
            row_int        TYPE zexcel_cell_row,
            value          TYPE REF TO data,
            new            TYPE flag,
            sort_level     TYPE int4,
            is_collapsed   TYPE flag,
         END OF SHRITEFUH64VYIPN5I4UIDBI776SE4,

         tt_sort_values TYPE HASHED TABLE OF SHRITEFUH64VYIPN5I4UIDBI776SE4 WITH UNIQUE KEY fieldname.
TYPES:   BEGIN OF SHRITEFUH64VYIPN5I4UIDBI777SE4,
            row_int        TYPE zexcel_cell_row,
            row_int_start  TYPE zexcel_cell_row,
            columnname     TYPE fieldname,
         END OF SHRITEFUH64VYIPN5I4UIDBI777SE4,

         tt_subtotal_rows TYPE HASHED TABLE OF SHRITEFUH64VYIPN5I4UIDBI777SE4 WITH UNIQUE KEY row_int.

TYPES:   BEGIN OF SHRITEFUH64VYIPN5I4UIDBJAAASE4,
            type         TYPE SHRITEFUH64VYIPN5I4UIDBI772SE4,
            alignment    TYPE zexcel_alignment,
            inttype      TYPE abap_typekind,
            decimals     TYPE int1,
            style        TYPE REF TO Lcl_excel_style,
            guid         TYPE zexcel_cell_style,
         END OF SHRITEFUH64VYIPN5I4UIDBJAAASE4,

         tt_styles TYPE HASHED TABLE OF SHRITEFUH64VYIPN5I4UIDBJAAASE4  WITH UNIQUE KEY type alignment inttype decimals.

TYPES:   BEGIN OF SHRITEFUH64VYIPN5I4UIDBJAABSE4,
            guid_old  TYPE zexcel_cell_style,
            fontcolor TYPE zexcel_style_color_argb,
            fillcolor TYPE zexcel_style_color_argb,
            style_new TYPE REF TO Lcl_excel_style,
         END OF SHRITEFUH64VYIPN5I4UIDBJAABSE4,

         tt_color_styles TYPE HASHED TABLE OF SHRITEFUH64VYIPN5I4UIDBJAABSE4  WITH UNIQUE KEY guid_old fontcolor fillcolor.

*"* class LCL_EXCEL_CONVERTER definition
*"* public declarations
*include Lcl_excel_converter===========cu.
CLASS Lcl_excel_converter DEFINITION
*public
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_CONVERTER
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CLASS-METHODS class_constructor .
    METHODS ask_option
      RETURNING
        VALUE(rs_option) TYPE zexcel_s_converter_option
      RAISING
        Lcx_excel .
    METHODS convert
      IMPORTING
        !is_option     TYPE zexcel_s_converter_option OPTIONAL
        !io_alv        TYPE REF TO object OPTIONAL
        !it_table      TYPE STANDARD TABLE OPTIONAL
        !i_row_int     TYPE i DEFAULT 1
        !i_column_int  TYPE i DEFAULT 1
        !i_table       TYPE flag OPTIONAL
        !i_style_table TYPE zexcel_table_style OPTIONAL
        !io_worksheet  TYPE REF TO Lcl_excel_worksheet OPTIONAL
      CHANGING
        !co_excel      TYPE REF TO Lcl_excel OPTIONAL
      RAISING
        Lcx_excel .
    METHODS create_path
      RETURNING
        VALUE(r_path) TYPE string .
    METHODS get_file
      EXPORTING
        !e_bytecount TYPE i
        !et_file     TYPE solix_tab
        !e_file      TYPE xstring
      RAISING
        Lcx_excel .
    METHODS get_option
      RETURNING
        VALUE(rs_option) TYPE zexcel_s_converter_option .
    METHODS open_file
      RAISING
        Lcx_excel .
    METHODS set_option
      IMPORTING
        !is_option TYPE zexcel_s_converter_option .
    METHODS write_file
      IMPORTING
        !i_path TYPE string OPTIONAL
      RAISING
        Lcx_excel .
*"* protected components of class LCL_EXCEL_CONVERTER
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_converter===========co.
  PROTECTED SECTION.

    TYPES:
      BEGIN OF t_relationship,
        id     TYPE string,
        type   TYPE string,
        target TYPE string,
      END OF t_relationship .
    TYPES:
      BEGIN OF t_fileversion,
        appname      TYPE string,
        lastedited   TYPE string,
        lowestedited TYPE string,
        rupbuild     TYPE string,
        codename     TYPE string,
      END OF t_fileversion .
    TYPES:
      BEGIN OF t_sheet,
        name    TYPE string,
        sheetid TYPE string,
        id      TYPE string,
      END OF t_sheet .
    TYPES:
      BEGIN OF t_workbookpr,
        codename            TYPE string,
        defaultthemeversion TYPE string,
      END OF t_workbookpr .
    TYPES:
      BEGIN OF t_sheetpr,
        codename TYPE string,
      END OF t_sheetpr .

    DATA w_row_int TYPE zexcel_cell_row VALUE 1. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA w_col_int TYPE zexcel_cell_column VALUE 1. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
*"* private components of class LCL_EXCEL_CONVERTER
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_converter===========ci.
  PRIVATE SECTION.
    CLASS-METHODS get_subclasses
      IMPORTING
        is_clskey  TYPE seoclskey
      CHANGING
        ct_classes TYPE seor_implementing_keys.

    DATA wo_excel TYPE REF TO Lcl_excel .
    DATA wo_worksheet TYPE REF TO Lcl_excel_worksheet .
    DATA wo_autofilter TYPE REF TO Lcl_excel_autofilter .
    DATA wo_table TYPE REF TO data .
    DATA wo_data TYPE REF TO data .
    DATA wt_fieldcatalog TYPE zexcel_t_converter_fcat .
    DATA ws_layout TYPE zexcel_s_converter_layo .
    DATA wt_colors TYPE zexcel_t_converter_col .
    DATA wt_filter TYPE zexcel_t_converter_fil .
    CLASS-DATA wt_objects TYPE tt_alv_types .
    CLASS-DATA w_fcount TYPE n LENGTH 3 .
    DATA wt_sort_values TYPE tt_sort_values .
    DATA wt_subtotal_rows TYPE tt_subtotal_rows .
    DATA wt_styles TYPE tt_styles .
    CONSTANTS c_type_hdr TYPE c VALUE 'H'.                  "#EC NOTEXT
    CONSTANTS c_type_str TYPE c VALUE 'P'.                  "#EC NOTEXT
    CONSTANTS c_type_nor TYPE c VALUE 'N'.                  "#EC NOTEXT
    CONSTANTS c_type_sub TYPE c VALUE 'S'.                  "#EC NOTEXT
    CONSTANTS c_type_tot TYPE c VALUE 'T'.                  "#EC NOTEXT
    DATA wt_color_styles TYPE tt_color_styles .
    CLASS-DATA ws_option TYPE zexcel_s_converter_option .
    CLASS-DATA ws_indx TYPE indx .

    CLASS-METHODS init_option .
    CLASS-METHODS get_alv_converters.
    METHODS bind_table
      IMPORTING
        !i_style_table      TYPE zexcel_table_style
      RETURNING
        VALUE(r_freeze_col) TYPE int1
      RAISING
        Lcx_excel .
    METHODS bind_cells
      RETURNING
        VALUE(r_freeze_col) TYPE int1
      RAISING
        Lcx_excel .
    METHODS clean_fieldcatalog .
    METHODS create_color_style
      IMPORTING
        !i_style        TYPE zexcel_cell_style
        !is_colors      TYPE zexcel_s_converter_col
      RETURNING
        VALUE(ro_style) TYPE REF TO Lcl_excel_style .
    METHODS create_formular_subtotal
      IMPORTING
        !i_row_int_start   TYPE zexcel_cell_row
        !i_row_int_end     TYPE zexcel_cell_row
        !i_column          TYPE zexcel_cell_column_alpha
        !i_totals_function TYPE zexcel_table_totals_function
      RETURNING
        VALUE(r_formula)   TYPE string .
    METHODS create_formular_total
      IMPORTING
        !i_row_int         TYPE zexcel_cell_row
        !i_column          TYPE zexcel_cell_column_alpha
        !i_totals_function TYPE zexcel_table_totals_function
      RETURNING
        VALUE(r_formula)   TYPE string .
    METHODS create_style_hdr
      IMPORTING
        !i_alignment    TYPE zexcel_alignment OPTIONAL
      RETURNING
        VALUE(ro_style) TYPE REF TO Lcl_excel_style .
    METHODS create_style_normal
      IMPORTING
        !i_alignment    TYPE zexcel_alignment OPTIONAL
        !i_inttype      TYPE abap_typekind OPTIONAL
        !i_decimals     TYPE int1 OPTIONAL
      RETURNING
        VALUE(ro_style) TYPE REF TO Lcl_excel_style .
    METHODS create_style_stripped
      IMPORTING
        !i_alignment    TYPE zexcel_alignment OPTIONAL
        !i_inttype      TYPE abap_typekind OPTIONAL
        !i_decimals     TYPE int1 OPTIONAL
      RETURNING
        VALUE(ro_style) TYPE REF TO Lcl_excel_style .
    METHODS create_style_subtotal
      IMPORTING
        !i_alignment    TYPE zexcel_alignment OPTIONAL
        !i_inttype      TYPE abap_typekind OPTIONAL
        !i_decimals     TYPE int1 OPTIONAL
      RETURNING
        VALUE(ro_style) TYPE REF TO Lcl_excel_style .
    METHODS create_style_total
      IMPORTING
        !i_alignment    TYPE zexcel_alignment OPTIONAL
        !i_inttype      TYPE abap_typekind OPTIONAL
        !i_decimals     TYPE int1 OPTIONAL
      RETURNING
        VALUE(ro_style) TYPE REF TO Lcl_excel_style .
    METHODS create_table .
    METHODS create_text_subtotal
      IMPORTING
        !i_value           TYPE any
        !i_totals_function TYPE zexcel_table_totals_function
      RETURNING
        VALUE(r_text)      TYPE string .
    METHODS create_worksheet
      IMPORTING
        !i_table       TYPE flag DEFAULT 'X'
        !i_style_table TYPE zexcel_table_style
      RAISING
        Lcx_excel .
    METHODS execute_converter
      IMPORTING
        !io_object TYPE REF TO object
        !it_table  TYPE STANDARD TABLE
      RAISING
        Lcx_excel .
    METHODS get_color_style
      IMPORTING
        !i_row         TYPE zexcel_cell_row
        !i_fieldname   TYPE fieldname
        !i_style       TYPE zexcel_cell_style
      RETURNING
        VALUE(r_style) TYPE zexcel_cell_style .
    METHODS get_function_number
      IMPORTING
        !i_totals_function       TYPE zexcel_table_totals_function
      RETURNING
        VALUE(r_function_number) TYPE int1 .
    METHODS get_style
      IMPORTING
        !i_type        TYPE SHRITEFUH64VYIPN5I4UIDBI772SE4
        !i_alignment   TYPE zexcel_alignment DEFAULT space
        !i_inttype     TYPE abap_typekind DEFAULT space
        !i_decimals    TYPE int1 DEFAULT 0
      RETURNING
        VALUE(r_style) TYPE zexcel_cell_style .
    METHODS loop_normal
      IMPORTING
        !i_row_int          TYPE zexcel_cell_row
        !i_col_int          TYPE zexcel_cell_column
      RETURNING
        VALUE(r_freeze_col) TYPE int1
      RAISING
        Lcx_excel .
    METHODS loop_subtotal
      IMPORTING
        !i_row_int          TYPE zexcel_cell_row
        !i_col_int          TYPE zexcel_cell_column
      RETURNING
        VALUE(r_freeze_col) TYPE int1
      RAISING
        Lcx_excel .
    METHODS set_autofilter_area .
    METHODS set_cell_format
      IMPORTING
        !i_inttype      TYPE abap_typekind
        !i_decimals     TYPE int1
      RETURNING
        VALUE(r_format) TYPE zexcel_number_format .
    METHODS set_fieldcatalog .
endclass. "LCL_EXCEL_CONVERTER definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER_ALV

*"* local type definitions
*include Lcl_excel_converter_alv=======ccdef.
*"* use this source file for any type declarations (class
*"* definitions, interfaces or data types) you need for method
*"* implementation or private method's signature
TYPES: BEGIN OF SHRITEFUH64VYIPN5I4UIDBJAACSE4,
           col       TYPE lvc_col,
           int       TYPE lvc_int,
           inv       TYPE lvc_inv,
           fontcolor TYPE zexcel_style_color_argb,
           fillcolor TYPE zexcel_style_color_argb,
       END OF SHRITEFUH64VYIPN5I4UIDBJAACSE4,

       tt_col_converter TYPE HASHED TABLE OF SHRITEFUH64VYIPN5I4UIDBJAACSE4 WITH UNIQUE KEY col int inv.

*"* class LCL_EXCEL_CONVERTER_ALV definition
*"* public declarations
*include Lcl_excel_converter_alv=======cu.
CLASS Lcl_excel_converter_alv DEFINITION
*public
  ABSTRACT
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_CONVERTER_ALV
*"* do not include other source files here!!!
  PUBLIC SECTION.

    INTERFACES Lif_excel_converter
      ALL METHODS ABSTRACT .

    CLASS-METHODS class_constructor .
*"* protected components of class LCL_EXCEL_CONVERTER_ALV
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_converter_alv=======co.
  PROTECTED SECTION.

    DATA wt_sort TYPE lvc_t_sort .
    DATA wt_filt TYPE lvc_t_filt .
    DATA wt_fcat TYPE lvc_t_fcat .
    DATA ws_layo TYPE lvc_s_layo .
    DATA ws_option TYPE zexcel_s_converter_option .

    METHODS update_catalog
      CHANGING
        !cs_layout       TYPE zexcel_s_converter_layo
        !ct_fieldcatalog TYPE zexcel_t_converter_fcat .
    METHODS apply_sort
      IMPORTING
        !it_table TYPE STANDARD TABLE
      EXPORTING
        !eo_table TYPE REF TO data .
    METHODS get_color
      IMPORTING
        !io_table  TYPE REF TO data
      EXPORTING
        !et_colors TYPE zexcel_t_converter_col .
    METHODS get_filter
      EXPORTING
        !et_filter TYPE zexcel_t_converter_fil
      CHANGING
        !xo_table  TYPE REF TO data .
*"* private components of class LCL_EXCEL_CONVERTER_ALV
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_converter_alv=======ci.
  PRIVATE SECTION.

    CLASS-DATA wt_colors TYPE tt_col_converter .
endclass. "LCL_EXCEL_CONVERTER_ALV definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER_ALV_GRID

*"* local type definitions
*include Lcl_excel_converter_alv_grid==ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_CONVERTER_ALV_GRID definition
*"* public declarations
*include Lcl_excel_converter_alv_grid==cu.
CLASS Lcl_excel_converter_alv_grid DEFINITION
*public
  INHERITING FROM Lcl_excel_converter_alv
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    METHODS Lif_excel_converter~can_convert_object
        REDEFINITION .
*"* public components of class LCL_EXCEL_CONVERTER_ALV_GRID
*"* do not include other source files here!!!
    METHODS Lif_excel_converter~create_fieldcatalog
        REDEFINITION .
    METHODS Lif_excel_converter~get_supported_class
        REDEFINITION .
*"* protected declarations
*include Lcl_excel_converter_alv_grid==co.
  PROTECTED SECTION.
*"* protected components of class LCL_EXCEL_CONVERTER_ALV_GRID
*"* do not include other source files here!!!
*"* private components of class LCL_EXCEL_CONVERTER_ALV_GRID
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_converter_alv_grid==ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_CONVERTER_ALV_GRID definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER_RESULT

*"* local type definitions
*include Lcl_excel_converter_result====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_CONVERTER_RESULT definition
*"* public declarations
*include Lcl_excel_converter_result====cu.
CLASS Lcl_excel_converter_result DEFINITION
*public
  INHERITING FROM Lcl_excel_converter_alv
  ABSTRACT
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_CONVERTER_RESULT
*"* do not include other source files here!!!
  PUBLIC SECTION.
*"* protected components of class LCL_EXCEL_CONVERTER_RESULT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_converter_result====co.
  PROTECTED SECTION.

    METHODS get_table
      IMPORTING
        !io_object     TYPE REF TO object
      RETURNING
        VALUE(ro_data) TYPE REF TO data .
*"* private components of class LCL_EXCEL_CONVERTER_RESULT
*"* do not include other source files here!!!
*"* private components of class LCL_EXCEL_CONVERTER_RESULT
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_converter_result====ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_CONVERTER_RESULT definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER_RESULT_EX

*"* local type definitions
*include Lcl_excel_converter_result_ex=ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_CONVERTER_RESULT_EX definition
*"* public declarations
*include Lcl_excel_converter_result_ex=cu.
CLASS Lcl_excel_converter_result_ex DEFINITION
*public
  INHERITING FROM Lcl_excel_converter_result
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_CONVERTER_RESULT_EX
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS Lif_excel_converter~can_convert_object
        REDEFINITION .
    METHODS Lif_excel_converter~create_fieldcatalog
        REDEFINITION .
    METHODS Lif_excel_converter~get_supported_class
        REDEFINITION .
*"* protected components of class LCL_EXCEL_CONVERTER_RESULT_EX
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_CONVERTER_RESULT_EX
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_CONVERTER_RESULT_EX
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_converter_result_ex=co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_CONVERTER_EX_RESULT
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_converter_result_ex=ci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_CONVERTER_RESULT_EX definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER_RESULT_WD

*"* local type definitions
*include Lcl_excel_converter_result_wd=ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_CONVERTER_RESULT_WD definition
*"* public declarations
*include Lcl_excel_converter_result_wd=cu.
CLASS Lcl_excel_converter_result_wd DEFINITION
*public
  INHERITING FROM Lcl_excel_converter_result
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_CONVERTER_RESULT_WD
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS Lif_excel_converter~can_convert_object
        REDEFINITION .
    METHODS Lif_excel_converter~create_fieldcatalog
        REDEFINITION .
    METHODS Lif_excel_converter~get_supported_class
        REDEFINITION .
*"* protected components of class LCL_EXCEL_CONVERTER_RESULT_WD
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_CONVERTER_RESULT_WD
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_CONVERTER_RESULT_WD
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_converter_result_wd=co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_converter_result_wd=ci.
  PRIVATE SECTION.

    DATA wo_config TYPE REF TO cl_salv_wd_config_table .
    DATA wt_fields TYPE salv_wd_t_field_ref .
    DATA wt_columns TYPE salv_wd_t_column_ref .

    METHODS get_columns_info
      CHANGING
        !xs_fcat TYPE lvc_s_fcat .
    METHODS get_fields_info
      CHANGING
        !xs_fcat TYPE lvc_s_fcat .
    METHODS create_wt_sort .
    METHODS create_wt_filt .
    METHODS create_wt_fcat
      IMPORTING
        !io_table TYPE REF TO data .
endclass. "LCL_EXCEL_CONVERTER_RESULT_WD definition
*class-pool .
*"* class pool for class LCL_EXCEL_CONVERTER_SALV_TABLE

*"* local type definitions
*include Lcl_excel_converter_salv_tableccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_CONVERTER_SALV_TABLE definition
*"* public declarations
*include Lcl_excel_converter_salv_tablecu.
CLASS Lcl_excel_converter_salv_table DEFINITION
*public
  INHERITING FROM Lcl_excel_converter_alv
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_CONVERTER_SALV_TABLE
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS Lif_excel_converter~can_convert_object
        REDEFINITION .
    METHODS Lif_excel_converter~create_fieldcatalog
        REDEFINITION .
    METHODS Lif_excel_converter~get_supported_class
        REDEFINITION .
*"* protected components of class LCL_EXCEL_CONVERTER_SALV_TABLE
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_CONVERTER_SALV_TABLE
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_CONVERTER_SALV_TABLE
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_converter_salv_tableco.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_converter_salv_tableci.
  PRIVATE SECTION.

    METHODS load_data
      IMPORTING
        !io_salv  TYPE REF TO cl_salv_table
        !it_table TYPE STANDARD TABLE .
    METHODS is_intercept_data_active
      RETURNING
        VALUE(rv_result) TYPE abap_bool.
endclass. "LCL_EXCEL_CONVERTER_SALV_TABLE definition
*class-pool .
*"* class pool for class LCL_EXCEL_DRAWING

*"* local type definitions
*include Lcl_excel_drawing=============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_DRAWING definition
*"* public declarations
*include Lcl_excel_drawing=============cu.
CLASS Lcl_excel_drawing DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
    CONSTANTS c_graph_pie TYPE zexcel_graph_type VALUE 1.   "#EC NOTEXT
    CONSTANTS c_graph_line TYPE zexcel_graph_type VALUE 2.  "#EC NOTEXT
    CONSTANTS c_graph_bars TYPE zexcel_graph_type VALUE 0.  "#EC NOTEXT
    DATA graph_type TYPE zexcel_graph_type .
    DATA title TYPE string VALUE 'image1.jpg'.              "#EC NOTEXT
    CONSTANTS type_image TYPE zexcel_drawing_type VALUE 'image'. "#EC NOTEXT
    CONSTANTS type_chart TYPE zexcel_drawing_type VALUE 'chart'. "#EC NOTEXT
    CONSTANTS anchor_absolute TYPE zexcel_drawing_anchor VALUE 'ABS'. "#EC NOTEXT
    CONSTANTS anchor_one_cell TYPE zexcel_drawing_anchor VALUE 'ONE'. "#EC NOTEXT
    CONSTANTS anchor_two_cell TYPE zexcel_drawing_anchor VALUE 'TWO'. "#EC NOTEXT
    DATA graph TYPE REF TO Lcl_excel_graph .
    CONSTANTS c_media_type_bmp TYPE string VALUE 'bmp'.     "#EC NOTEXT
    CONSTANTS c_media_type_xml TYPE string VALUE 'xml'.     "#EC NOTEXT
    CONSTANTS c_media_type_jpg TYPE string VALUE 'jpg'.     "#EC NOTEXT
    CONSTANTS type_image_header_footer TYPE zexcel_drawing_type VALUE 'hd_ft'. "#EC NOTEXT
    CONSTANTS: BEGIN OF namespace,
                 c   TYPE string VALUE 'http://schemas.openxmlformats.org/drawingml/2006/chart',
                 a   TYPE string VALUE 'http://schemas.openxmlformats.org/drawingml/2006/main',
                 r   TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',
                 mc  TYPE string VALUE 'http://schemas.openxmlformats.org/markup-compatibility/2006',
                 c14 TYPE string VALUE 'http://schemas.microsoft.com/office/drawing/2007/8/2/chart',
               END OF namespace.

    METHODS constructor
      IMPORTING
        !ip_type  TYPE zexcel_drawing_type DEFAULT Lcl_excel_drawing=>type_image
        !ip_title TYPE clike OPTIONAL .
    METHODS create_media_name
      IMPORTING
        !ip_index TYPE i .
    METHODS get_from_col
      RETURNING
        VALUE(r_from_col) TYPE zexcel_cell_column .
    METHODS get_from_row
      RETURNING
        VALUE(r_from_row) TYPE zexcel_cell_row .
    METHODS get_guid
      RETURNING
        VALUE(ep_guid) TYPE zexcel_guid .
    METHODS get_height_emu_str
      RETURNING
        VALUE(r_height) TYPE string .
    METHODS get_media
      RETURNING
        VALUE(r_media) TYPE xstring .
    METHODS get_media_name
      RETURNING
        VALUE(r_name) TYPE string .
    METHODS get_media_type
      RETURNING
        VALUE(r_type) TYPE string .
    METHODS get_name
      RETURNING
        VALUE(r_name) TYPE string .
    METHODS get_to_col
      RETURNING
        VALUE(r_to_col) TYPE zexcel_cell_column .
    METHODS get_to_row
      RETURNING
        VALUE(r_to_row) TYPE zexcel_cell_row .
    METHODS get_width_emu_str
      RETURNING
        VALUE(r_width) TYPE string .
    CLASS-METHODS pixel2emu
      IMPORTING
        !ip_pixel    TYPE int4
        !ip_dpi      TYPE int2 OPTIONAL
      RETURNING
        VALUE(r_emu) TYPE string .
    CLASS-METHODS emu2pixel
      IMPORTING
        !ip_emu        TYPE int4
        !ip_dpi        TYPE int2 OPTIONAL
      RETURNING
        VALUE(r_pixel) TYPE int4 .
    METHODS set_media
      IMPORTING
        !ip_media      TYPE xstring OPTIONAL
        !ip_media_type TYPE string
        !ip_width      TYPE int4 DEFAULT 0
        !ip_height     TYPE int4 DEFAULT 0 .
    METHODS set_media_mime
      IMPORTING
        !ip_io     TYPE skwf_io
        !ip_width  TYPE int4
        !ip_height TYPE int4 .
    METHODS set_media_www
      IMPORTING
        !ip_key    TYPE wwwdatatab
        !ip_width  TYPE int4
        !ip_height TYPE int4 .
    METHODS set_position
      IMPORTING
        !ip_from_row TYPE zexcel_cell_row
        !ip_from_col TYPE zexcel_cell_column_alpha
        !ip_rowoff   TYPE int4 OPTIONAL
        !ip_coloff   TYPE int4 OPTIONAL
      RAISING
        Lcx_excel .
    METHODS set_position2
      IMPORTING
        !ip_from   TYPE zexcel_drawing_location
        !ip_to     TYPE zexcel_drawing_location
        !ip_anchor TYPE zexcel_drawing_anchor OPTIONAL .
    METHODS get_position
      RETURNING
        VALUE(rp_position) TYPE zexcel_drawing_position .
    METHODS get_type
      RETURNING
        VALUE(rp_type) TYPE zexcel_drawing_type .
    METHODS get_index
      RETURNING
        VALUE(rp_index) TYPE string .
    METHODS load_chart_attributes
      IMPORTING
        VALUE(ip_chart) TYPE REF TO if_ixml_document .
*"* protected declarations
*include Lcl_excel_drawing=============co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_drawing=============ci.
  PRIVATE SECTION.

*"* private components of class LCL_EXCEL_DRAWING
*"* do not include other source files here!!!
    DATA type TYPE zexcel_drawing_type VALUE type_image. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA index TYPE string .
    DATA anchor TYPE zexcel_drawing_anchor VALUE anchor_one_cell. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    CONSTANTS c_media_source_www TYPE c VALUE 1.            "#EC NOTEXT
    CONSTANTS c_media_source_xstring TYPE c VALUE 0.        "#EC NOTEXT
    CONSTANTS c_media_source_mime TYPE c VALUE 2.           "#EC NOTEXT
    DATA guid TYPE zexcel_guid .
    DATA media TYPE xstring .
    DATA media_key_www TYPE wwwdatatab .
    DATA media_name TYPE string .
    DATA media_source TYPE c .
    DATA media_type TYPE string .
    DATA io TYPE skwf_io .
    DATA from_loc TYPE zexcel_drawing_location .
    DATA to_loc TYPE zexcel_drawing_location .
    DATA size TYPE zexcel_drawing_size .
    CONSTANTS c_ixml_iid_element TYPE i VALUE 130.

endclass. "LCL_EXCEL_DRAWING definition
*class-pool .
*"* class pool for class LCL_EXCEL_DRAWINGS

*"* local type definitions
*include Lcl_excel_drawings============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_DRAWINGS definition
*"* public declarations
*include Lcl_excel_drawings============cu.
CLASS Lcl_excel_drawings DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

*"* public components of class LCL_EXCEL_DRAWINGS
*"* do not include other source files here!!!
    DATA type TYPE zexcel_drawing_type READ-ONLY VALUE 'IMAGE'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .

    METHODS add
      IMPORTING
        !ip_drawing TYPE REF TO Lcl_excel_drawing .
    METHODS include
      IMPORTING
        !ip_drawing TYPE REF TO Lcl_excel_drawing .
    METHODS clear .
    METHODS constructor
      IMPORTING
        !ip_type TYPE zexcel_drawing_type .
    METHODS get
      IMPORTING
        !ip_index         TYPE zexcel_active_worksheet
      RETURNING
        VALUE(eo_drawing) TYPE REF TO Lcl_excel_drawing .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !ip_drawing TYPE REF TO Lcl_excel_drawing .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
    METHODS get_type
      RETURNING
        VALUE(rp_type) TYPE zexcel_drawing_type .
*"* protected components of class LCL_EXCEL_DRAWINGS
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_DRAWINGS
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_drawings============co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_drawings============ci.
  PRIVATE SECTION.

*"* private components of class LCL_EXCEL_DRAWINGS
*"* do not include other source files here!!!
    DATA drawings TYPE REF TO Lcl_excel_collection .
endclass. "LCL_EXCEL_DRAWINGS definition
*class-pool .
*"* class pool for class LCL_EXCEL_GRAPH

*"* local type definitions
*include Lcl_excel_graph===============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_GRAPH definition
*"* public declarations
*include Lcl_excel_graph===============cu.
CLASS Lcl_excel_graph DEFINITION
*public
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
*"* public components of class LCL_EXCEL_GRAPH
*"* do not include other source files here!!!
      BEGIN OF s_style,
        c14style TYPE i,
        cstyle   TYPE i,
      END OF s_style .
    TYPES:
      BEGIN OF s_series,
        idx              TYPE i,
        order            TYPE i,
        invertifnegative TYPE string,
        symbol           TYPE string,
        smooth           TYPE string,
        lbl              TYPE string,
        ref              TYPE string,
        sername          TYPE string,
      END OF s_series .
    TYPES:
      t_series TYPE STANDARD TABLE OF s_series .
    TYPES:
      BEGIN OF s_pagemargins,
        b      TYPE string,
        l      TYPE string,
        r      TYPE string,
        t      TYPE string,
        header TYPE string,
        footer TYPE string,
      END OF s_pagemargins .

    DATA ns_1904val TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_langval TYPE string VALUE 'it-IT'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_roundedcornersval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA pagemargins TYPE s_pagemargins .
    DATA ns_autotitledeletedval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_plotvisonlyval TYPE string VALUE '1'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_dispblanksasval TYPE string VALUE 'gap'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showdlblsovermaxval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA title TYPE string .               .  . " .
    DATA series TYPE t_series .
    DATA ns_c14styleval TYPE string VALUE '102'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA print_label TYPE c VALUE 'X'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_styleval TYPE string VALUE '2'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    CONSTANTS:
      BEGIN OF c_style_default,
        c14style TYPE i VALUE 102,
        cstyle   TYPE i VALUE 2,
      END OF c_style_default .
    CONSTANTS:
      BEGIN OF c_style_1,
        c14style TYPE i VALUE 101,
        cstyle   TYPE i VALUE 1,
      END OF c_style_1 .
    CONSTANTS:
      BEGIN OF c_style_3,
        c14style TYPE i VALUE 103,
        cstyle   TYPE i VALUE 3,
      END OF c_style_3 .
    CONSTANTS:
      BEGIN OF c_style_4,
        c14style TYPE i VALUE 104,
        cstyle   TYPE i VALUE 4,
      END OF c_style_4 .
    CONSTANTS:
      BEGIN OF c_style_5,
        c14style TYPE i VALUE 105,
        cstyle   TYPE i VALUE 5,
      END OF c_style_5 .
    CONSTANTS:
      BEGIN OF c_style_6,
        c14style TYPE i VALUE 106,
        cstyle   TYPE i VALUE 6,
      END OF c_style_6 .
    CONSTANTS:
      BEGIN OF c_style_7,
        c14style TYPE i VALUE 107,
        cstyle   TYPE i VALUE 7,
      END OF c_style_7 .
    CONSTANTS:
      BEGIN OF c_style_8,
        c14style TYPE i VALUE 108,
        cstyle   TYPE i VALUE 8,
      END OF c_style_8 .
    CONSTANTS:
      BEGIN OF c_style_9,
        c14style TYPE i VALUE 109,
        cstyle   TYPE i VALUE 9,
      END OF c_style_9 .
    CONSTANTS:
      BEGIN OF c_style_10,
        c14style TYPE i VALUE 110,
        cstyle   TYPE i VALUE 10,
      END OF c_style_10 .
    CONSTANTS:
      BEGIN OF c_style_11,
        c14style TYPE i VALUE 111,
        cstyle   TYPE i VALUE 11,
      END OF c_style_11 .
    CONSTANTS:
      BEGIN OF c_style_12,
        c14style TYPE i VALUE 112,
        cstyle   TYPE i VALUE 12,
      END OF c_style_12 .
    CONSTANTS:
      BEGIN OF c_style_13,
        c14style TYPE i VALUE 113,
        cstyle   TYPE i VALUE 13,
      END OF c_style_13 .
    CONSTANTS:
      BEGIN OF c_style_14,
        c14style TYPE i VALUE 114,
        cstyle   TYPE i VALUE 14,
      END OF c_style_14 .
    CONSTANTS:
      BEGIN OF c_style_15,
        c14style TYPE i VALUE 115,
        cstyle   TYPE i VALUE 15,
      END OF c_style_15 .
    CONSTANTS:
      BEGIN OF c_style_16,
        c14style TYPE i VALUE 116,
        cstyle   TYPE i VALUE 16,
      END OF c_style_16 .
    CONSTANTS:
      BEGIN OF c_style_17,
        c14style TYPE i VALUE 117,
        cstyle   TYPE i VALUE 17,
      END OF c_style_17 .
    CONSTANTS:
      BEGIN OF c_style_18,
        c14style TYPE i VALUE 118,
        cstyle   TYPE i VALUE 18,
      END OF c_style_18 .
    CONSTANTS:
      BEGIN OF c_style_19,
        c14style TYPE i VALUE 119,
        cstyle   TYPE i VALUE 19,
      END OF c_style_19 .
    CONSTANTS:
      BEGIN OF c_style_20,
        c14style TYPE i VALUE 120,
        cstyle   TYPE i VALUE 20,
      END OF c_style_20 .
    CONSTANTS:
      BEGIN OF c_style_21,
        c14style TYPE i VALUE 121,
        cstyle   TYPE i VALUE 21,
      END OF c_style_21 .
    CONSTANTS:
      BEGIN OF c_style_22,
        c14style TYPE i VALUE 122,
        cstyle   TYPE i VALUE 22,
      END OF c_style_22 .
    CONSTANTS:
      BEGIN OF c_style_23,
        c14style TYPE i VALUE 123,
        cstyle   TYPE i VALUE 23,
      END OF c_style_23 .
    CONSTANTS:
      BEGIN OF c_style_24,
        c14style TYPE i VALUE 124,
        cstyle   TYPE i VALUE 24,
      END OF c_style_24 .
    CONSTANTS:
      BEGIN OF c_style_25,
        c14style TYPE i VALUE 125,
        cstyle   TYPE i VALUE 25,
      END OF c_style_25 .
    CONSTANTS:
      BEGIN OF c_style_26,
        c14style TYPE i VALUE 126,
        cstyle   TYPE i VALUE 26,
      END OF c_style_26 .
    CONSTANTS:
      BEGIN OF c_style_27,
        c14style TYPE i VALUE 127,
        cstyle   TYPE i VALUE 27,
      END OF c_style_27 .
    CONSTANTS:
      BEGIN OF c_style_28,
        c14style TYPE i VALUE 128,
        cstyle   TYPE i VALUE 28,
      END OF c_style_28 .
    CONSTANTS:
      BEGIN OF c_style_29,
        c14style TYPE i VALUE 129,
        cstyle   TYPE i VALUE 29,
      END OF c_style_29 .
    CONSTANTS:
      BEGIN OF c_style_30,
        c14style TYPE i VALUE 130,
        cstyle   TYPE i VALUE 30,
      END OF c_style_30 .
    CONSTANTS:
      BEGIN OF c_style_31,
        c14style TYPE i VALUE 131,
        cstyle   TYPE i VALUE 31,
      END OF c_style_31 .
    CONSTANTS:
      BEGIN OF c_style_32,
        c14style TYPE i VALUE 132,
        cstyle   TYPE i VALUE 32,
      END OF c_style_32 .
    CONSTANTS:
      BEGIN OF c_style_33,
        c14style TYPE i VALUE 133,
        cstyle   TYPE i VALUE 33,
      END OF c_style_33 .
    CONSTANTS:
      BEGIN OF c_style_34,
        c14style TYPE i VALUE 134,
        cstyle   TYPE i VALUE 34,
      END OF c_style_34 .
    CONSTANTS:
      BEGIN OF c_style_35,
        c14style TYPE i VALUE 135,
        cstyle   TYPE i VALUE 35,
      END OF c_style_35 .
    CONSTANTS:
      BEGIN OF c_style_36,
        c14style TYPE i VALUE 136,
        cstyle   TYPE i VALUE 36,
      END OF c_style_36 .
    CONSTANTS:
      BEGIN OF c_style_37,
        c14style TYPE i VALUE 137,
        cstyle   TYPE i VALUE 37,
      END OF c_style_37 .
    CONSTANTS:
      BEGIN OF c_style_38,
        c14style TYPE i VALUE 138,
        cstyle   TYPE i VALUE 38,
      END OF c_style_38 .
    CONSTANTS:
      BEGIN OF c_style_39,
        c14style TYPE i VALUE 139,
        cstyle   TYPE i VALUE 39,
      END OF c_style_39 .
    CONSTANTS:
      BEGIN OF c_style_40,
        c14style TYPE i VALUE 140,
        cstyle   TYPE i VALUE 40,
      END OF c_style_40 .
    CONSTANTS:
      BEGIN OF c_style_41,
        c14style TYPE i VALUE 141,
        cstyle   TYPE i VALUE 41,
      END OF c_style_41 .
    CONSTANTS:
      BEGIN OF c_style_42,
        c14style TYPE i VALUE 142,
        cstyle   TYPE i VALUE 42,
      END OF c_style_42 .
    CONSTANTS:
      BEGIN OF c_style_43,
        c14style TYPE i VALUE 143,
        cstyle   TYPE i VALUE 43,
      END OF c_style_43 .
    CONSTANTS:
      BEGIN OF c_style_44,
        c14style TYPE i VALUE 144,
        cstyle   TYPE i VALUE 44,
      END OF c_style_44 .
    CONSTANTS:
      BEGIN OF c_style_45,
        c14style TYPE i VALUE 145,
        cstyle   TYPE i VALUE 45,
      END OF c_style_45 .
    CONSTANTS:
      BEGIN OF c_style_46,
        c14style TYPE i VALUE 146,
        cstyle   TYPE i VALUE 46,
      END OF c_style_46 .
    CONSTANTS:
      BEGIN OF c_style_47,
        c14style TYPE i VALUE 147,
        cstyle   TYPE i VALUE 47,
      END OF c_style_47 .
    CONSTANTS:
      BEGIN OF c_style_48,
        c14style TYPE i VALUE 148,
        cstyle   TYPE i VALUE 48,
      END OF c_style_48 .
    CONSTANTS c_show_true TYPE c VALUE '1'.                 "#EC NOTEXT
    CONSTANTS c_show_false TYPE c VALUE '0'.                "#EC NOTEXT
    CONSTANTS c_print_lbl_true TYPE c VALUE '1'.            "#EC NOTEXT
    CONSTANTS c_print_lbl_false TYPE c VALUE '0'.           "#EC NOTEXT

    METHODS constructor .
    METHODS create_serie
      IMPORTING
        !ip_idx              TYPE i OPTIONAL
        !ip_order            TYPE i
        !ip_invertifnegative TYPE string OPTIONAL
        !ip_symbol           TYPE string OPTIONAL
        !ip_smooth           TYPE c OPTIONAL
        !ip_lbl_from_col     TYPE zexcel_cell_column_alpha OPTIONAL
        !ip_lbl_from_row     TYPE zexcel_cell_row OPTIONAL
        !ip_lbl_to_col       TYPE zexcel_cell_column_alpha OPTIONAL
        !ip_lbl_to_row       TYPE zexcel_cell_row OPTIONAL
        !ip_lbl              TYPE string OPTIONAL
        !ip_ref_from_col     TYPE zexcel_cell_column_alpha OPTIONAL
        !ip_ref_from_row     TYPE zexcel_cell_row OPTIONAL
        !ip_ref_to_col       TYPE zexcel_cell_column_alpha OPTIONAL
        !ip_ref_to_row       TYPE zexcel_cell_row OPTIONAL
        !ip_ref              TYPE string OPTIONAL
        !ip_sername          TYPE string
        !ip_sheet            TYPE zexcel_sheet_title OPTIONAL .
    METHODS set_style
      IMPORTING
        !ip_style TYPE s_style .
    METHODS set_print_lbl
      IMPORTING
        !ip_value TYPE c .
    METHODS set_title
      IMPORTING
        ip_value TYPE string .
*"* protected declarations
*include Lcl_excel_graph===============co.
  PROTECTED SECTION.
*"* protected components of class LCL_EXCEL_GRAPH
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_graph===============ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_GRAPH
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_GRAPH definition
*class-pool .
*"* class pool for class LCL_EXCEL_GRAPH_BARS

*"* local type definitions
*include Lcl_excel_graph_bars==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_GRAPH_BARS definition
*"* public declarations
*include Lcl_excel_graph_bars==========cu.
CLASS Lcl_excel_graph_bars DEFINITION
*public
  INHERITING FROM Lcl_excel_graph
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
*"* public components of class LCL_EXCEL_GRAPH_BARS
*"* do not include other source files here!!!
      tv_type TYPE c LENGTH 5,
      BEGIN OF s_ax,
        axid          TYPE string,
        type          TYPE tv_type,
        orientation   TYPE string,
        delete        TYPE string,
        axpos         TYPE string,
        formatcode    TYPE string,
        sourcelinked  TYPE string,
        majortickmark TYPE string,
        minortickmark TYPE string,
        ticklblpos    TYPE string,
        crossax       TYPE string,
        crosses       TYPE string,
        auto          TYPE string,
        lblalgn       TYPE string,
        lbloffset     TYPE string,
        nomultilvllbl TYPE string,
        crossbetween  TYPE string,
      END OF s_ax .
    TYPES:
      t_ax TYPE STANDARD TABLE OF s_ax .

    DATA ns_bardirval TYPE string VALUE 'col'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    CONSTANTS c_groupingval_clustered TYPE string VALUE 'clustered'. "#EC NOTEXT
    CONSTANTS c_groupingval_stacked TYPE string VALUE 'stacked'. "#EC NOTEXT
    DATA ns_groupingval TYPE string VALUE c_groupingval_clustered. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_varycolorsval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showlegendkeyval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showvalval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showcatnameval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showsernameval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showpercentval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showbubblesizeval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_gapwidthval TYPE string VALUE '150'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA axes TYPE t_ax .
    CONSTANTS:
      c_valax TYPE c LENGTH 5 VALUE 'VALAX'.                "#EC NOTEXT
    CONSTANTS:
      c_catax TYPE c LENGTH 5 VALUE 'CATAX'.                "#EC NOTEXT
    DATA ns_legendposval TYPE string VALUE 'r'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    DATA ns_overlayval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  . " .
    CONSTANTS c_invertifnegative_yes TYPE string VALUE '1'. "#EC NOTEXT
    CONSTANTS c_invertifnegative_no TYPE string VALUE '0'.  "#EC NOTEXT

    METHODS create_ax
      IMPORTING
        !ip_axid          TYPE string OPTIONAL
        !ip_type          TYPE tv_type
        !ip_orientation   TYPE string OPTIONAL
        !ip_delete        TYPE string OPTIONAL
        !ip_axpos         TYPE string OPTIONAL
        !ip_formatcode    TYPE string OPTIONAL
        !ip_sourcelinked  TYPE string OPTIONAL
        !ip_majortickmark TYPE string OPTIONAL
        !ip_minortickmark TYPE string OPTIONAL
        !ip_ticklblpos    TYPE string OPTIONAL
        !ip_crossax       TYPE string OPTIONAL
        !ip_crosses       TYPE string OPTIONAL
        !ip_auto          TYPE string OPTIONAL
        !ip_lblalgn       TYPE string OPTIONAL
        !ip_lbloffset     TYPE string OPTIONAL
        !ip_nomultilvllbl TYPE string OPTIONAL
        !ip_crossbetween  TYPE string OPTIONAL .
    METHODS set_show_legend_key
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_values
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_cat_name
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_ser_name
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_percent
      IMPORTING
        !ip_value TYPE c .
    METHODS set_varycolor
      IMPORTING
        !ip_value TYPE c .
*"* protected declarations
*include Lcl_excel_graph_bars==========co.
  PROTECTED SECTION.
*"* protected components of class LCL_EXCEL_GRAPH_BARS
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_graph_bars==========ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_GRAPH_BARS
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_GRAPH_BARS definition
*class-pool .
*"* class pool for class LCL_EXCEL_GRAPH_LINE

*"* local type definitions
*include Lcl_excel_graph_line==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_GRAPH_LINE definition
*"* public declarations
*include Lcl_excel_graph_line==========cu.
CLASS Lcl_excel_graph_line DEFINITION
*public
  INHERITING FROM Lcl_excel_graph
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
*"* public components of class LCL_EXCEL_GRAPH_LINE
*"* do not include other source files here!!!
      tv_type TYPE c LENGTH 5,
      BEGIN OF s_ax,
        axid          TYPE string,
        type          TYPE tv_type,
        orientation   TYPE string,
        delete        TYPE string,
        axpos         TYPE string,
        formatcode    TYPE string,
        sourcelinked  TYPE string,
        majortickmark TYPE string,
        minortickmark TYPE string,
        ticklblpos    TYPE string,
        crossax       TYPE string,
        crosses       TYPE string,
        auto          TYPE string,
        lblalgn       TYPE string,
        lbloffset     TYPE string,
        nomultilvllbl TYPE string,
        crossbetween  TYPE string,
      END OF s_ax .
    TYPES:
      t_ax TYPE STANDARD TABLE OF s_ax .

    DATA ns_groupingval TYPE string VALUE 'standard'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_varycolorsval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showlegendkeyval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showvalval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showcatnameval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showsernameval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showpercentval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showbubblesizeval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_markerval TYPE string VALUE '1'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_smoothval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA axes TYPE t_ax .
    CONSTANTS:
      c_valax TYPE c LENGTH 5 VALUE 'VALAX'.                "#EC NOTEXT
    CONSTANTS:
      c_catax TYPE c LENGTH 5 VALUE 'CATAX'.                "#EC NOTEXT
    DATA ns_legendposval TYPE string VALUE 'r'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_overlayval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    CONSTANTS c_symbol_auto TYPE string VALUE 'auto'.       "#EC NOTEXT
    CONSTANTS c_symbol_none TYPE string VALUE 'none'.       "#EC NOTEXT

    METHODS create_ax
      IMPORTING
        !ip_axid          TYPE string OPTIONAL
        !ip_type          TYPE tv_type
        !ip_orientation   TYPE string OPTIONAL
        !ip_delete        TYPE string OPTIONAL
        !ip_axpos         TYPE string OPTIONAL
        !ip_formatcode    TYPE string OPTIONAL
        !ip_sourcelinked  TYPE string OPTIONAL
        !ip_majortickmark TYPE string OPTIONAL
        !ip_minortickmark TYPE string OPTIONAL
        !ip_ticklblpos    TYPE string OPTIONAL
        !ip_crossax       TYPE string OPTIONAL
        !ip_crosses       TYPE string OPTIONAL
        !ip_auto          TYPE string OPTIONAL
        !ip_lblalgn       TYPE string OPTIONAL
        !ip_lbloffset     TYPE string OPTIONAL
        !ip_nomultilvllbl TYPE string OPTIONAL
        !ip_crossbetween  TYPE string OPTIONAL .
    METHODS set_show_legend_key
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_values
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_cat_name
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_ser_name
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_percent
      IMPORTING
        !ip_value TYPE c .
    METHODS set_varycolor
      IMPORTING
        !ip_value TYPE c .
*"* protected declarations
*include Lcl_excel_graph_line==========co.
  PROTECTED SECTION.
*"* protected components of class LCL_EXCEL_GRAPH_LINE
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_graph_line==========ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_GRAPH_LINE
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_GRAPH_LINE definition
*class-pool .
*"* class pool for class LCL_EXCEL_GRAPH_PIE

*"* local type definitions
*include Lcl_excel_graph_pie===========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_GRAPH_PIE definition
*"* public declarations
*include Lcl_excel_graph_pie===========cu.
CLASS Lcl_excel_graph_pie DEFINITION
*public
  INHERITING FROM Lcl_excel_graph
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

*"* public components of class LCL_EXCEL_GRAPH_PIE
*"* do not include other source files here!!!
    DATA ns_legendposval TYPE string VALUE 'r'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_overlayval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_pprrtl TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_endpararprlang TYPE string VALUE 'it-IT'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_varycolorsval TYPE string VALUE '1'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_firstsliceangval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showlegendkeyval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showvalval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showcatnameval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showsernameval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showpercentval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showbubblesizeval TYPE string VALUE '0'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA ns_showleaderlinesval TYPE string VALUE '1'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .

    METHODS set_show_legend_key
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_values
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_cat_name
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_ser_name
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_percent
      IMPORTING
        !ip_value TYPE c .
    METHODS set_show_leader_lines
      IMPORTING
        !ip_value TYPE c .
    METHODS set_varycolor
      IMPORTING
        !ip_value TYPE c .
*"* protected declarations
*include Lcl_excel_graph_pie===========co.
  PROTECTED SECTION.
*"* protected components of class LCL_EXCEL_GRAPH_PIE
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_graph_pie===========ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_GRAPH_PIE
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_GRAPH_PIE definition
*class-pool .
*"* class pool for class LCL_EXCEL_HYPERLINK

*"* local type definitions
*include Lcl_excel_hyperlink===========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_HYPERLINK definition
*"* public declarations
*include Lcl_excel_hyperlink===========cu.
CLASS Lcl_excel_hyperlink DEFINITION
*public
  FINAL
  CREATE PRIVATE .

*"* public components of class LCL_EXCEL_HYPERLINK
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CLASS-METHODS create_external_link
      IMPORTING
        !iv_url        TYPE string
      RETURNING
        VALUE(ov_link) TYPE REF TO Lcl_excel_hyperlink .
    CLASS-METHODS create_internal_link
      IMPORTING
        !iv_location   TYPE string
      RETURNING
        VALUE(ov_link) TYPE REF TO Lcl_excel_hyperlink .
    METHODS is_internal
      RETURNING
        VALUE(ev_ret) TYPE abap_bool .
    METHODS set_cell_reference
      IMPORTING
        !ip_column TYPE simple
        !ip_row    TYPE zexcel_cell_row
      RAISING
        Lcx_excel .
    METHODS get_ref
      RETURNING
        VALUE(ev_ref) TYPE string .
    METHODS get_url
      RETURNING
        VALUE(ev_url) TYPE string .
*"* protected components of class LCL_EXCEL_HYPERLINK
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_hyperlink===========co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_HYPERLINK
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_hyperlink===========ci.
  PRIVATE SECTION.

    DATA location TYPE string .
    DATA cell_reference TYPE string .
    DATA internal TYPE abap_bool .
    DATA column TYPE zexcel_cell_column_alpha .
    DATA row TYPE zexcel_cell_row .

    CLASS-METHODS create
      IMPORTING
        !iv_url        TYPE string
        !iv_internal   TYPE abap_bool
      RETURNING
        VALUE(ov_link) TYPE REF TO Lcl_excel_hyperlink .
endclass. "LCL_EXCEL_HYPERLINK definition
*class-pool .
*"* class pool for class LCL_EXCEL_LEGACY_PALETTE

*"* local type definitions
*include Lcl_excel_legacy_palette======ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_LEGACY_PALETTE definition
*"* public declarations
*include Lcl_excel_legacy_palette======cu.
CLASS Lcl_excel_legacy_palette DEFINITION
*public
  CREATE PUBLIC .

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_LEGACY_PALETTE
*"* do not include other source files here!!!

    METHODS constructor .
    METHODS is_modified
      RETURNING
        VALUE(ep_modified) TYPE abap_bool .
    METHODS get_color
      IMPORTING
        !ip_index       TYPE i
      RETURNING
        VALUE(ep_color) TYPE zexcel_style_color_argb
      RAISING
        Lcx_excel .
    METHODS get_colors
      RETURNING
        VALUE(ep_colors) TYPE zexcel_t_style_color_argb .
    METHODS set_color
      IMPORTING
        !ip_index TYPE i
        !ip_color TYPE zexcel_style_color_argb
      RAISING
        Lcx_excel .
*"* protected declarations
*include Lcl_excel_legacy_palette======co.
  PROTECTED SECTION.
*"* protected components of class LCL_EXCEL_LEGACY_PALETTE
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_legacy_palette======ci.
  PRIVATE SECTION.

*"* private components of class LCL_EXCEL_LEGACY_PALETTE
*"* do not include other source files here!!!
    DATA modified TYPE abap_bool VALUE abap_false. "#EC NOTEXT .  .  .  .  .  .  .  .  .  . " .
    DATA colors TYPE zexcel_t_style_color_argb .
endclass. "LCL_EXCEL_LEGACY_PALETTE definition
*class-pool .
*"* class pool for class LCL_EXCEL_RANGE

*"* local type definitions
*include Lcl_excel_range===============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_RANGE definition
*"* public declarations
*include Lcl_excel_range===============cu.
CLASS Lcl_excel_range DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_RANGE
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CONSTANTS gcv_print_title_name TYPE string VALUE '_xlnm.Print_Titles'. "#EC NOTEXT
    DATA name TYPE zexcel_range_name .
    DATA guid TYPE zexcel_range_guid .

    METHODS get_guid
      RETURNING
        VALUE(ep_guid) TYPE zexcel_range_guid .
    METHODS set_value
      IMPORTING
        !ip_sheet_name   TYPE zexcel_sheet_title
        !ip_start_row    TYPE zexcel_cell_row
        !ip_start_column TYPE zexcel_cell_column_alpha
        !ip_stop_row     TYPE zexcel_cell_row
        !ip_stop_column  TYPE zexcel_cell_column_alpha .
    METHODS get_value
      RETURNING
        VALUE(ep_value) TYPE zexcel_range_value .
    METHODS set_range_value
      IMPORTING
        !ip_value TYPE zexcel_range_value .
*"* protected components of class ZABAP_EXCEL_WORKSHEET
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_range===============co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_RANGE
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_range===============ci.
  PRIVATE SECTION.

    DATA value TYPE zexcel_range_value .
endclass. "LCL_EXCEL_RANGE definition
*class-pool .
*"* class pool for class LCL_EXCEL_READER_2007

*"* local type definitions
*include Lcl_excel_reader_2007=========ccdef.
*"* use this source file for any type declarations (class
*"* definitions, interfaces or data types) you need for method
*"* implementation or private method's signature

*
CLASS SHRITEFUH64VYIPN5I4UIDBJAATSE4 DEFINITION ABSTRACT.
  PUBLIC SECTION.
    METHODS read ABSTRACT
      IMPORTING i_filename       TYPE csequence
      RETURNING VALUE(r_content) TYPE xstring " Remember copy-on-write!
      RAISING   Lcx_excel.
ENDCLASS.

*"* class LCL_EXCEL_READER_2007 definition
*"* public declarations
*include Lcl_excel_reader_2007=========cu.
CLASS Lcl_excel_reader_2007 DEFINITION
*public
  CREATE PUBLIC


.

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_READER_2007
*"* do not include other source files here!!!

    INTERFACES Lif_excel_reader .

    CLASS-METHODS fill_struct_from_attributes
      IMPORTING
        !ip_element   TYPE REF TO if_ixml_element
      CHANGING
        !cp_structure TYPE any .
*"* protected declarations
*include Lcl_excel_reader_2007=========co.
  PROTECTED SECTION.

    TYPES:
*"* protected components of class LCL_EXCEL_READER_2007
*"* do not include other source files here!!!
      BEGIN OF t_relationship,
        id           TYPE string,
        type         TYPE string,
        target       TYPE string,
        targetmode   TYPE string,
        worksheet    TYPE REF TO Lcl_excel_worksheet,
        sheetid      TYPE string,     "ins #235 - repeat rows/cols - needed to identify correct sheet
        localsheetid TYPE string,
      END OF t_relationship .
    TYPES:
      BEGIN OF t_fileversion,
        appname      TYPE string,
        lastedited   TYPE string,
        lowestedited TYPE string,
        rupbuild     TYPE string,
        codename     TYPE string,
      END OF t_fileversion .
    TYPES:
      BEGIN OF t_sheet,
        name    TYPE string,
        sheetid TYPE string,
        id      TYPE string,
        state   TYPE string,
      END OF t_sheet .
    TYPES:
      BEGIN OF t_workbookpr,
        codename            TYPE string,
        defaultthemeversion TYPE string,
      END OF t_workbookpr .
    TYPES:
      BEGIN OF t_sheetpr,
        codename TYPE string,
      END OF t_sheetpr .
    TYPES:
      BEGIN OF t_range,
        name         TYPE string,
        hidden       TYPE string,       "inserted with issue #235 because Autofilters didn't passthrough
        localsheetid TYPE string,       " issue #163
      END OF t_range .
    TYPES:
      t_fills   TYPE STANDARD TABLE OF REF TO Lcl_excel_style_fill WITH NON-UNIQUE DEFAULT KEY .
    TYPES:
      t_borders TYPE STANDARD TABLE OF REF TO Lcl_excel_style_borders WITH NON-UNIQUE DEFAULT KEY .
    TYPES:
      t_fonts   TYPE STANDARD TABLE OF REF TO Lcl_excel_style_font WITH NON-UNIQUE DEFAULT KEY .
    TYPES:
      t_style_refs TYPE STANDARD TABLE OF REF TO Lcl_excel_style WITH NON-UNIQUE DEFAULT KEY .
    TYPES:
      BEGIN OF t_color,
        indexed TYPE string,
        rgb     TYPE string,
        theme   TYPE string,
        tint    TYPE string,
      END OF t_color .
    TYPES:
      BEGIN OF t_rel_drawing,
        id          TYPE string,
        content     TYPE xstring,
        file_ext    TYPE string,
        content_xml TYPE REF TO if_ixml_document,
      END OF t_rel_drawing .
    TYPES:
      t_rel_drawings TYPE STANDARD TABLE OF t_rel_drawing WITH NON-UNIQUE DEFAULT KEY .
    TYPES:
      BEGIN OF gts_external_hyperlink,
        id     TYPE string,
        target TYPE string,
      END OF gts_external_hyperlink .
    TYPES:
      gtt_external_hyperlinks TYPE HASHED TABLE OF gts_external_hyperlink WITH UNIQUE KEY id .
    TYPES:
      BEGIN OF ty_ref_formulae,
        sheet   TYPE REF TO Lcl_excel_worksheet,
        row     TYPE i,
        column  TYPE i,
        si      TYPE i,
        ref     TYPE string,
        formula TYPE string,
      END   OF ty_ref_formulae .
    TYPES:
      tyt_ref_formulae TYPE HASHED TABLE OF ty_ref_formulae WITH UNIQUE KEY sheet row column .
    TYPES:
      BEGIN OF t_shared_string,
        value TYPE string,
        rtf   TYPE zexcel_t_rtf,
      END OF t_shared_string .
    TYPES:
      t_shared_strings TYPE STANDARD TABLE OF t_shared_string WITH DEFAULT KEY .
    TYPES:
      BEGIN OF t_table,
        id     TYPE string,
        target TYPE string,
      END OF t_table .
    TYPES:
      t_tables TYPE HASHED TABLE OF t_table WITH UNIQUE KEY id .

    DATA shared_strings TYPE t_shared_strings .
    DATA styles TYPE t_style_refs .
    DATA mt_ref_formulae TYPE tyt_ref_formulae .
    DATA mt_dxf_styles TYPE zexcel_t_styles_cond_mapping .

    METHODS fill_row_outlines
      IMPORTING
        !io_worksheet TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS get_from_zip_archive
      IMPORTING
        !i_filename      TYPE string
      RETURNING
        VALUE(r_content) TYPE xstring
      RAISING
        Lcx_excel .
    METHODS get_ixml_from_zip_archive
      IMPORTING
        !i_filename     TYPE string
        !is_normalizing TYPE abap_bool DEFAULT 'X'
      RETURNING
        VALUE(r_ixml)   TYPE REF TO if_ixml_document
      RAISING
        Lcx_excel .
    METHODS load_drawing_anchor
      IMPORTING
        !io_anchor_element   TYPE REF TO if_ixml_element
        !io_worksheet        TYPE REF TO Lcl_excel_worksheet
        !it_related_drawings TYPE t_rel_drawings .
    METHODS load_shared_strings
      IMPORTING
        !ip_path TYPE string
      RAISING
        Lcx_excel .
    METHODS load_styles
      IMPORTING
        !ip_path  TYPE string
        !ip_excel TYPE REF TO Lcl_excel
      RAISING
        Lcx_excel .
    METHODS load_dxf_styles
      IMPORTING
        !iv_path  TYPE string
        !io_excel TYPE REF TO Lcl_excel
      RAISING
        Lcx_excel .
    METHODS load_style_borders
      IMPORTING
        !ip_xml           TYPE REF TO if_ixml_document
      RETURNING
        VALUE(ep_borders) TYPE t_borders .
    METHODS load_style_fills
      IMPORTING
        !ip_xml         TYPE REF TO if_ixml_document
      RETURNING
        VALUE(ep_fills) TYPE t_fills .
    METHODS load_style_font
      IMPORTING
        !io_xml_element TYPE REF TO if_ixml_element
      RETURNING
        VALUE(ro_font)  TYPE REF TO Lcl_excel_style_font .
    METHODS load_style_fonts
      IMPORTING
        !ip_xml         TYPE REF TO if_ixml_document
      RETURNING
        VALUE(ep_fonts) TYPE t_fonts .
    METHODS load_style_num_formats
      IMPORTING
        !ip_xml               TYPE REF TO if_ixml_document
      RETURNING
        VALUE(ep_num_formats) TYPE Lcl_excel_style_number_format=>t_num_formats .
    METHODS load_workbook
      IMPORTING
        !iv_workbook_full_filename TYPE string
        !io_excel                  TYPE REF TO Lcl_excel
      RAISING
        Lcx_excel .
    METHODS load_worksheet
      IMPORTING
        !ip_path      TYPE string
        !io_worksheet TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS load_worksheet_cond_format
      IMPORTING
        !io_ixml_worksheet TYPE REF TO if_ixml_document
        !io_worksheet      TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS load_worksheet_cond_format_aa
      IMPORTING
        !io_ixml_rule  TYPE REF TO if_ixml_element
        !io_style_cond TYPE REF TO Lcl_excel_style_cond.
    METHODS load_worksheet_cond_format_ci
      IMPORTING
        !io_ixml_rule  TYPE REF TO if_ixml_element
        !io_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS load_worksheet_cond_format_cs
      IMPORTING
        !io_ixml_rule  TYPE REF TO if_ixml_element
        !io_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS load_worksheet_cond_format_ex
      IMPORTING
        !io_ixml_rule  TYPE REF TO if_ixml_element
        !io_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS load_worksheet_cond_format_is
      IMPORTING
        !io_ixml_rule  TYPE REF TO if_ixml_element
        !io_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS load_worksheet_cond_format_db
      IMPORTING
        !io_ixml_rule  TYPE REF TO if_ixml_element
        !io_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS load_worksheet_cond_format_t10
      IMPORTING
        !io_ixml_rule  TYPE REF TO if_ixml_element
        !io_style_cond TYPE REF TO Lcl_excel_style_cond .
    METHODS load_worksheet_drawing
      IMPORTING
        !ip_path      TYPE string
        !io_worksheet TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS load_comments
      IMPORTING
        ip_path      TYPE string
        io_worksheet TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS load_worksheet_hyperlinks
      IMPORTING
        !io_ixml_worksheet      TYPE REF TO if_ixml_document
        !io_worksheet           TYPE REF TO Lcl_excel_worksheet
        !it_external_hyperlinks TYPE gtt_external_hyperlinks
      RAISING
        Lcx_excel .
    METHODS load_worksheet_ignored_errors
      IMPORTING
        !io_ixml_worksheet TYPE REF TO if_ixml_document
        !io_worksheet      TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS load_worksheet_pagebreaks
      IMPORTING
        !io_ixml_worksheet TYPE REF TO if_ixml_document
        !io_worksheet      TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS load_worksheet_autofilter
      IMPORTING
        io_ixml_worksheet TYPE REF TO if_ixml_document
        io_worksheet      TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel.
    METHODS load_worksheet_pagemargins
      IMPORTING
        !io_ixml_worksheet TYPE REF TO if_ixml_document
        !io_worksheet      TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    "! <p class="shorttext synchronized" lang="en">Load worksheet tables</p>
    METHODS load_worksheet_tables
      IMPORTING
        io_ixml_worksheet TYPE REF TO if_ixml_document
        io_worksheet      TYPE REF TO Lcl_excel_worksheet
        iv_dirname        TYPE string
        it_tables         TYPE t_tables
      RAISING
        Lcx_excel .
    CLASS-METHODS resolve_path
      IMPORTING
        !ip_path         TYPE string
      RETURNING
        VALUE(rp_result) TYPE string .
    METHODS resolve_referenced_formulae .
    METHODS unescape_string_value
      IMPORTING
        i_value       TYPE string
      RETURNING
        VALUE(result) TYPE string.
    METHODS get_dxf_style_guid
      IMPORTING
        !io_ixml_dxf         TYPE REF TO if_ixml_element
        !io_excel            TYPE REF TO Lcl_excel
      RETURNING
        VALUE(rv_style_guid) TYPE zexcel_cell_style .
    METHODS load_theme
      IMPORTING
        iv_path   TYPE string
        !ip_excel TYPE REF TO Lcl_excel
      RAISING
        Lcx_excel .

    CONSTANTS: BEGIN OF namespace,
                 x14ac            TYPE string VALUE 'http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac',
                 vba_project      TYPE string VALUE 'http://schemas.microsoft.com/office/2006/relationships/vbaProject', "#EC NEEDED     for future incorporation of XLSM-reader
                 c                TYPE string VALUE 'http://schemas.openxmlformats.org/drawingml/2006/chart',
                 a                TYPE string VALUE 'http://schemas.openxmlformats.org/drawingml/2006/main',
                 xdr              TYPE string VALUE 'http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing',
                 mc               TYPE string VALUE 'http://schemas.openxmlformats.org/markup-compatibility/2006',
                 r                TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships',
                 chart            TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart',
                 drawing          TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing',
                 hyperlink        TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink',
                 image            TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image',
                 office_document  TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument',
                 printer_settings TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/printerSettings',
                 shared_strings   TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings',
                 styles           TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles',
                 theme            TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme',
                 worksheet        TYPE string VALUE 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet',
                 relationships    TYPE string VALUE 'http://schemas.openxmlformats.org/package/2006/relationships',
                 core_properties  TYPE string VALUE 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties',
                 main             TYPE string VALUE 'http://schemas.openxmlformats.org/spreadsheetml/2006/main',
               END OF namespace.

*"* private declarations
*include Lcl_excel_reader_2007=========ci.
  PRIVATE SECTION.

    DATA zip TYPE REF TO SHRITEFUH64VYIPN5I4UIDBJAATSE4 .
    DATA: gid TYPE i.

    METHODS create_zip_archive
      IMPORTING
        !i_xlsx_binary       TYPE xstring
        !i_use_alternate_zip TYPE seoclsname OPTIONAL
      RETURNING
        VALUE(e_zip)         TYPE REF TO SHRITEFUH64VYIPN5I4UIDBJAATSE4
      RAISING
        Lcx_excel .
    METHODS read_from_applserver
      IMPORTING
        !i_filename         TYPE csequence
      RETURNING
        VALUE(r_excel_data) TYPE xstring
      RAISING
        Lcx_excel.
    METHODS read_from_local_file
      IMPORTING
        !i_filename         TYPE csequence
      RETURNING
        VALUE(r_excel_data) TYPE xstring
      RAISING
        Lcx_excel .
endclass. "LCL_EXCEL_READER_2007 definition
*class-pool .
*"* class pool for class LCL_EXCEL_READER_XLSM

*"* local type definitions
*include Lcl_excel_reader_xlsm=========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_READER_XLSM definition
*"* public declarations
*include Lcl_excel_reader_xlsm=========cu.
CLASS Lcl_excel_reader_xlsm DEFINITION
*public
  INHERITING FROM Lcl_excel_reader_2007
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_READER_XLSM
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_reader_xlsm=========co.
  PROTECTED SECTION.

*"* protected components of class LCL_EXCEL_READER_XLSM
*"* do not include other source files here!!!
    METHODS load_workbook
        REDEFINITION .
    METHODS load_worksheet
        REDEFINITION .
*"* private declarations
*include Lcl_excel_reader_xlsm=========ci.
  PRIVATE SECTION.

*"* private components of class LCL_EXCEL_READER_XLSM
*"* do not include other source files here!!!
    METHODS load_vbaproject
      IMPORTING
        !ip_path  TYPE string
        !ip_excel TYPE REF TO Lcl_excel
      RAISING
        Lcx_excel .
endclass. "LCL_EXCEL_READER_XLSM definition
*class-pool .
*"* class pool for class LCL_EXCEL_ROW

*"* local type definitions
*include Lcl_excel_row=================ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_ROW definition
*"* public declarations
*include Lcl_excel_row=================cu.
CLASS Lcl_excel_row DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_ROW
*"* do not include other source files here!!!
  PUBLIC SECTION.

    METHODS constructor
      IMPORTING
        !ip_index TYPE int4 DEFAULT 0 .
    METHODS get_collapsed
      IMPORTING
        !io_worksheet      TYPE REF TO Lcl_excel_worksheet OPTIONAL
      RETURNING
        VALUE(r_collapsed) TYPE abap_bool .
    METHODS get_outline_level
      IMPORTING
        !io_worksheet          TYPE REF TO Lcl_excel_worksheet OPTIONAL
      RETURNING
        VALUE(r_outline_level) TYPE int4 .
    METHODS get_row_height
      RETURNING
        VALUE(r_row_height) TYPE f .
    METHODS get_custom_height
      RETURNING
        VALUE(r_custom_height) TYPE abap_bool .
    METHODS get_row_index
      RETURNING
        VALUE(r_row_index) TYPE int4 .
    METHODS get_visible
      IMPORTING
        !io_worksheet    TYPE REF TO Lcl_excel_worksheet OPTIONAL
      RETURNING
        VALUE(r_visible) TYPE abap_bool .
    METHODS get_xf_index
      RETURNING
        VALUE(r_xf_index) TYPE int4 .
    METHODS set_collapsed
      IMPORTING
        !ip_collapsed TYPE abap_bool .
    METHODS set_outline_level
      IMPORTING
        !ip_outline_level TYPE int4
      RAISING
        Lcx_excel .
    METHODS set_row_height
      IMPORTING
        !ip_row_height    TYPE simple
        !ip_custom_height TYPE abap_bool DEFAULT abap_true
      RAISING
        Lcx_excel .
    METHODS set_row_index
      IMPORTING
        !ip_index TYPE int4 .
    METHODS set_visible
      IMPORTING
        !ip_visible TYPE abap_bool .
    METHODS set_xf_index
      IMPORTING
        !ip_xf_index TYPE int4 .
*"* protected components of class LCL_EXCEL_ROW
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_row=================co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_ROW
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_row=================ci.
  PRIVATE SECTION.

    DATA row_index TYPE int4 .
    DATA row_height TYPE f .
    DATA visible TYPE abap_bool .
    DATA outline_level TYPE int4 VALUE 0. "#EC NOTEXT .  .  .  .  .  .  .  .  . " .
    DATA collapsed TYPE abap_bool .
    DATA xf_index TYPE int4 .
    DATA custom_height TYPE abap_bool .
endclass. "LCL_EXCEL_ROW definition
*class-pool .
*"* class pool for class LCL_EXCEL_ROWS

*"* local type definitions
*include Lcl_excel_rows================ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_ROWS definition
*"* public declarations
*include Lcl_excel_rows================cu.
*----------------------------------------------------------------------*
*       CLASS LCL_EXCEL_ROWS DEFINITION
*----------------------------------------------------------------------*
*
*----------------------------------------------------------------------*
CLASS Lcl_excel_rows DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_ROWS
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_WORKSHEETS
*"* do not include other source files here!!!
  PUBLIC SECTION.
    METHODS add
      IMPORTING
        !io_row TYPE REF TO Lcl_excel_row .
    METHODS clear .
    METHODS constructor .
    METHODS get
      IMPORTING
        !ip_index     TYPE i
      RETURNING
        VALUE(eo_row) TYPE REF TO Lcl_excel_row .
    METHODS get_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS is_empty
      RETURNING
        VALUE(is_empty) TYPE flag .
    METHODS remove
      IMPORTING
        !io_row TYPE REF TO Lcl_excel_row .
    METHODS size
      RETURNING
        VALUE(ep_size) TYPE i .
    METHODS get_min_index
      RETURNING
        VALUE(ep_index) TYPE i .
    METHODS get_max_index
      RETURNING
        VALUE(ep_index) TYPE i .
*"* protected declarations
*include Lcl_excel_rows================co.
  PROTECTED SECTION.
*"* private components of class ZABAP_EXCEL_RANGES
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_rows================ci.
  PRIVATE SECTION.
    TYPES:
      BEGIN OF mty_s_hashed_row,
        row_index TYPE int4,
        row       TYPE REF TO Lcl_excel_row,
      END OF mty_s_hashed_row ,
      mty_ts_hashed_row TYPE HASHED TABLE OF mty_s_hashed_row WITH UNIQUE KEY row_index.

    DATA rows TYPE REF TO Lcl_excel_collection .
    DATA rows_hashed TYPE mty_ts_hashed_row .

endclass. "LCL_EXCEL_ROWS definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_COND

*"* local type definitions
*include Lcl_excel_style_cond==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_COND definition
*"* public declarations
*include Lcl_excel_style_cond==========cu.
CLASS Lcl_excel_style_cond DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
    CLASS Lcl_excel_style_conditional DEFINITION LOAD .

*"* public components of class LCL_EXCEL_STYLE_COND
*"* do not include other source files here!!!
    TYPES tv_conditional_show_value TYPE c LENGTH 1.
    TYPES tv_textfunction TYPE string.
    TYPES: BEGIN OF ts_conditional_textfunction,
             text         TYPE string,
             textfunction TYPE tv_textfunction,
             cell_style   TYPE zexcel_cell_style,
           END OF ts_conditional_textfunction.
    CONSTANTS c_cfvo_type_formula TYPE zexcel_conditional_type VALUE 'formula'. "#EC NOTEXT
    CONSTANTS c_cfvo_type_max TYPE zexcel_conditional_type VALUE 'max'. "#EC NOTEXT
    CONSTANTS c_cfvo_type_min TYPE zexcel_conditional_type VALUE 'min'. "#EC NOTEXT
    CONSTANTS c_cfvo_type_number TYPE zexcel_conditional_type VALUE 'num'. "#EC NOTEXT
    CONSTANTS c_cfvo_type_percent TYPE zexcel_conditional_type VALUE 'percent'. "#EC NOTEXT
    CONSTANTS c_cfvo_type_percentile TYPE zexcel_conditional_type VALUE 'percentile'. "#EC NOTEXT
    CONSTANTS c_iconset_3arrows TYPE zexcel_condition_rule_iconset VALUE '3Arrows'. "#EC NOTEXT
    CONSTANTS c_iconset_3arrowsgray TYPE zexcel_condition_rule_iconset VALUE '3ArrowsGray'. "#EC NOTEXT
    CONSTANTS c_iconset_3flags TYPE zexcel_condition_rule_iconset VALUE '3Flags'. "#EC NOTEXT
    CONSTANTS c_iconset_3signs TYPE zexcel_condition_rule_iconset VALUE '3Signs'. "#EC NOTEXT
    CONSTANTS c_iconset_3symbols TYPE zexcel_condition_rule_iconset VALUE '3Symbols'. "#EC NOTEXT
    CONSTANTS c_iconset_3symbols2 TYPE zexcel_condition_rule_iconset VALUE '3Symbols2'. "#EC NOTEXT
    CONSTANTS c_iconset_3trafficlights TYPE zexcel_condition_rule_iconset VALUE ''. "#EC NOTEXT
    CONSTANTS c_iconset_3trafficlights2 TYPE zexcel_condition_rule_iconset VALUE '3TrafficLights2'. "#EC NOTEXT
    CONSTANTS c_iconset_4arrows TYPE zexcel_condition_rule_iconset VALUE '4Arrows'. "#EC NOTEXT
    CONSTANTS c_iconset_4arrowsgray TYPE zexcel_condition_rule_iconset VALUE '4ArrowsGray'. "#EC NOTEXT
    CONSTANTS c_iconset_4rating TYPE zexcel_condition_rule_iconset VALUE '4Rating'. "#EC NOTEXT
    CONSTANTS c_iconset_4redtoblack TYPE zexcel_condition_rule_iconset VALUE '4RedToBlack'. "#EC NOTEXT
    CONSTANTS c_iconset_4trafficlights TYPE zexcel_condition_rule_iconset VALUE '4TrafficLights'. "#EC NOTEXT
    CONSTANTS c_iconset_5arrows TYPE zexcel_condition_rule_iconset VALUE '5Arrows'. "#EC NOTEXT
    CONSTANTS c_iconset_5arrowsgray TYPE zexcel_condition_rule_iconset VALUE '5ArrowsGray'. "#EC NOTEXT
    CONSTANTS c_iconset_5quarters TYPE zexcel_condition_rule_iconset VALUE '5Quarters'. "#EC NOTEXT
    CONSTANTS c_iconset_5rating TYPE zexcel_condition_rule_iconset VALUE '5Rating'. "#EC NOTEXT
    CONSTANTS c_operator_beginswith TYPE zexcel_condition_operator VALUE 'beginsWith'. "#EC NOTEXT
    CONSTANTS c_operator_between TYPE zexcel_condition_operator VALUE 'between'. "#EC NOTEXT
    CONSTANTS c_operator_containstext TYPE zexcel_condition_operator VALUE 'containsText'. "#EC NOTEXT
    CONSTANTS c_operator_endswith TYPE zexcel_condition_operator VALUE 'endsWith'. "#EC NOTEXT
    CONSTANTS c_operator_equal TYPE zexcel_condition_operator VALUE 'equal'. "#EC NOTEXT
    CONSTANTS c_operator_greaterthan TYPE zexcel_condition_operator VALUE 'greaterThan'. "#EC NOTEXT
    CONSTANTS c_operator_greaterthanorequal TYPE zexcel_condition_operator VALUE 'greaterThanOrEqual'. "#EC NOTEXT
    CONSTANTS c_operator_lessthan TYPE zexcel_condition_operator VALUE 'lessThan'. "#EC NOTEXT
    CONSTANTS c_operator_lessthanorequal TYPE zexcel_condition_operator VALUE 'lessThanOrEqual'. "#EC NOTEXT
    CONSTANTS c_operator_none TYPE zexcel_condition_operator VALUE ''. "#EC NOTEXT
    CONSTANTS c_operator_notcontains TYPE zexcel_condition_operator VALUE 'notContains'. "#EC NOTEXT
    CONSTANTS c_operator_notequal TYPE zexcel_condition_operator VALUE 'notEqual'. "#EC NOTEXT
    CONSTANTS c_textfunction_beginswith TYPE tv_textfunction VALUE 'beginsWith'. "#EC NOTEXT
    CONSTANTS c_textfunction_containstext TYPE tv_textfunction VALUE 'containsText'. "#EC NOTEXT
    CONSTANTS c_textfunction_endswith TYPE tv_textfunction VALUE 'endsWith'. "#EC NOTEXT
    CONSTANTS c_textfunction_notcontains TYPE tv_textfunction VALUE 'notContains'. "#EC NOTEXT
    CONSTANTS c_rule_cellis TYPE zexcel_condition_rule VALUE 'cellIs'. "#EC NOTEXT
    CONSTANTS c_rule_containstext TYPE zexcel_condition_rule VALUE 'containsText'. "#EC NOTEXT
    CONSTANTS c_rule_databar TYPE zexcel_condition_rule VALUE 'dataBar'. "#EC NOTEXT
    CONSTANTS c_rule_expression TYPE zexcel_condition_rule VALUE 'expression'. "#EC NOTEXT
    CONSTANTS c_rule_iconset TYPE zexcel_condition_rule VALUE 'iconSet'. "#EC NOTEXT
    CONSTANTS c_rule_colorscale TYPE zexcel_condition_rule VALUE 'colorScale'. "#EC NOTEXT
    CONSTANTS c_rule_none TYPE zexcel_condition_rule VALUE 'none'. "#EC NOTEXT
    CONSTANTS c_rule_textfunction TYPE zexcel_condition_rule VALUE '<textfunction>'. "#EC NOTEXT
    CONSTANTS c_rule_top10 TYPE zexcel_condition_rule VALUE 'top10'. "#EC NOTEXT
    CONSTANTS c_rule_above_average TYPE zexcel_condition_rule VALUE 'aboveAverage'. "#EC NOTEXT
    CONSTANTS c_showvalue_false TYPE tv_conditional_show_value VALUE 0. "#EC NOTEXT
    CONSTANTS c_showvalue_true TYPE tv_conditional_show_value VALUE 1. "#EC NOTEXT
    DATA mode_cellis TYPE zexcel_conditional_cellis .
    DATA mode_textfunction TYPE ts_conditional_textfunction .
    DATA mode_colorscale TYPE zexcel_conditional_colorscale .
    DATA mode_databar TYPE zexcel_conditional_databar .
    DATA mode_expression TYPE zexcel_conditional_expression .
    DATA mode_iconset TYPE zexcel_conditional_iconset .
    DATA mode_top10 TYPE zexcel_conditional_top10 .
    DATA mode_above_average TYPE zexcel_conditional_above_avg .
    DATA priority TYPE zexcel_style_priority VALUE 1. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA rule TYPE zexcel_condition_rule .

    METHODS constructor
      IMPORTING
        !ip_guid            TYPE zexcel_cell_style OPTIONAL
        !ip_dimension_range TYPE string.
    METHODS get_dimension_range
      RETURNING
        VALUE(ep_dimension_range) TYPE string .
    METHODS set_range
      IMPORTING
        !ip_start_row    TYPE zexcel_cell_row
        !ip_start_column TYPE zexcel_cell_column_alpha
        !ip_stop_row     TYPE zexcel_cell_row
        !ip_stop_column  TYPE zexcel_cell_column_alpha
      RAISING
        Lcx_excel .
    METHODS add_range
      IMPORTING
        !ip_start_row    TYPE zexcel_cell_row
        !ip_start_column TYPE zexcel_cell_column_alpha
        !ip_stop_row     TYPE zexcel_cell_row
        !ip_stop_column  TYPE zexcel_cell_column_alpha
      RAISING
        Lcx_excel .
    CLASS-METHODS factory_cond_style_iconset
      IMPORTING
        !io_worksheet        TYPE REF TO Lcl_excel_worksheet
        !iv_icon_type        TYPE zexcel_condition_rule_iconset DEFAULT c_iconset_3trafficlights2
        !iv_cfvo1_type       TYPE zexcel_conditional_type DEFAULT c_cfvo_type_percent
        !iv_cfvo1_value      TYPE zexcel_conditional_value OPTIONAL
        !iv_cfvo2_type       TYPE zexcel_conditional_type DEFAULT c_cfvo_type_percent
        !iv_cfvo2_value      TYPE zexcel_conditional_value OPTIONAL
        !iv_cfvo3_type       TYPE zexcel_conditional_type DEFAULT c_cfvo_type_percent
        !iv_cfvo3_value      TYPE zexcel_conditional_value OPTIONAL
        !iv_cfvo4_type       TYPE zexcel_conditional_type DEFAULT c_cfvo_type_percent
        !iv_cfvo4_value      TYPE zexcel_conditional_value OPTIONAL
        !iv_cfvo5_type       TYPE zexcel_conditional_type DEFAULT c_cfvo_type_percent
        !iv_cfvo5_value      TYPE zexcel_conditional_value OPTIONAL
        !iv_showvalue        TYPE tv_conditional_show_value DEFAULT Lcl_excel_style_cond=>c_showvalue_true
      RETURNING
        VALUE(eo_style_cond) TYPE REF TO Lcl_excel_style_cond .
    METHODS get_guid
      RETURNING
        VALUE(ep_guid) TYPE zexcel_cell_style .
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected components of class ZABAP_EXCEL_STYLE_FONT
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_style_cond==========co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_style_cond==========ci.
  PRIVATE SECTION.

    DATA mv_rule_range TYPE string .
    DATA guid TYPE zexcel_cell_style .
endclass. "LCL_EXCEL_STYLE_COND definition
*class-pool .
*"* class pool for class LCL_EXCEL_TABLE

*"* local type definitions
*include Lcl_excel_table===============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_TABLE definition
*"* public declarations
*include Lcl_excel_table===============cu.
CLASS Lcl_excel_table DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_TABLE
*"* do not include other source files here!!!
  PUBLIC SECTION.

    CONSTANTS builtinstyle_dark1 TYPE zexcel_table_style VALUE 'TableStyleDark1'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark2 TYPE zexcel_table_style VALUE 'TableStyleDark2'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark3 TYPE zexcel_table_style VALUE 'TableStyleDark3'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark4 TYPE zexcel_table_style VALUE 'TableStyleDark4'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark5 TYPE zexcel_table_style VALUE 'TableStyleDark5'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark6 TYPE zexcel_table_style VALUE 'TableStyleDark6'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark7 TYPE zexcel_table_style VALUE 'TableStyleDark7'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark8 TYPE zexcel_table_style VALUE 'TableStyleDark8'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark9 TYPE zexcel_table_style VALUE 'TableStyleDark9'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark10 TYPE zexcel_table_style VALUE 'TableStyleDark10'. "#EC NOTEXT
    CONSTANTS builtinstyle_dark11 TYPE zexcel_table_style VALUE 'TableStyleDark11'. "#EC NOTEXT
    CONSTANTS builtinstyle_light1 TYPE zexcel_table_style VALUE 'TableStyleLight1'. "#EC NOTEXT
    CONSTANTS builtinstyle_light2 TYPE zexcel_table_style VALUE 'TableStyleLight2'. "#EC NOTEXT
    CONSTANTS builtinstyle_light3 TYPE zexcel_table_style VALUE 'TableStyleLight3'. "#EC NOTEXT
    CONSTANTS builtinstyle_light4 TYPE zexcel_table_style VALUE 'TableStyleLight4'. "#EC NOTEXT
    CONSTANTS builtinstyle_light5 TYPE zexcel_table_style VALUE 'TableStyleLight5'. "#EC NOTEXT
    CONSTANTS builtinstyle_pivot_light16 TYPE zexcel_table_style VALUE 'PivotStyleLight16'. "#EC NOTEXT
    CONSTANTS builtinstyle_light6 TYPE zexcel_table_style VALUE 'TableStyleLight6'. "#EC NOTEXT
    CONSTANTS totals_function_average TYPE zexcel_table_totals_function VALUE 'average'. "#EC NOTEXT
    CONSTANTS builtinstyle_light7 TYPE zexcel_table_style VALUE 'TableStyleLight7'. "#EC NOTEXT
    CONSTANTS totals_function_count TYPE zexcel_table_totals_function VALUE 'count'. "#EC NOTEXT
    CONSTANTS builtinstyle_light8 TYPE zexcel_table_style VALUE 'TableStyleLight8'. "#EC NOTEXT
    CONSTANTS totals_function_custom TYPE zexcel_table_totals_function VALUE 'custom'. "#EC NOTEXT
    CONSTANTS builtinstyle_light9 TYPE zexcel_table_style VALUE 'TableStyleLight9'. "#EC NOTEXT
    CONSTANTS totals_function_max TYPE zexcel_table_totals_function VALUE 'max'. "#EC NOTEXT
    CONSTANTS builtinstyle_light10 TYPE zexcel_table_style VALUE 'TableStyleLight10'. "#EC NOTEXT
    CONSTANTS totals_function_min TYPE zexcel_table_totals_function VALUE 'min'. "#EC NOTEXT
    CONSTANTS builtinstyle_light11 TYPE zexcel_table_style VALUE 'TableStyleLight11'. "#EC NOTEXT
    CONSTANTS totals_function_sum TYPE zexcel_table_totals_function VALUE 'sum'. "#EC NOTEXT
    CONSTANTS builtinstyle_light12 TYPE zexcel_table_style VALUE 'TableStyleLight12'. "#EC NOTEXT
    DATA fieldcat TYPE zexcel_t_fieldcatalog .
    CONSTANTS builtinstyle_light13 TYPE zexcel_table_style VALUE 'TableStyleLight13'. "#EC NOTEXT
    CONSTANTS builtinstyle_light14 TYPE zexcel_table_style VALUE 'TableStyleLight14'. "#EC NOTEXT
    DATA settings TYPE zexcel_s_table_settings .
    CONSTANTS builtinstyle_light15 TYPE zexcel_table_style VALUE 'TableStyleLight15'. "#EC NOTEXT
    CONSTANTS builtinstyle_light16 TYPE zexcel_table_style VALUE 'TableStyleLight16'. "#EC NOTEXT
    CONSTANTS builtinstyle_light17 TYPE zexcel_table_style VALUE 'TableStyleLight17'. "#EC NOTEXT
    CONSTANTS builtinstyle_light18 TYPE zexcel_table_style VALUE 'TableStyleLight18'. "#EC NOTEXT
    CONSTANTS builtinstyle_light19 TYPE zexcel_table_style VALUE 'TableStyleLight19'. "#EC NOTEXT
    CONSTANTS builtinstyle_light20 TYPE zexcel_table_style VALUE 'TableStyleLight20'. "#EC NOTEXT
    CONSTANTS builtinstyle_light21 TYPE zexcel_table_style VALUE 'TableStyleLight21'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium1 TYPE zexcel_table_style VALUE 'TableStyleMedium1'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium2 TYPE zexcel_table_style VALUE 'TableStyleMedium2'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium3 TYPE zexcel_table_style VALUE 'TableStyleMedium3'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium4 TYPE zexcel_table_style VALUE 'TableStyleMedium4'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium5 TYPE zexcel_table_style VALUE 'TableStyleMedium5'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium6 TYPE zexcel_table_style VALUE 'TableStyleMedium6'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium7 TYPE zexcel_table_style VALUE 'TableStyleMedium7'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium8 TYPE zexcel_table_style VALUE 'TableStyleMedium8'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium9 TYPE zexcel_table_style VALUE 'TableStyleMedium9'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium10 TYPE zexcel_table_style VALUE 'TableStyleMedium10'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium11 TYPE zexcel_table_style VALUE 'TableStyleMedium11'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium12 TYPE zexcel_table_style VALUE 'TableStyleMedium12'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium13 TYPE zexcel_table_style VALUE 'TableStyleMedium13'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium14 TYPE zexcel_table_style VALUE 'TableStyleMedium14'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium15 TYPE zexcel_table_style VALUE 'TableStyleMedium15'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium16 TYPE zexcel_table_style VALUE 'TableStyleMedium16'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium17 TYPE zexcel_table_style VALUE 'TableStyleMedium17'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium18 TYPE zexcel_table_style VALUE 'TableStyleMedium18'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium19 TYPE zexcel_table_style VALUE 'TableStyleMedium19'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium20 TYPE zexcel_table_style VALUE 'TableStyleMedium20'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium21 TYPE zexcel_table_style VALUE 'TableStyleMedium21'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium22 TYPE zexcel_table_style VALUE 'TableStyleMedium22'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium23 TYPE zexcel_table_style VALUE 'TableStyleMedium23'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium24 TYPE zexcel_table_style VALUE 'TableStyleMedium24'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium25 TYPE zexcel_table_style VALUE 'TableStyleMedium26'. "#EC NOTEXT
    CONSTANTS builtinstyle_medium27 TYPE zexcel_table_style VALUE 'TableStyleMedium27'. "#EC NOTEXT

    METHODS get_totals_formula
      IMPORTING
        !ip_column        TYPE clike
        !ip_function      TYPE zexcel_table_totals_function
      RETURNING
        VALUE(ep_formula) TYPE string
      RAISING
        Lcx_excel .
    METHODS has_totals
      RETURNING
        VALUE(ep_result) TYPE abap_bool .
    METHODS set_data
      IMPORTING
        !ir_data TYPE STANDARD TABLE .
    METHODS get_id
      RETURNING
        VALUE(ov_id) TYPE i .
    METHODS set_id
      IMPORTING
        !iv_id TYPE i .
    METHODS get_name
      RETURNING
        VALUE(ov_name) TYPE string .
    METHODS get_reference
      IMPORTING
        !ip_include_totals_row TYPE abap_bool DEFAULT abap_true
      RETURNING
        VALUE(ov_reference)    TYPE string
      RAISING
        Lcx_excel .
    METHODS get_bottom_row_integer
      RETURNING
        VALUE(ev_row) TYPE i .
    METHODS get_right_column_integer
      RETURNING
        VALUE(ev_column) TYPE i
      RAISING
        Lcx_excel .
*"* protected components of class LCL_EXCEL_TABLE
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_TABLE
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_TABLE
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_table===============co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_table===============ci.
  PRIVATE SECTION.

    DATA id TYPE i .
    DATA name TYPE string .
    DATA table_data TYPE REF TO data .
    DATA builtinstyle_medium28 TYPE zexcel_table_style VALUE 'TableStyleMedium28'. "#EC NOTEXT .  .  . " .
endclass. "LCL_EXCEL_TABLE definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME

*"* local type definitions
*include Lcl_excel_theme===============ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME definition
*"* public declarations
*include Lcl_excel_theme===============cu.
CLASS Lcl_excel_theme DEFINITION
*public
  CREATE PUBLIC .

  PUBLIC SECTION.

    CONSTANTS c_theme_elements TYPE string VALUE 'themeElements'. "#EC NOTEXT
    CONSTANTS c_theme_object_def TYPE string VALUE 'objectDefaults'. "#EC NOTEXT
    CONSTANTS c_theme_extra_color TYPE string VALUE 'extraClrSchemeLst'. "#EC NOTEXT
    CONSTANTS c_theme_extlst TYPE string VALUE 'extLst'.    "#EC NOTEXT
    CONSTANTS c_theme TYPE string VALUE 'theme'.            "#EC NOTEXT
    CONSTANTS c_theme_name TYPE string VALUE 'name'.        "#EC NOTEXT
    CONSTANTS c_theme_xmlns TYPE string VALUE 'xmlns:a'.    "#EC NOTEXT
    CONSTANTS c_theme_prefix TYPE string VALUE 'a'.         "#EC NOTEXT
    CONSTANTS c_theme_prefix_write TYPE string VALUE 'a:'.  "#EC NOTEXT
    CONSTANTS c_theme_xmlns_val TYPE string VALUE 'http://schemas.openxmlformats.org/drawingml/2006/main'. "#EC NOTEXT

    METHODS constructor .
    METHODS read_theme
      IMPORTING
        VALUE(io_theme_xml) TYPE REF TO if_ixml_document .
    METHODS write_theme
      RETURNING
        VALUE(rv_xstring) TYPE xstring .
    METHODS set_color
      IMPORTING
        VALUE(iv_type)         TYPE string
        VALUE(iv_srgb)         TYPE Lcl_excel_theme_color_scheme=>t_srgb OPTIONAL
        VALUE(iv_syscolorname) TYPE string OPTIONAL
        VALUE(iv_syscolorlast) TYPE Lcl_excel_theme_color_scheme=>t_srgb OPTIONAL .
    METHODS set_color_scheme_name
      IMPORTING
        iv_name TYPE string .
    METHODS set_font
      IMPORTING
        iv_type     TYPE string
        iv_script   TYPE string
        iv_typeface TYPE string .
    METHODS set_latin_font
      IMPORTING
        VALUE(iv_type)        TYPE string
        VALUE(iv_typeface)    TYPE string
        VALUE(iv_panose)      TYPE string OPTIONAL
        VALUE(iv_pitchfamily) TYPE string OPTIONAL
        VALUE(iv_charset)     TYPE string OPTIONAL .
    METHODS set_ea_font
      IMPORTING
        VALUE(iv_type)        TYPE string
        VALUE(iv_typeface)    TYPE string
        VALUE(iv_panose)      TYPE string OPTIONAL
        VALUE(iv_pitchfamily) TYPE string OPTIONAL
        VALUE(iv_charset)     TYPE string OPTIONAL .
    METHODS set_cs_font
      IMPORTING
        VALUE(iv_type)        TYPE string
        VALUE(iv_typeface)    TYPE string
        VALUE(iv_panose)      TYPE string OPTIONAL
        VALUE(iv_pitchfamily) TYPE string OPTIONAL
        VALUE(iv_charset)     TYPE string OPTIONAL .
    METHODS set_font_scheme_name
      IMPORTING
        VALUE(iv_name) TYPE string .
    METHODS set_theme_name
      IMPORTING
        VALUE(iv_name) TYPE string .
*"* protected declarations
*include Lcl_excel_theme===============co.
  PROTECTED SECTION.

    DATA elements TYPE REF TO Lcl_excel_theme_elements .
    DATA objectdefaults TYPE REF TO Lcl_excel_theme_objectdefaults .
    DATA extclrschemelst TYPE REF TO Lcl_excel_theme_eclrschemelst .
    DATA extlst TYPE REF TO Lcl_excel_theme_extlst .
*"* private declarations
*include Lcl_excel_theme===============ci.
  PRIVATE SECTION.

    DATA theme_changed TYPE abap_bool .
    DATA theme_read TYPE abap_bool .
    DATA name TYPE string .
    DATA xmls_a TYPE string .
endclass. "LCL_EXCEL_THEME definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME_ECLRSCHEMELST

*"* local type definitions
*include Lcl_excel_theme_eclrschemelst=ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME_ECLRSCHEMELST definition
*"* public declarations
*include Lcl_excel_theme_eclrschemelst=cu.
CLASS Lcl_excel_theme_eclrschemelst DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    METHODS load
      IMPORTING
        !io_extra_color TYPE REF TO if_ixml_element .
    METHODS build_xml
      IMPORTING
        !io_document TYPE REF TO if_ixml_document .
*"* protected declarations
*include Lcl_excel_theme_eclrschemelst=co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_theme_eclrschemelst=ci.
  PRIVATE SECTION.

    DATA extracolor TYPE REF TO if_ixml_element .
endclass. "LCL_EXCEL_THEME_ECLRSCHEMELST definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME_EXTLST

*"* local type definitions
*include Lcl_excel_theme_extlst========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME_EXTLST definition
*"* public declarations
*include Lcl_excel_theme_extlst========cu.
CLASS Lcl_excel_theme_extlst DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    METHODS load
      IMPORTING
        !io_extlst TYPE REF TO if_ixml_element .
    METHODS build_xml
      IMPORTING
        !io_document TYPE REF TO if_ixml_document .
*"* protected declarations
*include Lcl_excel_theme_extlst========co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_theme_extlst========ci.
  PRIVATE SECTION.

    DATA extlst TYPE REF TO if_ixml_element .
endclass. "LCL_EXCEL_THEME_EXTLST definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME_FMT_SCHEME

*"* local type definitions
*include Lcl_excel_theme_fmt_scheme====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME_FMT_SCHEME definition
*"* public declarations
*include Lcl_excel_theme_fmt_scheme====cu.
CLASS Lcl_excel_theme_fmt_scheme DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    METHODS load
      IMPORTING
        !io_fmt_scheme TYPE REF TO if_ixml_element .
    METHODS build_xml
      IMPORTING
        !io_document TYPE REF TO if_ixml_document .
*"* protected declarations
*include Lcl_excel_theme_fmt_scheme====co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_theme_fmt_scheme====ci.
  PRIVATE SECTION.

    DATA fmt_scheme TYPE REF TO if_ixml_element .

    METHODS get_default_fmt
      RETURNING
        VALUE(rv_string) TYPE string .

    METHODS parse_string
      IMPORTING iv_string      TYPE string
      RETURNING VALUE(ri_node) TYPE REF TO if_ixml_node.
endclass. "LCL_EXCEL_THEME_FMT_SCHEME definition
*class-pool .
*"* class pool for class LCL_EXCEL_THEME_OBJECTDEFAULTS

*"* local type definitions
*include Lcl_excel_theme_objectdefaultsccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_THEME_OBJECTDEFAULTS definition
*"* public declarations
*include Lcl_excel_theme_objectdefaultscu.
CLASS Lcl_excel_theme_objectdefaults DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    METHODS load
      IMPORTING
        !io_object_def TYPE REF TO if_ixml_element .
    METHODS build_xml
      IMPORTING
        !io_document TYPE REF TO if_ixml_document .
*"* protected declarations
*include Lcl_excel_theme_objectdefaultsco.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_theme_objectdefaultsci.
  PRIVATE SECTION.

    DATA objectdefaults TYPE REF TO if_ixml_element .
endclass. "LCL_EXCEL_THEME_OBJECTDEFAULTS definition
*class-pool .
*"* class pool for class LCL_EXCEL_WORKSHEET_PAGEBREAKS

*"* local type definitions
*include Lcl_excel_worksheet_pagebreaksccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_WORKSHEET_PAGEBREAKS definition
*"* public declarations
*include Lcl_excel_worksheet_pagebreakscu.
CLASS Lcl_excel_worksheet_pagebreaks DEFINITION
*public
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
      BEGIN OF ts_pagebreak_at ,
        cell_row    TYPE zexcel_cell_row,
        cell_column TYPE zexcel_cell_column,
      END OF ts_pagebreak_at .
    TYPES:
      tt_pagebreak_at TYPE HASHED TABLE OF  ts_pagebreak_at WITH UNIQUE KEY cell_row cell_column .

    METHODS add_pagebreak
      IMPORTING
        !ip_column TYPE simple
        !ip_row    TYPE zexcel_cell_row
      RAISING
        Lcx_excel .
    METHODS get_all_pagebreaks
      RETURNING
        VALUE(rt_pagebreaks) TYPE tt_pagebreak_at .
*"* protected declarations
*include Lcl_excel_worksheet_pagebreaksco.
  PROTECTED SECTION.

    DATA mt_pagebreaks TYPE tt_pagebreak_at .
*"* private declarations
*include Lcl_excel_worksheet_pagebreaksci.
  PRIVATE SECTION.
endclass. "LCL_EXCEL_WORKSHEET_PAGEBREAKS definition
*class-pool .
*"* class pool for class LCL_EXCEL_WRITER_CSV

*"* local type definitions
*include Lcl_excel_writer_csv==========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_WRITER_CSV definition
*"* public declarations
*include Lcl_excel_writer_csv==========cu.
CLASS Lcl_excel_writer_csv DEFINITION
*public
  FINAL
  CREATE PUBLIC .

*"* public components of class LCL_EXCEL_WRITER_CSV
*"* do not include other source files here!!!
  PUBLIC SECTION.

    INTERFACES Lif_excel_writer .

    CLASS-METHODS set_delimiter
      IMPORTING
        VALUE(ip_value) TYPE c DEFAULT ';' .
    CLASS-METHODS set_enclosure
      IMPORTING
        VALUE(ip_value) TYPE c DEFAULT '"' .
    CLASS-METHODS set_endofline
      IMPORTING
        VALUE(ip_value) TYPE any DEFAULT cl_abap_char_utilities=>cr_lf .
    CLASS-METHODS set_active_sheet_index
      IMPORTING
        !i_active_worksheet TYPE zexcel_active_worksheet .
    CLASS-METHODS set_active_sheet_index_by_name
      IMPORTING
        !i_worksheet_name TYPE zexcel_worksheets_name .
*"* protected components of class LCL_EXCEL_WRITER_2007
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_writer_csv==========co.
  PROTECTED SECTION.
*"* private components of class LCL_EXCEL_WRITER_CSV
*"* do not include other source files here!!!
*"* private declarations
*include Lcl_excel_writer_csv==========ci.
  PRIVATE SECTION.

    DATA excel TYPE REF TO Lcl_excel .
    CLASS-DATA delimiter TYPE c VALUE ';' ##NO_TEXT.
    CLASS-DATA enclosure TYPE c VALUE '"' ##NO_TEXT.
    CLASS-DATA:
      eol TYPE c LENGTH 2 VALUE cl_abap_char_utilities=>cr_lf ##NO_TEXT.
    CLASS-DATA worksheet_name TYPE zexcel_worksheets_name .
    CLASS-DATA worksheet_index TYPE zexcel_active_worksheet .

    METHODS create
      RETURNING
        VALUE(ep_excel) TYPE xstring
      RAISING
        Lcx_excel.
    METHODS create_csv
      RETURNING
        VALUE(ep_content) TYPE xstring
      RAISING
        Lcx_excel .
endclass. "LCL_EXCEL_WRITER_CSV definition
*class-pool .
*"* class pool for class LCL_EXCEL

*"* local type definitions
*include Lcl_excel=====================ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL definition
*"* public declarations
*include Lcl_excel=====================cu.
CLASS Lcl_excel DEFINITION
*public
  CREATE PUBLIC


.

  PUBLIC SECTION.

*"* public components of class LCL_EXCEL
*"* do not include other source files here!!!
    INTERFACES Lif_excel_book_properties .
    INTERFACES Lif_excel_book_protection .
    INTERFACES Lif_excel_book_vba_project .

    DATA legacy_palette TYPE REF TO Lcl_excel_legacy_palette READ-ONLY .
    DATA security TYPE REF TO Lcl_excel_security .
    DATA use_template TYPE abap_bool .
    CONSTANTS version TYPE c LENGTH 10 VALUE '7.16.0'.      "#EC NOTEXT

    METHODS add_new_autofilter
      IMPORTING
        !io_sheet            TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ro_autofilter) TYPE REF TO Lcl_excel_autofilter
      RAISING
        Lcx_excel .
    METHODS add_new_comment
      RETURNING
        VALUE(eo_comment) TYPE REF TO Lcl_excel_comment .
    METHODS add_new_drawing
      IMPORTING
        !ip_type          TYPE zexcel_drawing_type DEFAULT Lcl_excel_drawing=>type_image
        !ip_title         TYPE clike OPTIONAL
      RETURNING
        VALUE(eo_drawing) TYPE REF TO Lcl_excel_drawing .
    METHODS add_new_range
      RETURNING
        VALUE(eo_range) TYPE REF TO Lcl_excel_range .
    METHODS add_new_style
      IMPORTING
        !ip_guid        TYPE zexcel_cell_style OPTIONAL
        !io_clone_of    TYPE REF TO Lcl_excel_style OPTIONAL
          PREFERRED PARAMETER !ip_guid
      RETURNING
        VALUE(eo_style) TYPE REF TO Lcl_excel_style .
    METHODS add_new_worksheet
      IMPORTING
        !ip_title           TYPE zexcel_sheet_title OPTIONAL
      RETURNING
        VALUE(eo_worksheet) TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS add_static_styles .
    METHODS constructor .
    METHODS delete_worksheet
      IMPORTING
        !io_worksheet TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS delete_worksheet_by_index
      IMPORTING
        !iv_index TYPE numeric
      RAISING
        Lcx_excel .
    METHODS delete_worksheet_by_name
      IMPORTING
        !iv_title TYPE clike
      RAISING
        Lcx_excel .
    METHODS get_active_sheet_index
      RETURNING
        VALUE(r_active_worksheet) TYPE zexcel_active_worksheet .
    METHODS get_active_worksheet
      RETURNING
        VALUE(eo_worksheet) TYPE REF TO Lcl_excel_worksheet .
    METHODS get_autofilters_reference
      RETURNING
        VALUE(ro_autofilters) TYPE REF TO Lcl_excel_autofilters .
    METHODS get_default_style
      RETURNING
        VALUE(ep_style) TYPE zexcel_cell_style .
    METHODS get_drawings_iterator
      IMPORTING
        !ip_type           TYPE zexcel_drawing_type
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_next_table_id
      RETURNING
        VALUE(ep_id) TYPE i .
    METHODS get_ranges_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_static_cellstyle_guid
      IMPORTING
        !ip_cstyle_complete  TYPE zexcel_s_cstyle_complete
        !ip_cstylex_complete TYPE zexcel_s_cstylex_complete
      RETURNING
        VALUE(ep_guid)       TYPE zexcel_cell_style .
    METHODS get_styles_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_style_index_in_styles
      IMPORTING
        !ip_guid        TYPE zexcel_cell_style
      RETURNING
        VALUE(ep_index) TYPE i
      RAISING
        Lcx_excel .
    METHODS get_style_to_guid
      IMPORTING
        !ip_guid               TYPE zexcel_cell_style
      RETURNING
        VALUE(ep_stylemapping) TYPE zexcel_s_stylemapping
      RAISING
        Lcx_excel .
    METHODS get_theme
      EXPORTING
        !eo_theme TYPE REF TO Lcl_excel_theme .
    METHODS get_worksheets_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_worksheets_name
      RETURNING
        VALUE(ep_name) TYPE zexcel_worksheets_name .
    METHODS get_worksheets_size
      RETURNING
        VALUE(ep_size) TYPE i .
    METHODS get_worksheet_by_index
      IMPORTING
        !iv_index           TYPE numeric
      RETURNING
        VALUE(eo_worksheet) TYPE REF TO Lcl_excel_worksheet .
    METHODS get_worksheet_by_name
      IMPORTING
        !ip_sheet_name      TYPE zexcel_sheet_title
      RETURNING
        VALUE(eo_worksheet) TYPE REF TO Lcl_excel_worksheet .
    METHODS set_active_sheet_index
      IMPORTING
        !i_active_worksheet TYPE zexcel_active_worksheet
      RAISING
        Lcx_excel .
    METHODS set_active_sheet_index_by_name
      IMPORTING
        !i_worksheet_name TYPE zexcel_worksheets_name .
    METHODS set_default_style
      IMPORTING
        !ip_style TYPE zexcel_cell_style
      RAISING
        Lcx_excel .
    METHODS set_theme
      IMPORTING
        !io_theme TYPE REF TO Lcl_excel_theme .
    METHODS fill_template
      IMPORTING
        !iv_data TYPE REF TO Lcl_excel_template_data
      RAISING
        Lcx_excel .
*"* protected declarations
*include Lcl_excel=====================co.
  PROTECTED SECTION.

    DATA worksheets TYPE REF TO Lcl_excel_worksheets .
*"* private declarations
*include Lcl_excel=====================ci.
  PRIVATE SECTION.

    DATA autofilters TYPE REF TO Lcl_excel_autofilters .
    DATA charts TYPE REF TO Lcl_excel_drawings .
    DATA default_style TYPE zexcel_cell_style .
*"* private components of class LCL_EXCEL
*"* do not include other source files here!!!
    DATA drawings TYPE REF TO Lcl_excel_drawings .
    DATA ranges TYPE REF TO Lcl_excel_ranges .
    DATA styles TYPE REF TO Lcl_excel_styles .
    DATA t_stylemapping1 TYPE zexcel_t_stylemapping1 .
    DATA t_stylemapping2 TYPE zexcel_t_stylemapping2 .
    DATA theme TYPE REF TO Lcl_excel_theme .
    DATA comments TYPE REF TO Lcl_excel_comments .

    METHODS get_style_from_guid
      IMPORTING
        !ip_guid        TYPE zexcel_cell_style
      RETURNING
        VALUE(eo_style) TYPE REF TO Lcl_excel_style .
    METHODS stylemapping_dynamic_style
      IMPORTING
        !ip_style        TYPE REF TO Lcl_excel_style
      RETURNING
        VALUE(eo_style2) TYPE zexcel_s_stylemapping .
endclass. "LCL_EXCEL definition
*class-pool .
*"* class pool for class LCL_EXCEL_WORKSHEET

*"* local type definitions
*include Lcl_excel_worksheet===========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_WORKSHEET definition
*"* public declarations
*include Lcl_excel_worksheet===========cu.
CLASS Lcl_excel_worksheet DEFINITION
*public
  CREATE PUBLIC









.

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_WORKSHEET
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_WORKSHEET
*"* do not include other source files here!!!
*"* protected components of class LCL_EXCEL_WORKSHEET
*"* do not include other source files here!!!

    INTERFACES Lif_excel_sheet_printsettings .
    INTERFACES Lif_excel_sheet_properties .
    INTERFACES Lif_excel_sheet_protection .
    INTERFACES Lif_excel_sheet_vba_project .

    TYPES:
      BEGIN OF  mty_s_outline_row,
        row_from  TYPE i,
        row_to    TYPE i,
        collapsed TYPE abap_bool,
      END OF mty_s_outline_row .
    TYPES:
      mty_ts_outlines_row TYPE SORTED TABLE OF mty_s_outline_row WITH UNIQUE KEY row_from row_to .
    TYPES:
      BEGIN OF mty_s_ignored_errors,
        "! Cell reference (e.g. "A1") or list like "A1 A2" or range "A1:G1"
        cell_coords           TYPE zexcel_cell_coords,
        "! Ignore errors when cells contain formulas that result in an error.
        eval_error            TYPE abap_bool,
        "! Ignore errors when formulas contain text formatted cells with years represented as 2 digits.
        two_digit_text_year   TYPE abap_bool,
        "! Ignore errors when numbers are formatted as text or are preceded by an apostrophe.
        number_stored_as_text TYPE abap_bool,
        "! Ignore errors when a formula in a region of your WorkSheet differs from other formulas in the same region.
        formula               TYPE abap_bool,
        "! Ignore errors when formulas omit certain cells in a region.
        formula_range         TYPE abap_bool,
        "! Ignore errors when unlocked cells contain formulas.
        unlocked_formula      TYPE abap_bool,
        "! Ignore errors when formulas refer to empty cells.
        empty_cell_reference  TYPE abap_bool,
        "! Ignore errors when a cell's value in a Table does not comply with the Data Validation rules specified.
        list_data_validation  TYPE abap_bool,
        "! Ignore errors when cells contain a value different from a calculated column formula.
        "! In other words, for a calculated column, a cell in that column is considered to have an error
        "! if its formula is different from the calculated column formula, or doesn't contain a formula at all.
        calculated_column     TYPE abap_bool,
      END OF mty_s_ignored_errors .
    TYPES:
      mty_th_ignored_errors TYPE HASHED TABLE OF mty_s_ignored_errors WITH UNIQUE KEY cell_coords .
    TYPES:
      BEGIN OF mty_s_column_formula,
        id                     TYPE i,
        column                 TYPE zexcel_cell_column,
        formula                TYPE string,
        table_top_left_row     TYPE zexcel_cell_row,
        table_bottom_right_row TYPE zexcel_cell_row,
        table_left_column_int  TYPE zexcel_cell_column,
        table_right_column_int TYPE zexcel_cell_column,
      END OF mty_s_column_formula .
    TYPES:
      mty_th_column_formula
               TYPE HASHED TABLE OF mty_s_column_formula
               WITH UNIQUE KEY id .
    TYPES:
      ty_doc_url TYPE c LENGTH 255 .
    TYPES:
      BEGIN OF mty_merge,
        row_from TYPE i,
        row_to   TYPE i,
        col_from TYPE i,
        col_to   TYPE i,
      END OF mty_merge .
    TYPES:
      mty_ts_merge TYPE SORTED TABLE OF mty_merge WITH UNIQUE KEY table_line .
    TYPES:
      ty_area TYPE c LENGTH 1 .

    CONSTANTS c_break_column TYPE zexcel_break VALUE 2 ##NO_TEXT.
    CONSTANTS c_break_none TYPE zexcel_break VALUE 0 ##NO_TEXT.
    CONSTANTS c_break_row TYPE zexcel_break VALUE 1 ##NO_TEXT.
    CONSTANTS:
      BEGIN OF c_area,
        whole   TYPE ty_area VALUE 'W',                     "#EC NOTEXT
        topleft TYPE ty_area VALUE 'T',                     "#EC NOTEXT
      END OF c_area .
    DATA excel TYPE REF TO Lcl_excel READ-ONLY .
    DATA print_gridlines TYPE zexcel_print_gridlines READ-ONLY VALUE abap_false ##NO_TEXT.
    DATA sheet_content TYPE zexcel_t_cell_data .
    DATA sheet_setup TYPE REF TO Lcl_excel_sheet_setup .
    DATA show_gridlines TYPE zexcel_show_gridlines READ-ONLY VALUE abap_true ##NO_TEXT.
    DATA show_rowcolheaders TYPE zexcel_show_gridlines READ-ONLY VALUE abap_true ##NO_TEXT.
    DATA tabcolor TYPE zexcel_s_tabcolor READ-ONLY .
    DATA column_formulas TYPE mty_th_column_formula READ-ONLY .
    CLASS-DATA:
      BEGIN OF c_messages READ-ONLY,
        formula_id_only_is_possible TYPE string,
        column_formula_id_not_found TYPE string,
        formula_not_in_this_table   TYPE string,
        formula_in_other_column     TYPE string,
      END OF c_messages .
    DATA mt_merged_cells TYPE mty_ts_merge READ-ONLY .

    METHODS add_comment
      IMPORTING
        !ip_comment TYPE REF TO Lcl_excel_comment .
    METHODS add_drawing
      IMPORTING
        !ip_drawing TYPE REF TO Lcl_excel_drawing .
    METHODS add_new_column
      IMPORTING
        !ip_column       TYPE simple
      RETURNING
        VALUE(eo_column) TYPE REF TO Lcl_excel_column
      RAISING
        Lcx_excel .
    METHODS add_new_style_cond
      IMPORTING
        !ip_dimension_range  TYPE string DEFAULT 'A1'
      RETURNING
        VALUE(eo_style_cond) TYPE REF TO Lcl_excel_style_cond .
    METHODS add_new_data_validation
      RETURNING
        VALUE(eo_data_validation) TYPE REF TO Lcl_excel_data_validation .
    METHODS add_new_range
      RETURNING
        VALUE(eo_range) TYPE REF TO Lcl_excel_range .
    METHODS add_new_row
      IMPORTING
        !ip_row       TYPE simple
      RETURNING
        VALUE(eo_row) TYPE REF TO Lcl_excel_row .
    METHODS bind_alv
      IMPORTING
        !io_alv      TYPE REF TO object
        !it_table    TYPE STANDARD TABLE
        !i_top       TYPE i DEFAULT 1
        !i_left      TYPE i DEFAULT 1
        !table_style TYPE zexcel_table_style OPTIONAL
        !i_table     TYPE abap_bool DEFAULT abap_true
      RAISING
        Lcx_excel .
    METHODS bind_alv_ole2
      IMPORTING
        !i_document_url      TYPE ty_doc_url DEFAULT space
        !i_xls               TYPE c DEFAULT space
        !i_save_path         TYPE string
        !io_alv              TYPE REF TO cl_gui_alv_grid
        !it_listheader       TYPE slis_t_listheader OPTIONAL
        !i_top               TYPE i DEFAULT 1
        !i_left              TYPE i DEFAULT 1
        !i_columns_header    TYPE c DEFAULT 'X'
        !i_columns_autofit   TYPE c DEFAULT 'X'
        !i_format_col_header TYPE soi_format_item OPTIONAL
        !i_format_subtotal   TYPE soi_format_item OPTIONAL
        !i_format_total      TYPE soi_format_item OPTIONAL
      EXCEPTIONS
        miss_guide
        ex_transfer_kkblo_error
        fatal_error
        inv_data_range
        dim_mismatch_vkey
        dim_mismatch_sema
        error_in_sema .
    METHODS bind_table
      IMPORTING
        !ip_table               TYPE STANDARD TABLE
        !it_field_catalog       TYPE zexcel_t_fieldcatalog OPTIONAL
        !is_table_settings      TYPE zexcel_s_table_settings OPTIONAL
        VALUE(iv_default_descr) TYPE c OPTIONAL
        !iv_no_line_if_empty    TYPE abap_bool DEFAULT abap_false
        !ip_conv_exit_length    TYPE abap_bool DEFAULT abap_false
        !ip_conv_curr_amt_ext   TYPE abap_bool DEFAULT abap_false
      EXPORTING
        !es_table_settings      TYPE zexcel_s_table_settings
      RAISING
        Lcx_excel .
    METHODS calculate_column_widths
      RAISING
        Lcx_excel .
    METHODS change_area_style
      IMPORTING
        !ip_range         TYPE csequence OPTIONAL
        !ip_column_start  TYPE simple OPTIONAL
        !ip_column_end    TYPE simple OPTIONAL
        !ip_row           TYPE zexcel_cell_row OPTIONAL
        !ip_row_to        TYPE zexcel_cell_row OPTIONAL
        !ip_style_changer TYPE REF TO Lif_excel_style_changer
      RAISING
        Lcx_excel .
    METHODS change_cell_style
      IMPORTING
        !ip_columnrow                   TYPE csequence OPTIONAL
        !ip_column                      TYPE simple OPTIONAL
        !ip_row                         TYPE zexcel_cell_row OPTIONAL
        !ip_complete                    TYPE zexcel_s_cstyle_complete OPTIONAL
        !ip_xcomplete                   TYPE zexcel_s_cstylex_complete OPTIONAL
        !ip_font                        TYPE zexcel_s_cstyle_font OPTIONAL
        !ip_xfont                       TYPE zexcel_s_cstylex_font OPTIONAL
        !ip_fill                        TYPE zexcel_s_cstyle_fill OPTIONAL
        !ip_xfill                       TYPE zexcel_s_cstylex_fill OPTIONAL
        !ip_borders                     TYPE zexcel_s_cstyle_borders OPTIONAL
        !ip_xborders                    TYPE zexcel_s_cstylex_borders OPTIONAL
        !ip_alignment                   TYPE zexcel_s_cstyle_alignment OPTIONAL
        !ip_xalignment                  TYPE zexcel_s_cstylex_alignment OPTIONAL
        !ip_number_format_format_code   TYPE zexcel_number_format OPTIONAL
        !ip_protection                  TYPE zexcel_s_cstyle_protection OPTIONAL
        !ip_xprotection                 TYPE zexcel_s_cstylex_protection OPTIONAL
        !ip_font_bold                   TYPE flag OPTIONAL
        !ip_font_color                  TYPE zexcel_s_style_color OPTIONAL
        !ip_font_color_rgb              TYPE zexcel_style_color_argb OPTIONAL
        !ip_font_color_indexed          TYPE zexcel_style_color_indexed OPTIONAL
        !ip_font_color_theme            TYPE zexcel_style_color_theme OPTIONAL
        !ip_font_color_tint             TYPE zexcel_style_color_tint OPTIONAL
        !ip_font_family                 TYPE zexcel_style_font_family OPTIONAL
        !ip_font_italic                 TYPE flag OPTIONAL
        !ip_font_name                   TYPE zexcel_style_font_name OPTIONAL
        !ip_font_scheme                 TYPE zexcel_style_font_scheme OPTIONAL
        !ip_font_size                   TYPE zexcel_style_font_size OPTIONAL
        !ip_font_strikethrough          TYPE flag OPTIONAL
        !ip_font_underline              TYPE flag OPTIONAL
        !ip_font_underline_mode         TYPE zexcel_style_font_underline OPTIONAL
        !ip_fill_filltype               TYPE zexcel_fill_type OPTIONAL
        !ip_fill_rotation               TYPE zexcel_rotation OPTIONAL
        !ip_fill_fgcolor                TYPE zexcel_s_style_color OPTIONAL
        !ip_fill_fgcolor_rgb            TYPE zexcel_style_color_argb OPTIONAL
        !ip_fill_fgcolor_indexed        TYPE zexcel_style_color_indexed OPTIONAL
        !ip_fill_fgcolor_theme          TYPE zexcel_style_color_theme OPTIONAL
        !ip_fill_fgcolor_tint           TYPE zexcel_style_color_tint OPTIONAL
        !ip_fill_bgcolor                TYPE zexcel_s_style_color OPTIONAL
        !ip_fill_bgcolor_rgb            TYPE zexcel_style_color_argb OPTIONAL
        !ip_fill_bgcolor_indexed        TYPE zexcel_style_color_indexed OPTIONAL
        !ip_fill_bgcolor_theme          TYPE zexcel_style_color_theme OPTIONAL
        !ip_fill_bgcolor_tint           TYPE zexcel_style_color_tint OPTIONAL
        !ip_borders_allborders          TYPE zexcel_s_cstyle_border OPTIONAL
        !ip_fill_gradtype_type          TYPE zexcel_s_gradient_type-type OPTIONAL
        !ip_fill_gradtype_degree        TYPE zexcel_s_gradient_type-degree OPTIONAL
        !ip_xborders_allborders         TYPE zexcel_s_cstylex_border OPTIONAL
        !ip_borders_diagonal            TYPE zexcel_s_cstyle_border OPTIONAL
        !ip_fill_gradtype_bottom        TYPE zexcel_s_gradient_type-bottom OPTIONAL
        !ip_fill_gradtype_top           TYPE zexcel_s_gradient_type-top OPTIONAL
        !ip_xborders_diagonal           TYPE zexcel_s_cstylex_border OPTIONAL
        !ip_borders_diagonal_mode       TYPE zexcel_diagonal OPTIONAL
        !ip_fill_gradtype_right         TYPE zexcel_s_gradient_type-right OPTIONAL
        !ip_borders_down                TYPE zexcel_s_cstyle_border OPTIONAL
        !ip_fill_gradtype_left          TYPE zexcel_s_gradient_type-left OPTIONAL
        !ip_fill_gradtype_position1     TYPE zexcel_s_gradient_type-position1 OPTIONAL
        !ip_xborders_down               TYPE zexcel_s_cstylex_border OPTIONAL
        !ip_borders_left                TYPE zexcel_s_cstyle_border OPTIONAL
        !ip_fill_gradtype_position2     TYPE zexcel_s_gradient_type-position2 OPTIONAL
        !ip_fill_gradtype_position3     TYPE zexcel_s_gradient_type-position3 OPTIONAL
        !ip_xborders_left               TYPE zexcel_s_cstylex_border OPTIONAL
        !ip_borders_right               TYPE zexcel_s_cstyle_border OPTIONAL
        !ip_xborders_right              TYPE zexcel_s_cstylex_border OPTIONAL
        !ip_borders_top                 TYPE zexcel_s_cstyle_border OPTIONAL
        !ip_xborders_top                TYPE zexcel_s_cstylex_border OPTIONAL
        !ip_alignment_horizontal        TYPE zexcel_alignment OPTIONAL
        !ip_alignment_vertical          TYPE zexcel_alignment OPTIONAL
        !ip_alignment_textrotation      TYPE zexcel_text_rotation OPTIONAL
        !ip_alignment_wraptext          TYPE flag OPTIONAL
        !ip_alignment_shrinktofit       TYPE flag OPTIONAL
        !ip_alignment_indent            TYPE zexcel_indent OPTIONAL
        !ip_protection_hidden           TYPE zexcel_cell_protection OPTIONAL
        !ip_protection_locked           TYPE zexcel_cell_protection OPTIONAL
        !ip_borders_allborders_style    TYPE zexcel_border OPTIONAL
        !ip_borders_allborders_color    TYPE zexcel_s_style_color OPTIONAL
        !ip_borders_allbo_color_rgb     TYPE zexcel_style_color_argb OPTIONAL
        !ip_borders_allbo_color_indexed TYPE zexcel_style_color_indexed OPTIONAL
        !ip_borders_allbo_color_theme   TYPE zexcel_style_color_theme OPTIONAL
        !ip_borders_allbo_color_tint    TYPE zexcel_style_color_tint OPTIONAL
        !ip_borders_diagonal_style      TYPE zexcel_border OPTIONAL
        !ip_borders_diagonal_color      TYPE zexcel_s_style_color OPTIONAL
        !ip_borders_diagonal_color_rgb  TYPE zexcel_style_color_argb OPTIONAL
        !ip_borders_diagonal_color_inde TYPE zexcel_style_color_indexed OPTIONAL
        !ip_borders_diagonal_color_them TYPE zexcel_style_color_theme OPTIONAL
        !ip_borders_diagonal_color_tint TYPE zexcel_style_color_tint OPTIONAL
        !ip_borders_down_style          TYPE zexcel_border OPTIONAL
        !ip_borders_down_color          TYPE zexcel_s_style_color OPTIONAL
        !ip_borders_down_color_rgb      TYPE zexcel_style_color_argb OPTIONAL
        !ip_borders_down_color_indexed  TYPE zexcel_style_color_indexed OPTIONAL
        !ip_borders_down_color_theme    TYPE zexcel_style_color_theme OPTIONAL
        !ip_borders_down_color_tint     TYPE zexcel_style_color_tint OPTIONAL
        !ip_borders_left_style          TYPE zexcel_border OPTIONAL
        !ip_borders_left_color          TYPE zexcel_s_style_color OPTIONAL
        !ip_borders_left_color_rgb      TYPE zexcel_style_color_argb OPTIONAL
        !ip_borders_left_color_indexed  TYPE zexcel_style_color_indexed OPTIONAL
        !ip_borders_left_color_theme    TYPE zexcel_style_color_theme OPTIONAL
        !ip_borders_left_color_tint     TYPE zexcel_style_color_tint OPTIONAL
        !ip_borders_right_style         TYPE zexcel_border OPTIONAL
        !ip_borders_right_color         TYPE zexcel_s_style_color OPTIONAL
        !ip_borders_right_color_rgb     TYPE zexcel_style_color_argb OPTIONAL
        !ip_borders_right_color_indexed TYPE zexcel_style_color_indexed OPTIONAL
        !ip_borders_right_color_theme   TYPE zexcel_style_color_theme OPTIONAL
        !ip_borders_right_color_tint    TYPE zexcel_style_color_tint OPTIONAL
        !ip_borders_top_style           TYPE zexcel_border OPTIONAL
        !ip_borders_top_color           TYPE zexcel_s_style_color OPTIONAL
        !ip_borders_top_color_rgb       TYPE zexcel_style_color_argb OPTIONAL
        !ip_borders_top_color_indexed   TYPE zexcel_style_color_indexed OPTIONAL
        !ip_borders_top_color_theme     TYPE zexcel_style_color_theme OPTIONAL
        !ip_borders_top_color_tint      TYPE zexcel_style_color_tint OPTIONAL
      RETURNING
        VALUE(ep_guid)                  TYPE zexcel_cell_style
      RAISING
        Lcx_excel .
    CLASS-METHODS class_constructor .
    METHODS constructor
      IMPORTING
        !ip_excel TYPE REF TO Lcl_excel
        !ip_title TYPE zexcel_sheet_title OPTIONAL
      RAISING
        Lcx_excel .
    METHODS delete_merge
      IMPORTING
        !ip_cell_column TYPE simple OPTIONAL
        !ip_cell_row    TYPE zexcel_cell_row OPTIONAL
      RAISING
        Lcx_excel .
    METHODS delete_row_outline
      IMPORTING
        !iv_row_from TYPE i
        !iv_row_to   TYPE i
      RAISING
        Lcx_excel .
    METHODS freeze_panes
      IMPORTING
        !ip_num_columns TYPE i OPTIONAL
        !ip_num_rows    TYPE i OPTIONAL
      RAISING
        Lcx_excel .
    METHODS get_active_cell
      RETURNING
        VALUE(ep_active_cell) TYPE string
      RAISING
        Lcx_excel .
    METHODS get_cell
      IMPORTING
        !ip_columnrow TYPE csequence OPTIONAL
        !ip_column    TYPE simple OPTIONAL
        !ip_row       TYPE zexcel_cell_row OPTIONAL
      EXPORTING
        !ep_value     TYPE zexcel_cell_value
        !ep_rc        TYPE sysubrc
        !ep_style     TYPE REF TO Lcl_excel_style
        !ep_guid      TYPE zexcel_cell_style
        !ep_formula   TYPE zexcel_cell_formula
        !et_rtf       TYPE zexcel_t_rtf
      RAISING
        Lcx_excel .
    METHODS get_column
      IMPORTING
        !ip_column       TYPE simple
      RETURNING
        VALUE(eo_column) TYPE REF TO Lcl_excel_column
      RAISING
        Lcx_excel .
    METHODS get_columns
      RETURNING
        VALUE(eo_columns) TYPE REF TO Lcl_excel_columns
      RAISING
        Lcx_excel .
    METHODS get_columns_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator
      RAISING
        Lcx_excel .
    METHODS get_style_cond_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_data_validations_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_data_validations_size
      RETURNING
        VALUE(ep_size) TYPE i .
    METHODS get_default_column
      RETURNING
        VALUE(eo_column) TYPE REF TO Lcl_excel_column
      RAISING
        Lcx_excel .
    METHODS get_default_excel_date_format
      RETURNING
        VALUE(ep_default_excel_date_format) TYPE zexcel_number_format .
    METHODS get_default_excel_time_format
      RETURNING
        VALUE(ep_default_excel_time_format) TYPE zexcel_number_format .
    METHODS get_default_row
      RETURNING
        VALUE(eo_row) TYPE REF TO Lcl_excel_row .
    METHODS get_dimension_range
      RETURNING
        VALUE(ep_dimension_range) TYPE string
      RAISING
        Lcx_excel .
    METHODS get_comments
      RETURNING
        VALUE(r_comments) TYPE REF TO Lcl_excel_comments .
    METHODS get_drawings
      IMPORTING
        !ip_type          TYPE zexcel_drawing_type OPTIONAL
      RETURNING
        VALUE(r_drawings) TYPE REF TO Lcl_excel_drawings .
    METHODS get_comments_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_drawings_iterator
      IMPORTING
        !ip_type           TYPE zexcel_drawing_type
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_freeze_cell
      EXPORTING
        !ep_row    TYPE zexcel_cell_row
        !ep_column TYPE zexcel_cell_column .
    METHODS get_guid
      RETURNING
        VALUE(ep_guid) TYPE sysuuid_x16 .
    METHODS get_highest_column
      RETURNING
        VALUE(r_highest_column) TYPE zexcel_cell_column
      RAISING
        Lcx_excel .
    METHODS get_highest_row
      RETURNING
        VALUE(r_highest_row) TYPE int4
      RAISING
        Lcx_excel .
    METHODS get_hyperlinks_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_hyperlinks_size
      RETURNING
        VALUE(ep_size) TYPE i .
    METHODS get_ignored_errors
      RETURNING
        VALUE(rt_ignored_errors) TYPE mty_th_ignored_errors .
    METHODS get_merge
      RETURNING
        VALUE(merge_range) TYPE string_table
      RAISING
        Lcx_excel .
    METHODS get_pagebreaks
      RETURNING
        VALUE(ro_pagebreaks) TYPE REF TO Lcl_excel_worksheet_pagebreaks
      RAISING
        Lcx_excel .
    METHODS get_ranges_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_row
      IMPORTING
        !ip_row       TYPE int4
      RETURNING
        VALUE(eo_row) TYPE REF TO Lcl_excel_row .
    METHODS get_rows
      RETURNING
        VALUE(eo_rows) TYPE REF TO Lcl_excel_rows .
    METHODS get_rows_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_row_outlines
      RETURNING
        VALUE(rt_row_outlines) TYPE mty_ts_outlines_row .
    METHODS get_style_cond
      IMPORTING
        !ip_guid             TYPE zexcel_cell_style
      RETURNING
        VALUE(eo_style_cond) TYPE REF TO Lcl_excel_style_cond .
    METHODS get_tabcolor
      RETURNING
        VALUE(ev_tabcolor) TYPE zexcel_s_tabcolor .
    METHODS get_tables_iterator
      RETURNING
        VALUE(eo_iterator) TYPE REF TO Lcl_excel_collection_iterator .
    METHODS get_tables_size
      RETURNING
        VALUE(ep_size) TYPE i .
    METHODS get_title
      IMPORTING
        !ip_escaped     TYPE flag DEFAULT ''
      RETURNING
        VALUE(ep_title) TYPE zexcel_sheet_title .
    METHODS is_cell_merged
      IMPORTING
        !ip_column          TYPE simple
        !ip_row             TYPE zexcel_cell_row
      RETURNING
        VALUE(rp_is_merged) TYPE abap_bool
      RAISING
        Lcx_excel .
    METHODS set_cell
      IMPORTING
        !ip_columnrow         TYPE csequence OPTIONAL
        !ip_column            TYPE simple OPTIONAL
        !ip_row               TYPE zexcel_cell_row OPTIONAL
        !ip_value             TYPE simple OPTIONAL
        !ip_formula           TYPE zexcel_cell_formula OPTIONAL
        !ip_style             TYPE any OPTIONAL
        !ip_hyperlink         TYPE REF TO Lcl_excel_hyperlink OPTIONAL
        !ip_data_type         TYPE zexcel_cell_data_type OPTIONAL
        !ip_abap_type         TYPE abap_typekind OPTIONAL
        !ip_currency          TYPE waers_curc OPTIONAL
        !it_rtf               TYPE zexcel_t_rtf OPTIONAL
        !ip_column_formula_id TYPE mty_s_column_formula-id OPTIONAL
        !ip_conv_exit_length  TYPE abap_bool DEFAULT abap_false
      RAISING
        Lcx_excel .
    METHODS set_cell_formula
      IMPORTING
        !ip_columnrow TYPE csequence OPTIONAL
        !ip_column    TYPE simple OPTIONAL
        !ip_row       TYPE zexcel_cell_row OPTIONAL
        !ip_formula   TYPE zexcel_cell_formula
      RAISING
        Lcx_excel .
    METHODS set_cell_style
      IMPORTING
        !ip_columnrow TYPE csequence OPTIONAL
        !ip_column    TYPE simple OPTIONAL
        !ip_row       TYPE zexcel_cell_row OPTIONAL
        !ip_style     TYPE any
      RAISING
        Lcx_excel .
    METHODS set_column_width
      IMPORTING
        !ip_column         TYPE simple
        !ip_width_fix      TYPE simple DEFAULT 0
        !ip_width_autosize TYPE flag DEFAULT 'X'
      RAISING
        Lcx_excel .
    METHODS set_default_excel_date_format
      IMPORTING
        !ip_default_excel_date_format TYPE zexcel_number_format
      RAISING
        Lcx_excel .
    METHODS set_ignored_errors
      IMPORTING
        !it_ignored_errors TYPE mty_th_ignored_errors .
    METHODS set_merge
      IMPORTING
        !ip_range        TYPE csequence OPTIONAL
        !ip_column_start TYPE simple OPTIONAL
        !ip_column_end   TYPE simple OPTIONAL
        !ip_row          TYPE zexcel_cell_row OPTIONAL
        !ip_row_to       TYPE zexcel_cell_row OPTIONAL
        !ip_style        TYPE any OPTIONAL
        !ip_value        TYPE simple OPTIONAL          "added parameter
        !ip_formula      TYPE zexcel_cell_formula OPTIONAL        "added parameter
      RAISING
        Lcx_excel .
    METHODS set_print_gridlines
      IMPORTING
        !i_print_gridlines TYPE zexcel_print_gridlines .
    METHODS set_row_height
      IMPORTING
        !ip_row        TYPE simple
        !ip_height_fix TYPE simple
      RAISING
        Lcx_excel .
    METHODS set_row_outline
      IMPORTING
        !iv_row_from  TYPE i
        !iv_row_to    TYPE i
        !iv_collapsed TYPE abap_bool
      RAISING
        Lcx_excel .
    METHODS set_show_gridlines
      IMPORTING
        !i_show_gridlines TYPE zexcel_show_gridlines .
    METHODS set_show_rowcolheaders
      IMPORTING
        !i_show_rowcolheaders TYPE zexcel_show_rowcolheader .
    METHODS set_tabcolor
      IMPORTING
        !iv_tabcolor TYPE zexcel_s_tabcolor .
    METHODS set_table
      IMPORTING
        !ip_table           TYPE STANDARD TABLE
        !ip_hdr_style       TYPE any OPTIONAL
        !ip_body_style      TYPE any OPTIONAL
        !ip_table_title     TYPE string
        !ip_top_left_column TYPE zexcel_cell_column_alpha DEFAULT 'B'
        !ip_top_left_row    TYPE zexcel_cell_row DEFAULT 3
        !ip_transpose       TYPE abap_bool OPTIONAL
        !ip_no_header       TYPE abap_bool OPTIONAL
      RAISING
        Lcx_excel .
    METHODS set_title
      IMPORTING
        !ip_title TYPE zexcel_sheet_title
      RAISING
        Lcx_excel .
    METHODS get_table
      IMPORTING
        !iv_skipped_rows           TYPE int4 DEFAULT 0
        !iv_skipped_cols           TYPE int4 DEFAULT 0
        !iv_max_col                TYPE int4 OPTIONAL
        !iv_max_row                TYPE int4 OPTIONAL
        !iv_skip_bottom_empty_rows TYPE abap_bool DEFAULT abap_false
      EXPORTING
        !et_table                  TYPE STANDARD TABLE
      RAISING
        Lcx_excel .
    METHODS set_merge_style
      IMPORTING
        !ip_range        TYPE csequence OPTIONAL
        !ip_column_start TYPE simple OPTIONAL
        !ip_column_end   TYPE simple OPTIONAL
        !ip_row          TYPE zexcel_cell_row OPTIONAL
        !ip_row_to       TYPE zexcel_cell_row OPTIONAL
        !ip_style        TYPE any OPTIONAL
      RAISING
        Lcx_excel .
    METHODS set_area_formula
      IMPORTING
        !ip_range        TYPE csequence OPTIONAL
        !ip_column_start TYPE simple OPTIONAL
        !ip_column_end   TYPE simple OPTIONAL
        !ip_row          TYPE zexcel_cell_row OPTIONAL
        !ip_row_to       TYPE zexcel_cell_row OPTIONAL
        !ip_formula      TYPE zexcel_cell_formula
        !ip_merge        TYPE abap_bool OPTIONAL
        !ip_area         TYPE ty_area DEFAULT c_area-topleft
      RAISING
        Lcx_excel .
    METHODS set_area_style
      IMPORTING
        !ip_range        TYPE csequence OPTIONAL
        !ip_column_start TYPE simple OPTIONAL
        !ip_column_end   TYPE simple OPTIONAL
        !ip_row          TYPE zexcel_cell_row OPTIONAL
        !ip_row_to       TYPE zexcel_cell_row OPTIONAL
        !ip_style        TYPE any
        !ip_merge        TYPE abap_bool OPTIONAL
      RAISING
        Lcx_excel .
    METHODS set_area
      IMPORTING
        !ip_range        TYPE csequence OPTIONAL
        !ip_column_start TYPE simple OPTIONAL
        !ip_column_end   TYPE simple OPTIONAL
        !ip_row          TYPE zexcel_cell_row OPTIONAL
        !ip_row_to       TYPE zexcel_cell_row OPTIONAL
        !ip_value        TYPE simple OPTIONAL
        !ip_formula      TYPE zexcel_cell_formula OPTIONAL
        !ip_style        TYPE any OPTIONAL
        !ip_hyperlink    TYPE REF TO Lcl_excel_hyperlink OPTIONAL
        !ip_data_type    TYPE zexcel_cell_data_type OPTIONAL
        !ip_abap_type    TYPE abap_typekind OPTIONAL
        !ip_merge        TYPE abap_bool OPTIONAL
        !ip_area         TYPE ty_area DEFAULT c_area-topleft
      RAISING
        Lcx_excel .
    METHODS get_header_footer_drawings
      RETURNING
        VALUE(rt_drawings) TYPE zexcel_t_drawings .
    METHODS set_area_hyperlink
      IMPORTING
        !ip_range        TYPE csequence OPTIONAL
        !ip_column_start TYPE simple OPTIONAL
        !ip_column_end   TYPE simple OPTIONAL
        !ip_row          TYPE zexcel_cell_row OPTIONAL
        !ip_row_to       TYPE zexcel_cell_row OPTIONAL
        !ip_url          TYPE string
        !ip_is_internal  TYPE abap_bool
      RAISING
        Lcx_excel .
    "! excel upload, counterpart to BIND_TABLE
    "! @parameter it_field_catalog | field catalog, used to derive correct types
    "! @parameter iv_begin_row | starting row, by default 2 to skip header
    "! @parameter et_data | generic internal table, there may be conversion losses
    "! @parameter er_data | ref to internal table of string columns, to get raw data without conversion losses.
    METHODS convert_to_table
      IMPORTING
        !it_field_catalog TYPE zexcel_t_fieldcatalog OPTIONAL
        !iv_begin_row     TYPE int4 DEFAULT 2
        !iv_end_row       TYPE int4 DEFAULT 0
      EXPORTING
        !et_data          TYPE STANDARD TABLE
        !er_data          TYPE REF TO data
      RAISING
        Lcx_excel .
*"* protected declarations
*include Lcl_excel_worksheet===========co.
  PROTECTED SECTION.
    METHODS set_table_reference
      IMPORTING
        !ip_column    TYPE zexcel_cell_column
        !ip_row       TYPE zexcel_cell_row
        !ir_table     TYPE REF TO Lcl_excel_table
        !ip_fieldname TYPE zexcel_fieldname
        !ip_header    TYPE abap_bool
      RAISING
        Lcx_excel .
*"* private declarations
*include Lcl_excel_worksheet===========ci.
  PRIVATE SECTION.

*"* private components of class LCL_EXCEL_WORKSHEET
*"* do not include other source files here!!!
    TYPES ty_table_settings TYPE STANDARD TABLE OF zexcel_s_table_settings WITH DEFAULT KEY.
    DATA active_cell TYPE zexcel_s_cell_data .
    DATA charts TYPE REF TO Lcl_excel_drawings .
    DATA columns TYPE REF TO Lcl_excel_columns .
    DATA row_default TYPE REF TO Lcl_excel_row .
    DATA column_default TYPE REF TO Lcl_excel_column .
    DATA styles_cond TYPE REF TO Lcl_excel_styles_cond .
    DATA data_validations TYPE REF TO Lcl_excel_data_validations .
    DATA default_excel_date_format TYPE zexcel_number_format .
    DATA default_excel_time_format TYPE zexcel_number_format .
    DATA comments TYPE REF TO Lcl_excel_comments .
    DATA drawings TYPE REF TO Lcl_excel_drawings .
    DATA freeze_pane_cell_column TYPE zexcel_cell_column .
    DATA freeze_pane_cell_row TYPE zexcel_cell_row .
    DATA guid TYPE sysuuid_x16 .
    DATA hyperlinks TYPE REF TO Lcl_excel_collection .
    DATA lower_cell TYPE zexcel_s_cell_data .
    DATA mo_pagebreaks TYPE REF TO Lcl_excel_worksheet_pagebreaks .
    DATA mt_row_outlines TYPE mty_ts_outlines_row .
    DATA print_title_col_from TYPE zexcel_cell_column_alpha .
    DATA print_title_col_to TYPE zexcel_cell_column_alpha .
    DATA print_title_row_from TYPE zexcel_cell_row .
    DATA print_title_row_to TYPE zexcel_cell_row .
    DATA ranges TYPE REF TO Lcl_excel_ranges .
    DATA rows TYPE REF TO Lcl_excel_rows .
    DATA tables TYPE REF TO Lcl_excel_collection .
    DATA title TYPE zexcel_sheet_title VALUE 'Worksheet'. "#EC NOTEXT .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . " .
    DATA upper_cell TYPE zexcel_s_cell_data .
    DATA mt_ignored_errors TYPE mty_th_ignored_errors.
    DATA right_to_left TYPE abap_bool.

    METHODS calculate_cell_width
      IMPORTING
        !ip_column      TYPE simple
        !ip_row         TYPE zexcel_cell_row
      RETURNING
        VALUE(ep_width) TYPE f
      RAISING
        Lcx_excel .
    CLASS-METHODS calculate_table_bottom_right
      IMPORTING
        ip_table         TYPE STANDARD TABLE
        it_field_catalog TYPE zexcel_t_fieldcatalog
      CHANGING
        cs_settings      TYPE zexcel_s_table_settings
      RAISING
        Lcx_excel.
    CLASS-METHODS check_cell_column_formula
      IMPORTING
        it_column_formulas   TYPE mty_th_column_formula
        ip_column_formula_id TYPE mty_s_column_formula-id
        ip_formula           TYPE zexcel_cell_formula
        ip_value             TYPE simple
        ip_row               TYPE zexcel_cell_row
        ip_column            TYPE zexcel_cell_column
      RAISING
        Lcx_excel.
    METHODS check_rtf
      IMPORTING
        !ip_value       TYPE simple
        VALUE(ip_style) TYPE zexcel_cell_style OPTIONAL
      CHANGING
        !ct_rtf         TYPE zexcel_t_rtf
      RAISING
        Lcx_excel .
    CLASS-METHODS check_table_overlapping
      IMPORTING
        is_table_settings       TYPE zexcel_s_table_settings
        it_other_table_settings TYPE ty_table_settings
      RAISING
        Lcx_excel.
    METHODS clear_initial_colorxfields
      IMPORTING
        is_color  TYPE zexcel_s_style_color
      CHANGING
        cs_xcolor TYPE zexcel_s_cstylex_color.
    METHODS create_data_conv_exit_length
      IMPORTING
        !ip_value       TYPE simple
      RETURNING
        VALUE(ep_value) TYPE REF TO data.
    METHODS generate_title
      RETURNING
        VALUE(ep_title) TYPE zexcel_sheet_title .
    METHODS get_value_type
      IMPORTING
        !ip_value      TYPE simple
      EXPORTING
        !ep_value      TYPE simple
        !ep_value_type TYPE abap_typekind .
    METHODS move_supplied_borders
      IMPORTING
        iv_border_supplied        TYPE abap_bool
        is_border                 TYPE zexcel_s_cstyle_border
        iv_xborder_supplied       TYPE abap_bool
        is_xborder                TYPE zexcel_s_cstylex_border
      CHANGING
        cs_complete_style_border  TYPE zexcel_s_cstyle_border
        cs_complete_stylex_border TYPE zexcel_s_cstylex_border.
    METHODS normalize_column_heading_texts
      IMPORTING
        iv_default_descr TYPE c
        it_field_catalog TYPE zexcel_t_fieldcatalog
      RETURNING
        VALUE(result)    TYPE zexcel_t_fieldcatalog.
    METHODS normalize_columnrow_parameter
      IMPORTING
        ip_columnrow TYPE csequence OPTIONAL
        ip_column    TYPE simple OPTIONAL
        ip_row       TYPE zexcel_cell_row OPTIONAL
      EXPORTING
        ep_column    TYPE zexcel_cell_column
        ep_row       TYPE zexcel_cell_row
      RAISING
        Lcx_excel.
    METHODS normalize_range_parameter
      IMPORTING
        ip_range        TYPE csequence OPTIONAL
        ip_column_start TYPE simple OPTIONAL
        ip_column_end   TYPE simple OPTIONAL
        ip_row          TYPE zexcel_cell_row OPTIONAL
        ip_row_to       TYPE zexcel_cell_row OPTIONAL
      EXPORTING
        ep_column_start TYPE zexcel_cell_column
        ep_column_end   TYPE zexcel_cell_column
        ep_row          TYPE zexcel_cell_row
        ep_row_to       TYPE zexcel_cell_row
      RAISING
        Lcx_excel.
    CLASS-METHODS normalize_style_parameter
      IMPORTING
        !ip_style_or_guid TYPE any
      RETURNING
        VALUE(rv_guid)    TYPE zexcel_cell_style
      RAISING
        Lcx_excel .
    METHODS print_title_set_range .
    METHODS update_dimension_range
      RAISING
        Lcx_excel .
endclass. "LCL_EXCEL_WORKSHEET definition
CLASS SHRITEFUH64VYIPN5I4UIDBJAALSE4 DEFINITION DEFERRED.
*class-pool .
*"* class pool for class LCL_EXCEL_WRITER_2007

*"* local type definitions
*include Lcl_excel_writer_2007=========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_WRITER_2007 definition
*"* public declarations
*include Lcl_excel_writer_2007=========cu.
CLASS Lcl_excel_writer_2007 DEFINITION
*public
  CREATE PUBLIC
FRIENDS
SHRITEFUH64VYIPN5I4UIDBJAALSE4



.

  PUBLIC SECTION.

*"* public components of class LCL_EXCEL_WRITER_2007
*"* do not include other source files here!!!
    INTERFACES Lif_excel_writer .
    METHODS constructor.

*"* protected declarations
*include Lcl_excel_writer_2007=========co.
  PROTECTED SECTION.

*"* protected components of class LCL_EXCEL_WRITER_2007
*"* do not include other source files here!!!
    TYPES: BEGIN OF mty_column_formula_used,
             id TYPE zexcel_s_cell_data-column_formula_id,
             si TYPE string,
             "! type: shared, etc.
             t  TYPE string,
           END OF mty_column_formula_used,
           mty_column_formulas_used TYPE HASHED TABLE OF mty_column_formula_used WITH UNIQUE KEY id.
    CONSTANTS c_content_types TYPE string VALUE '[Content_Types].xml'. "#EC NOTEXT
    CONSTANTS c_docprops_app TYPE string VALUE 'docProps/app.xml'. "#EC NOTEXT
    CONSTANTS c_docprops_core TYPE string VALUE 'docProps/core.xml'. "#EC NOTEXT
    CONSTANTS c_relationships TYPE string VALUE '_rels/.rels'. "#EC NOTEXT
    CONSTANTS c_xl_calcchain TYPE string VALUE 'xl/calcChain.xml'. "#EC NOTEXT
    CONSTANTS c_xl_drawings TYPE string VALUE 'xl/drawings/drawing#.xml'. "#EC NOTEXT
    CONSTANTS c_xl_drawings_rels TYPE string VALUE 'xl/drawings/_rels/drawing#.xml.rels'. "#EC NOTEXT
    CONSTANTS c_xl_relationships TYPE string VALUE 'xl/_rels/workbook.xml.rels'. "#EC NOTEXT
    CONSTANTS c_xl_sharedstrings TYPE string VALUE 'xl/sharedStrings.xml'. "#EC NOTEXT
    CONSTANTS c_xl_sheet TYPE string VALUE 'xl/worksheets/sheet#.xml'. "#EC NOTEXT
    CONSTANTS c_xl_sheet_rels TYPE string VALUE 'xl/worksheets/_rels/sheet#.xml.rels'. "#EC NOTEXT
    CONSTANTS c_xl_styles TYPE string VALUE 'xl/styles.xml'. "#EC NOTEXT
    CONSTANTS c_xl_theme TYPE string VALUE 'xl/theme/theme1.xml'. "#EC NOTEXT
    CONSTANTS c_xl_workbook TYPE string VALUE 'xl/workbook.xml'. "#EC NOTEXT
    DATA excel TYPE REF TO Lcl_excel .
    DATA shared_strings TYPE zexcel_t_shared_string .
    DATA styles_cond_mapping TYPE zexcel_t_styles_cond_mapping .
    DATA styles_mapping TYPE zexcel_t_styles_mapping .
    CONSTANTS c_xl_comments TYPE string VALUE 'xl/comments#.xml'. "#EC NOTEXT
    CONSTANTS cl_xl_drawing_for_comments TYPE string VALUE 'xl/drawings/vmlDrawing#.vml'. "#EC NOTEXT
    CONSTANTS c_xl_drawings_vml_rels TYPE string VALUE 'xl/drawings/_rels/vmlDrawing#.vml.rels'. "#EC NOTEXT
    DATA ixml TYPE REF TO if_ixml.
    DATA control_characters TYPE string.

    METHODS create_xl_sheet_sheet_data
      IMPORTING
        !io_document                   TYPE REF TO if_ixml_document
        !io_worksheet                  TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(rv_ixml_sheet_data_root) TYPE REF TO if_ixml_element
      RAISING
        Lcx_excel .
    METHODS add_further_data_to_zip
      IMPORTING
        !io_zip TYPE REF TO cl_abap_zip .
    METHODS create
      RETURNING
        VALUE(ep_excel) TYPE xstring
      RAISING
        Lcx_excel .
    METHODS create_content_types
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_docprops_app
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_docprops_core
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_dxf_style
      IMPORTING
        !iv_cell_style    TYPE zexcel_cell_style
        !io_dxf_element   TYPE REF TO if_ixml_element
        !io_ixml_document TYPE REF TO if_ixml_document
        !it_cellxfs       TYPE zexcel_t_cellxfs
        !it_fonts         TYPE zexcel_t_style_font
        !it_fills         TYPE zexcel_t_style_fill
      CHANGING
        !cv_dfx_count     TYPE i .
    METHODS create_relationships
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_charts
      IMPORTING
        !io_drawing       TYPE REF TO Lcl_excel_drawing
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_comments
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_drawings
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_drawings_rels
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_drawing_anchor
      IMPORTING
        !io_drawing      TYPE REF TO Lcl_excel_drawing
        !io_document     TYPE REF TO if_ixml_document
        !ip_index        TYPE i
      RETURNING
        VALUE(ep_anchor) TYPE REF TO if_ixml_element .
    METHODS create_xl_drawing_for_comments
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ep_content) TYPE xstring
      RAISING
        Lcx_excel .
    METHODS create_xl_relationships
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_sharedstrings
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_sheet
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
        !iv_active        TYPE flag DEFAULT ''
      RETURNING
        VALUE(ep_content) TYPE xstring
      RAISING
        Lcx_excel .
    METHODS create_xl_sheet_ignored_errors
      IMPORTING
        io_worksheet    TYPE REF TO Lcl_excel_worksheet
        io_document     TYPE REF TO if_ixml_document
        io_element_root TYPE REF TO if_ixml_element.
    METHODS create_xl_sheet_pagebreaks
      IMPORTING
        !io_document  TYPE REF TO if_ixml_document
        !io_parent    TYPE REF TO if_ixml_element
        !io_worksheet TYPE REF TO Lcl_excel_worksheet
      RAISING
        Lcx_excel .
    METHODS create_xl_sheet_rels
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
        !iv_drawing_index TYPE i
        !iv_comment_index TYPE i
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_styles
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_styles_color_node
      IMPORTING
        !io_document        TYPE REF TO if_ixml_document
        !io_parent          TYPE REF TO if_ixml_element
        !iv_color_elem_name TYPE string DEFAULT 'color'
        !is_color           TYPE zexcel_s_style_color .
    METHODS create_xl_styles_font_node
      IMPORTING
        !io_document TYPE REF TO if_ixml_document
        !io_parent   TYPE REF TO if_ixml_element
        !is_font     TYPE zexcel_s_style_font
        !iv_use_rtf  TYPE abap_bool DEFAULT abap_false .
    METHODS create_xl_table
      IMPORTING
        !io_table         TYPE REF TO Lcl_excel_table
      RETURNING
        VALUE(ep_content) TYPE xstring
      RAISING
        Lcx_excel .
    METHODS create_xl_theme
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_workbook
      RETURNING
        VALUE(ep_content) TYPE xstring
      RAISING
        Lcx_excel .
    METHODS get_shared_string_index
      IMPORTING
        !ip_cell_value  TYPE zexcel_cell_value
        !it_rtf         TYPE zexcel_t_rtf OPTIONAL
      RETURNING
        VALUE(ep_index) TYPE int4 .
    METHODS create_xl_drawings_vml
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS set_vml_string
      RETURNING
        VALUE(ep_content) TYPE string .
    METHODS create_xl_drawings_vml_rels
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS escape_string_value
      IMPORTING
        !iv_value     TYPE zexcel_cell_value
      RETURNING
        VALUE(result) TYPE zexcel_cell_value.
    METHODS set_vml_shape_footer
      IMPORTING
        !is_footer        TYPE zexcel_s_worksheet_head_foot
      RETURNING
        VALUE(ep_content) TYPE string .
    METHODS set_vml_shape_header
      IMPORTING
        !is_header        TYPE zexcel_s_worksheet_head_foot
      RETURNING
        VALUE(ep_content) TYPE string .
    METHODS create_xl_drawing_for_hdft_im
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xl_drawings_hdft_rels
      IMPORTING
        !io_worksheet     TYPE REF TO Lcl_excel_worksheet
      RETURNING
        VALUE(ep_content) TYPE xstring .
    METHODS create_xml_document
      RETURNING
        VALUE(ro_document) TYPE REF TO if_ixml_document.
    METHODS render_xml_document
      IMPORTING
        io_document       TYPE REF TO if_ixml_document
      RETURNING
        VALUE(ep_content) TYPE xstring.
    METHODS create_xl_sheet_column_formula
      IMPORTING
        io_document             TYPE REF TO if_ixml_document
        it_column_formulas      TYPE Lcl_excel_worksheet=>mty_th_column_formula
        is_sheet_content        TYPE zexcel_s_cell_data
      EXPORTING
        eo_element              TYPE REF TO if_ixml_element
      CHANGING
        ct_column_formulas_used TYPE mty_column_formulas_used
        cv_si                   TYPE i
      RAISING
        Lcx_excel.
    METHODS is_formula_shareable
      IMPORTING
        ip_formula          TYPE string
      RETURNING
        VALUE(ep_shareable) TYPE abap_bool
      RAISING
        Lcx_excel.
*"* private declarations
*include Lcl_excel_writer_2007=========ci.
  PRIVATE SECTION.

*"* private components of class LCL_EXCEL_WRITER_2007
*"* do not include other source files here!!!
    CONSTANTS c_off TYPE string VALUE '0'.                  "#EC NOTEXT
    CONSTANTS c_on TYPE string VALUE '1'.                   "#EC NOTEXT
    CONSTANTS c_xl_printersettings TYPE string VALUE 'xl/printerSettings/printerSettings#.bin'. "#EC NOTEXT
    TYPES: tv_charbool TYPE c LENGTH 5.

    METHODS add_1_val_child_node
      IMPORTING
        io_document   TYPE REF TO if_ixml_document
        io_parent     TYPE REF TO if_ixml_element
        iv_elem_name  TYPE string
        iv_attr_name  TYPE string
        iv_attr_value TYPE string.
    METHODS flag2bool
      IMPORTING
        !ip_flag          TYPE flag
      RETURNING
        VALUE(ep_boolean) TYPE tv_charbool  .
endclass. "LCL_EXCEL_WRITER_2007 definition
*class-pool .
*"* class pool for class LCL_EXCEL_WRITER_HUGE_FILE

*"* local type definitions
*include Lcl_excel_writer_huge_file====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_WRITER_HUGE_FILE definition
*"* public declarations
*include Lcl_excel_writer_huge_file====cu.
CLASS Lcl_excel_writer_huge_file DEFINITION
*public
  INHERITING FROM Lcl_excel_writer_2007
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES:
      BEGIN OF ty_cell,
        name    TYPE c LENGTH 10, "AAA1234567"
        style   TYPE i,
        type    TYPE c LENGTH 9,
        formula TYPE string,
        value   TYPE string,
      END OF ty_cell .

    DATA:
      cells TYPE STANDARD TABLE OF ty_cell .

    METHODS get_cells
      IMPORTING
        !i_row   TYPE i
        !i_index TYPE i .
*"* protected declarations
*include Lcl_excel_writer_huge_file====co.
  PROTECTED SECTION.

    METHODS create_xl_sharedstrings
        REDEFINITION .
    METHODS create_xl_sheet
        REDEFINITION .
*"* private declarations
*include Lcl_excel_writer_huge_file====ci.
  PRIVATE SECTION.

    DATA worksheet TYPE REF TO Lcl_excel_worksheet .
endclass. "LCL_EXCEL_WRITER_HUGE_FILE definition
*class-pool .
*"* class pool for class LCL_EXCEL_WRITER_XLSM

*"* local type definitions
*include Lcl_excel_writer_xlsm=========ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_WRITER_XLSM definition
*"* public declarations
*include Lcl_excel_writer_xlsm=========cu.
CLASS Lcl_excel_writer_xlsm DEFINITION
*public
  INHERITING FROM Lcl_excel_writer_2007
  CREATE PUBLIC .

  PUBLIC SECTION.
*"* public components of class LCL_EXCEL_WRITER_XLSM
*"* do not include other source files here!!!
*"* protected declarations
*include Lcl_excel_writer_xlsm=========co.
  PROTECTED SECTION.

*"* protected components of class LCL_EXCEL_WRITER_XLSM
*"* do not include other source files here!!!
    CONSTANTS c_xl_vbaproject TYPE string VALUE 'xl/vbaProject.bin'. "#EC NOTEXT

    METHODS add_further_data_to_zip
        REDEFINITION .
    METHODS create
        REDEFINITION .
    METHODS create_content_types
        REDEFINITION .
    METHODS create_xl_relationships
        REDEFINITION .
    METHODS create_xl_sheet
        REDEFINITION .
    METHODS create_xl_workbook
        REDEFINITION .
*"* private declarations
*include Lcl_excel_writer_xlsm=========ci.
  PRIVATE SECTION.
*"* private components of class LCL_EXCEL_WRITER_XLSM
*"* do not include other source files here!!!
endclass. "LCL_EXCEL_WRITER_XLSM definition
*class-pool .
*"* class pool for class LCL_EXCEL_FILL_TEMPLATE

*"* local type definitions
*include Lcl_excel_fill_template=======ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_FILL_TEMPLATE definition
*"* public declarations
*include Lcl_excel_fill_template=======cu.
CLASS Lcl_excel_fill_template DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    TYPES: tv_range_name TYPE c LENGTH 30,
           BEGIN OF ts_range,
             sheet  TYPE zexcel_sheet_title,
             name   TYPE tv_range_name,
             start  TYPE zexcel_cell_row,
             stop   TYPE zexcel_cell_row,
             id     TYPE i,
             parent TYPE i,
             length TYPE i,
           END OF ts_range,
           tt_ranges TYPE STANDARD TABLE OF ts_range WITH DEFAULT KEY,
           BEGIN OF ts_variable,
             sheet  TYPE zexcel_sheet_title,
             parent TYPE i,
             name   TYPE tv_range_name,
           END OF ts_variable,
           BEGIN OF ts_name_style,
             sheet           TYPE zexcel_sheet_title,
             name            TYPE tv_range_name,
             parent          TYPE i,
             numeric_counter TYPE i,
             date_counter    TYPE i,
             time_counter    TYPE i,
             text_counter    TYPE i,
           END OF ts_name_style,
           tt_variables    TYPE STANDARD TABLE OF ts_variable WITH DEFAULT KEY,
           tt_sheet_titles TYPE STANDARD TABLE OF zexcel_sheet_title WITH DEFAULT KEY,
           tt_name_styles  TYPE STANDARD TABLE OF ts_name_style WITH DEFAULT KEY.

    DATA mt_sheet TYPE tt_sheet_titles READ-ONLY.
    DATA mt_range TYPE tt_ranges READ-ONLY.
    DATA mt_var TYPE tt_variables READ-ONLY.
    DATA mo_excel TYPE REF TO Lcl_excel READ-ONLY.
    DATA mt_name_styles TYPE tt_name_styles READ-ONLY.

    CLASS-METHODS create
      IMPORTING
        !io_excel                 TYPE REF TO Lcl_excel
      RETURNING
        VALUE(eo_template_filler) TYPE REF TO Lcl_excel_fill_template
      RAISING
        Lcx_excel.

    METHODS fill_sheet
      IMPORTING
        !iv_data TYPE Lcl_excel_template_data=>ts_template_data_sheet
      RAISING
        Lcx_excel .

*"* protected declarations
*include Lcl_excel_fill_template=======co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_fill_template=======ci.
  PRIVATE SECTION.

    TYPES: tt_cell_data_no_key TYPE STANDARD TABLE OF zexcel_s_cell_data WITH DEFAULT KEY.

    METHODS fill_range
      IMPORTING
        !iv_sheet              TYPE zexcel_sheet_title
        !iv_parent             TYPE zexcel_cell_row
        !iv_data               TYPE data
        VALUE(iv_range_length) TYPE zexcel_cell_row
        !io_sheet              TYPE REF TO Lcl_excel_worksheet
      CHANGING
        !ct_cells              TYPE tt_cell_data_no_key
        !cv_diff               TYPE zexcel_cell_row
        !ct_merged_cells       TYPE Lcl_excel_worksheet=>mty_ts_merge
      RAISING
        Lcx_excel .
    METHODS get_range .
    METHODS validate_range
      IMPORTING
        !io_range TYPE REF TO Lcl_excel_range .
    METHODS discard_overlapped .
    METHODS sign_range .
    METHODS find_var
      RAISING
        Lcx_excel .

endclass. "LCL_EXCEL_FILL_TEMPLATE definition
*class-pool .
*"* class pool for class LCL_EXCEL_READER_HUGE_FILE

*"* local type definitions
*include Lcl_excel_reader_huge_file====ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section

* Signal for "Not found"
CLASS SHRITEFUH64VYIPN5I4UIDBJAAHSE4 DEFINITION INHERITING FROM cx_static_check.
  PUBLIC SECTION.
    DATA error TYPE string.
    METHODS constructor
      IMPORTING error    TYPE string
                textid   TYPE sotr_conc OPTIONAL
                previous TYPE REF TO cx_root OPTIONAL.
    METHODS if_message~get_text REDEFINITION.
ENDCLASS.

*"* class LCL_EXCEL_READER_HUGE_FILE definition
*"* public declarations
*include Lcl_excel_reader_huge_file====cu.
CLASS Lcl_excel_reader_huge_file DEFINITION
*public
  INHERITING FROM Lcl_excel_reader_2007
  CREATE PUBLIC


.

  PUBLIC SECTION.
*"* protected declarations
*include Lcl_excel_reader_huge_file====co.
  PROTECTED SECTION.

    METHODS load_shared_strings
        REDEFINITION .
    METHODS load_worksheet
        REDEFINITION .
*"* private declarations
*include Lcl_excel_reader_huge_file====ci.
  PRIVATE SECTION.

    TYPES:
      BEGIN OF t_cell_content,
        datatype TYPE zexcel_cell_data_type,
        value    TYPE zexcel_cell_value,
        formula  TYPE zexcel_cell_formula,
        style    TYPE zexcel_cell_style,
      END OF t_cell_content .
    TYPES:
      BEGIN OF t_cell_coord,
        row    TYPE zexcel_cell_row,
        column TYPE zexcel_cell_column_alpha,
      END OF t_cell_coord .
    TYPES:
      BEGIN OF t_cell.
        INCLUDE TYPE t_cell_coord AS coord.
        INCLUDE TYPE t_cell_content AS content.
    TYPES: END OF t_cell .

    INTERFACE if_sxml_node LOAD .
    CONSTANTS c_end_of_stream TYPE if_sxml_node=>node_type VALUE if_sxml_node=>co_nt_final. "#EC NOTEXT
    CONSTANTS c_element_open TYPE if_sxml_node=>node_type VALUE if_sxml_node=>co_nt_element_open. "#EC NOTEXT
    CONSTANTS c_element_close TYPE if_sxml_node=>node_type VALUE if_sxml_node=>co_nt_element_close. "#EC NOTEXT
    DATA:
      BEGIN OF gs_buffer_style,
        index TYPE i VALUE -1,
        guid  TYPE zexcel_cell_style,
      END OF gs_buffer_style .
    CONSTANTS c_attribute TYPE if_sxml_node=>node_type VALUE if_sxml_node=>co_nt_attribute. "#EC NOTEXT
    CONSTANTS c_node_value TYPE if_sxml_node=>node_type VALUE if_sxml_node=>co_nt_value. "#EC NOTEXT

    METHODS skip_to
      IMPORTING
        !iv_element_name TYPE string
        !io_reader       TYPE REF TO if_sxml_reader
      RAISING
        SHRITEFUH64VYIPN5I4UIDBJAAHSE4 .
    METHODS fill_cell_from_attributes
      IMPORTING
        !io_reader     TYPE REF TO if_sxml_reader
      RETURNING
        VALUE(es_cell) TYPE t_cell
      RAISING
        SHRITEFUH64VYIPN5I4UIDBJAAHSE4
        Lcx_excel.
    METHODS read_shared_strings
      IMPORTING
        !io_reader               TYPE REF TO if_sxml_reader
      RETURNING
        VALUE(et_shared_strings) TYPE stringtab .
    METHODS get_cell_coord
      IMPORTING
        !iv_coord       TYPE string
      RETURNING
        VALUE(es_coord) TYPE t_cell_coord
      RAISING
        Lcx_excel.
    METHODS put_cell_to_worksheet
      IMPORTING
        !io_worksheet TYPE REF TO Lcl_excel_worksheet
        !is_cell      TYPE t_cell
      RAISING
        Lcx_excel.
    METHODS get_shared_string
      IMPORTING
        !iv_index       TYPE any
      RETURNING
        VALUE(ev_value) TYPE string
      RAISING
        SHRITEFUH64VYIPN5I4UIDBJAAHSE4 .
    METHODS get_style
      IMPORTING
        !iv_index            TYPE any
      RETURNING
        VALUE(ev_style_guid) TYPE zexcel_cell_style
      RAISING
        SHRITEFUH64VYIPN5I4UIDBJAAHSE4 .
    METHODS read_worksheet_data
      IMPORTING
        !io_reader    TYPE REF TO if_sxml_reader
        !io_worksheet TYPE REF TO Lcl_excel_worksheet
      RAISING
        SHRITEFUH64VYIPN5I4UIDBJAAHSE4
        Lcx_excel .
    METHODS get_sxml_reader
      IMPORTING
        !iv_path         TYPE string
      RETURNING
        VALUE(eo_reader) TYPE REF TO if_sxml_reader
      RAISING
        Lcx_excel .
endclass. "LCL_EXCEL_READER_HUGE_FILE definition
*class-pool .
*"* class pool for class LCL_EXCEL_STYLE_CHANGER

*"* local type definitions
*include Lcl_excel_style_changer=======ccdef.
*"* use this source file for any type of declarations (class
*"* definitions, interfaces or type declarations) you need for
*"* components in the private section


*"* class LCL_EXCEL_STYLE_CHANGER definition
*"* public declarations
*include Lcl_excel_style_changer=======cu.
CLASS Lcl_excel_style_changer DEFINITION
*public
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    INTERFACES Lif_excel_style_changer.

    CLASS-METHODS create
      IMPORTING
        excel         TYPE REF TO Lcl_excel
      RETURNING
        VALUE(result) TYPE REF TO Lif_excel_style_changer
      RAISING
        Lcx_excel.

*"* protected declarations
*include Lcl_excel_style_changer=======co.
  PROTECTED SECTION.
*"* private declarations
*include Lcl_excel_style_changer=======ci.
  PRIVATE SECTION.

    METHODS clear_initial_colorxfields
      IMPORTING
        is_color  TYPE zexcel_s_style_color
      CHANGING
        cs_xcolor TYPE zexcel_s_cstylex_color.

    METHODS move_supplied_borders
      IMPORTING
        iv_border_supplied        TYPE abap_bool
        is_border                 TYPE zexcel_s_cstyle_border
        iv_xborder_supplied       TYPE abap_bool
        is_xborder                TYPE zexcel_s_cstylex_border
      CHANGING
        cs_complete_style_border  TYPE zexcel_s_cstyle_border
        cs_complete_stylex_border TYPE zexcel_s_cstylex_border.

    DATA: excel                   TYPE REF TO Lcl_excel,
          lv_xborder_supplied     TYPE abap_bool,
          single_change_requested TYPE zexcel_s_cstylex_complete,
          BEGIN OF multiple_change_requested,
            complete   TYPE abap_bool,
            font       TYPE abap_bool,
            fill       TYPE abap_bool,
            BEGIN OF borders,
              complete   TYPE abap_bool,
              allborders TYPE abap_bool,
              diagonal   TYPE abap_bool,
              down       TYPE abap_bool,
              left       TYPE abap_bool,
              right      TYPE abap_bool,
              top        TYPE abap_bool,
            END OF borders,
            alignment  TYPE abap_bool,
            protection TYPE abap_bool,
          END OF multiple_change_requested.
    CONSTANTS:
          lv_border_supplied  TYPE abap_bool VALUE abap_true.
    ALIASES:
          complete_style   FOR Lif_excel_style_changer~complete_style,
          complete_stylex  FOR Lif_excel_style_changer~complete_stylex.

endclass. "LCL_EXCEL_STYLE_CHANGER definition
